<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Olamide Akinlade">
<title>Tree Phenology Assignment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="tree_phenology_assignment_files/libs/clipboard/clipboard.min.js"></script>
<script src="tree_phenology_assignment_files/libs/quarto-html/quarto.js"></script>
<script src="tree_phenology_assignment_files/libs/quarto-html/popper.min.js"></script>
<script src="tree_phenology_assignment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tree_phenology_assignment_files/libs/quarto-html/anchor.min.js"></script>
<link href="tree_phenology_assignment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tree_phenology_assignment_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tree_phenology_assignment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tree_phenology_assignment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tree_phenology_assignment_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><style>html{ scroll-behavior: smooth; }</style>
<script src="tree_phenology_assignment_files/libs/kePrint-0.0.1/kePrint.js"></script><link href="tree_phenology_assignment_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#chapter-3-tree-phenology-analysis" id="toc-chapter-3-tree-phenology-analysis" class="nav-link active" data-scroll-target="#chapter-3-tree-phenology-analysis">Chapter 3: Tree Phenology Analysis</a>
  <ul>
<li>
<a href="#tree-dormancy" id="toc-tree-dormancy" class="nav-link" data-scroll-target="#tree-dormancy">1.1 Tree Dormancy</a>
  <ul>
<li><a href="#dormancy-phases" id="toc-dormancy-phases" class="nav-link" data-scroll-target="#dormancy-phases">1.1.1 Dormancy Phases</a></li>
  <li><a href="#physological-processes-that-regulate-dormancy" id="toc-physological-processes-that-regulate-dormancy" class="nav-link" data-scroll-target="#physological-processes-that-regulate-dormancy">1.1.2 Physological processes that regulate dormancy</a></li>
  </ul>
</li>
  <li><a href="#exercises-on-tree-dormancy" id="toc-exercises-on-tree-dormancy" class="nav-link" data-scroll-target="#exercises-on-tree-dormancy"><strong><em>Exercises on Tree Dormancy</em></strong></a></li>
  </ul>
</li>
  <li><a href="#chapter-4-climate-change-and-impact-projection" id="toc-chapter-4-climate-change-and-impact-projection" class="nav-link" data-scroll-target="#chapter-4-climate-change-and-impact-projection">Chapter 4: Climate Change and impact projection</a></li>
  <li>
<a href="#drivers-of-climate-change-include" id="toc-drivers-of-climate-change-include" class="nav-link" data-scroll-target="#drivers-of-climate-change-include">1.1 Drivers of Climate change include:</a>
  <ul>
<li><a href="#exercises-on-climate-change" id="toc-exercises-on-climate-change" class="nav-link" data-scroll-target="#exercises-on-climate-change"><strong><em>Exercises on Climate Change</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-5-winter-chill-projections" id="toc-chapter-5-winter-chill-projections" class="nav-link" data-scroll-target="#chapter-5-winter-chill-projections">Chapter 5: Winter Chill Projections</a>
  <ul>
<li><a href="#exercises-on-past-chill-projections" id="toc-exercises-on-past-chill-projections" class="nav-link" data-scroll-target="#exercises-on-past-chill-projections"><strong><em>Exercises on past chill projections</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-6-manual-chill-analysis" id="toc-chapter-6-manual-chill-analysis" class="nav-link" data-scroll-target="#chapter-6-manual-chill-analysis">Chapter 6: Manual Chill Analysis</a>
  <ul>
<li><a href="#computing-chilling-hours-from-hourly-temperature-data" id="toc-computing-chilling-hours-from-hourly-temperature-data" class="nav-link" data-scroll-target="#computing-chilling-hours-from-hourly-temperature-data"><strong><em>Computing Chilling Hours from Hourly Temperature data</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-7-winter-chill-projections" id="toc-chapter-7-winter-chill-projections" class="nav-link" data-scroll-target="#chapter-7-winter-chill-projections">Chapter 7: Winter Chill Projections</a>
  <ul>
<li><a href="#exercises-chill-models" id="toc-exercises-chill-models" class="nav-link" data-scroll-target="#exercises-chill-models"><strong><em>Exercises Chill Models</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-8-making-hourly-temperatures" id="toc-chapter-8-making-hourly-temperatures" class="nav-link" data-scroll-target="#chapter-8-making-hourly-temperatures">Chapter 8: Making Hourly Temperatures</a>
  <ul>
<li><a href="#exercises-on-hourly" id="toc-exercises-on-hourly" class="nav-link" data-scroll-target="#exercises-on-hourly"><strong><em>Exercises on hourly</em></strong></a></li>
  </ul>
</li>
  <li><a href="#sunset-time-and-daylength-at-rochester-latitude-43.15n-over-the" id="toc-sunset-time-and-daylength-at-rochester-latitude-43.15n-over-the" class="nav-link" data-scroll-target="#sunset-time-and-daylength-at-rochester-latitude-43.15n-over-the">sunset time and daylength at Rochester (Latitude: 43.15Â°N) over the</a></li>
  <li>
<a href="#chapter-9-some-useful-tools-in-r" id="toc-chapter-9-some-useful-tools-in-r" class="nav-link" data-scroll-target="#chapter-9-some-useful-tools-in-r">Chapter 9: Some Useful tools in R</a>
  <ul>
<li><a href="#exercises-on-useful-r-tools" id="toc-exercises-on-useful-r-tools" class="nav-link" data-scroll-target="#exercises-on-useful-r-tools"><strong><em>Exercises on useful R tools</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-10-getting-temperature-data" id="toc-chapter-10-getting-temperature-data" class="nav-link" data-scroll-target="#chapter-10-getting-temperature-data">Chapter 10: Getting temperature data</a>
  <ul>
<li><a href="#exercises-on-getting-temperature-data" id="toc-exercises-on-getting-temperature-data" class="nav-link" data-scroll-target="#exercises-on-getting-temperature-data"><strong><em>Exercises on getting temperature data</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-11-getting-temperature-data" id="toc-chapter-11-getting-temperature-data" class="nav-link" data-scroll-target="#chapter-11-getting-temperature-data">Chapter 11: Getting temperature data</a>
  <ul>
<li><a href="#exercises-on-getting-temperature-data-1" id="toc-exercises-on-getting-temperature-data-1" class="nav-link" data-scroll-target="#exercises-on-getting-temperature-data-1"><strong><em>Exercises on getting temperature data</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-12-generating-temperature-scenarios" id="toc-chapter-12-generating-temperature-scenarios" class="nav-link" data-scroll-target="#chapter-12-generating-temperature-scenarios">Chapter 12: Generating temperature scenarios</a>
  <ul>
<li><a href="#exercises-on-getting-temperature-data-2" id="toc-exercises-on-getting-temperature-data-2" class="nav-link" data-scroll-target="#exercises-on-getting-temperature-data-2"><strong><em>Exercises on getting temperature data</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-14-generating-historic-temperature-scenarios" id="toc-chapter-14-generating-historic-temperature-scenarios" class="nav-link" data-scroll-target="#chapter-14-generating-historic-temperature-scenarios">Chapter 14: Generating historic temperature scenarios</a>
  <ul>
<li><a href="#exercises-on-historic-temperature-scenarios" id="toc-exercises-on-historic-temperature-scenarios" class="nav-link" data-scroll-target="#exercises-on-historic-temperature-scenarios"><strong><em>Exercises on historic temperature scenarios</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-15-future-temperature-scenarios" id="toc-chapter-15-future-temperature-scenarios" class="nav-link" data-scroll-target="#chapter-15-future-temperature-scenarios">Chapter 15: Future temperature scenarios</a>
  <ul>
<li><a href="#exercises-on-future-temperature-scenarios" id="toc-exercises-on-future-temperature-scenarios" class="nav-link" data-scroll-target="#exercises-on-future-temperature-scenarios">*<strong>Exercises on future temperature scenarios</strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-16-generating-cmip6-temperature-scenarios" id="toc-chapter-16-generating-cmip6-temperature-scenarios" class="nav-link" data-scroll-target="#chapter-16-generating-cmip6-temperature-scenarios">Chapter 16: Generating CMIP6 temperature scenarios</a>
  <ul>
<li><a href="#exercises-on-generating-cmip6-temperature-scenarios" id="toc-exercises-on-generating-cmip6-temperature-scenarios" class="nav-link" data-scroll-target="#exercises-on-generating-cmip6-temperature-scenarios"><strong><em>Exercises on generating CMIP6 temperature scenarios</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-18-plotting-climate-scenarios" id="toc-chapter-18-plotting-climate-scenarios" class="nav-link" data-scroll-target="#chapter-18-plotting-climate-scenarios">Chapter 18: Plotting Climate Scenarios</a>
  <ul>
<li><a href="#exercises-on-plotting-future-projections" id="toc-exercises-on-plotting-future-projections" class="nav-link" data-scroll-target="#exercises-on-plotting-future-projections"><strong><em>Exercises on plotting future projections</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-19-chill-model-comparison" id="toc-chapter-19-chill-model-comparison" class="nav-link" data-scroll-target="#chapter-19-chill-model-comparison">Chapter 19: Chill model comparison</a>
  <ul>
<li><a href="#exercises-on-chill-model-comparison" id="toc-exercises-on-chill-model-comparison" class="nav-link" data-scroll-target="#exercises-on-chill-model-comparison"><strong><em>Exercises on chill model comparison</em></strong></a></li>
  </ul>
</li>
  </ul></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Tree Phenology Assignment</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Olamide Akinlade </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  


</header><hr>
<section id="chapter-3-tree-phenology-analysis" class="level1"><h1>Chapter 3: Tree Phenology Analysis</h1>
<section id="tree-dormancy" class="level2"><h2 class="anchored" data-anchor-id="tree-dormancy">1.1 Tree Dormancy</h2>
<p>Winter dormancy may be defined as a trade-off between the length of the growing season and the protection against winter damage. To enter dormancy, vegetative growth is stopped in the late summer or early autumn and the shoots are converted into buds, where the shoot apical meristems are protected by tightly closed and hardened bud scales.</p>
<section id="dormancy-phases" class="level3"><h3 class="anchored" data-anchor-id="dormancy-phases">1.1.1 Dormancy Phases</h3>
<ol type="1">
<li>Dormancy Establishment</li>
<li>Endodormancy 1: Ecodormancy</li>
<li>Growth resumption</li>
</ol></section><section id="physological-processes-that-regulate-dormancy" class="level3"><h3 class="anchored" data-anchor-id="physological-processes-that-regulate-dormancy">1.1.2 Physological processes that regulate dormancy</h3>
<ol type="a">
<li>Transport</li>
<li>Photohormones</li>
<li>Genetics</li>
<li>Carbohydrates dynamics</li>
</ol></section></section><section id="exercises-on-tree-dormancy" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-tree-dormancy"><strong><em>Exercises on Tree Dormancy</em></strong></h2>
<ol type="1">
<li>Put yourself in the place of a breeder who wants to calculate the temperature requirements of a newly released cultivar. Which method will you use to calculate the chilling and forcing periods? Please justify your answer</li>
</ol>
<p>Statistical method is recommended to calculate the temperature requirements (chilling and forcing periods) of a newly released cultivar. This involves using partial least square regression analysis for daily temperatures over a continuous period.</p>
<ol start="2" type="1">
<li>Which are the advantages (2) of the BBCH scale compared with earlier scales?</li>
</ol>
<p>Two advantages of the BBCH scale over traditional scale include: a. It was developed in a general frame for all the species b. It covers the whole development of a plant.</p>
<ol start="3" type="1">
<li>Classify the following phenological stages of sweet cherry according to the BBCH scale:</li>
</ol>
<p>Phenological stages of cherry + Image 1: 51</p>
<ul>
<li><p>Image 2: 63</p></li>
<li><p>Image 3: 87</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="%5CUsers%5CHome%5CDownloads%5Cphoto_5834526249584805567_y.jpg" class="img-fluid figure-img"></p>
<figcaption>Stages of Cherry</figcaption></figure>
</div>
<hr></section></section><section id="chapter-4-climate-change-and-impact-projection" class="level1"><h1>Chapter 4: Climate Change and impact projection</h1>
</section><section id="drivers-of-climate-change-include" class="level1"><h1>1.1 Drivers of Climate change include:</h1>
<ul>
<li>Sun: Warms the earth through radiation. It is an important driver of climate change on geological timescales, but not of recent climate change.</li>
<li>Aerosols: They are largely dusts. Suspensions of liquid, solid, or mixed particles with highly variable chemical composition and size distribution.</li>
<li>Clouds: Can have both cooling and warming effect.</li>
<li>Ozone: Surface (tropospheric) ozone: constituent of smog, health hazard (bad ozone). Greenhouse gas: presence in the stratosphere has a warming effect. Destroyed by chlorofluorocarbons (CFCs).</li>
<li>Surface albedo: Reflection of radiation by the land surface. Light surfaces (e.g.&nbsp;ice, snow) reflect almost all radiation, dark surfaces (ocean, dark soil, forest) very little.</li>
<li>Greenhouse gases: Atmospheric gases that trap heat on Earth. Greenhouse effects warms the planet.</li>
<li>Long-term drivers:</li>
</ul>
<section id="exercises-on-climate-change" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-climate-change"><strong><em>Exercises on Climate Change</em></strong></h2>
<ol type="1">
<li>List the main drivers of climate change at the decade to century scale, and briefly explain the mechanism through which the currently most important driver affects our climate.</li>
</ol>
<ul>
<li>Sun</li>
<li>Aerosols</li>
<li>Clouds</li>
<li>Ozone</li>
<li>Surface albedo</li>
<li>Greenhouse gases</li>
<li>Long-term drivers</li>
</ul>
<p>Most important: <strong>GHGs</strong> <strong>Greenhouse effect</strong> + Raises Earthâs mean temperature: +14Â°C instead of -18Â°C without GHGs! + Major GHGs: water vapor, CO2 (carbon dioxide), CH4 (methane), N2O (nitrous oxide)</p>
<ol type="1">
<li>Explain briefly what is special about temperature dynamics of recent decades, and why we have good reasons to be concerned.</li>
</ol>
<p>Since 1901 strong warming (almost) everywhere on Earth.Up to 8Â°C warmer than the 2003-2018 average. Precipitation anomalies (relative to median prec.) for Cologne/Bonn weather station. Some years with dry springs/summer.</p>
<ol type="1">
<li>What does the abbreviation âRCPâ stand for, how are RCPs defined, and what is their role in projecting future climates? Representative Concentration Pathways (RCPs). It is a new greenhouse forcing scenarios in the IPCCâs5th Assessment Report. From RCP to inputs for climate change impact models.</li>
</ol>
<p>Roles of RCP:</p>
<ol type="1">
<li>Briefly describe the 4 climate impact projection methods described in the fourth video.</li>
</ol>
<ul>
<li>Statistical models</li>
<li>Species distribution modeling</li>
<li>Process-based models</li>
<li>Climate analogue analysis</li>
</ul>
<hr></section></section><section id="chapter-5-winter-chill-projections" class="level1"><h1>Chapter 5: Winter Chill Projections</h1>
<section id="exercises-on-past-chill-projections" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-past-chill-projections"><strong><em>Exercises on past chill projections</em></strong></h2>
<ol type="1">
<li>Sketch out three data access and processing challenges that had to be overcome in order to produce chill projections with state-of-the-art methodology.</li>
</ol>
<ul>
<li>Accessing Climate Data for Specific Locations: Previous climate datasets like AFRICLIM and ClimateWizard only provided large-scale data. To get weather data for specific locations without downloading too much extra information, an API was created to quickly access data for single sites</li>
<li>Converting Daily to Hourly Temperature Data: Chill models need hourly temperature data, but many databases only give daily averages. Early methods for converting daily to hourly data werenât very good, especially in areas with unique temperatures. Improved algorithms were developed to estimate hourly temperatures more accurately from daily data</li>
<li>Handling Large Volumes of Climate Model Outputs: Studying different climate futures involves dealing with a lot of data from many climate models, which can be hard to manage. To handle this large amount of data effectively, workflows were streamlined and selective processing techniques were used</li>
</ul>
<ol start="2" type="1">
<li>Outline, in your understanding, the basic steps that are necessary to make such projections.</li>
</ol>
<ul>
<li>Data Collection and Calibration: collect historical weather data and use it to calibrate a weather generator for realistic temperature simulations</li>
<li>Model Selection and Scenario Setup: choose relevant climate models and emission scenarios to explore various future climates</li>
<li>Generate Temperature Projections: downscale climate data, converting it to daily or hourly temperatures as needed for chill calculations</li>
<li>Chill Calculation: apply chill models to estimate chill accumulation across different climate scenarios</li>
<li>Analysis and Visualization: compare chill projections across models and scenarios and visualize the findings</li>
<li>Interpretation: validate projections with observed data where possible and assess agricultural impacts and adaptation needs</li>
</ul>
<hr></section></section><section id="chapter-6-manual-chill-analysis" class="level1"><h1>Chapter 6: Manual Chill Analysis</h1>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Winters_hours_gaps</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Year Month Day Hour Temp_gaps   Temp
1  2008     3   3   10    15.127 15.127
2  2008     3   3   11    17.153 17.153
3  2008     3   3   12    18.699 18.699
4  2008     3   3   13    18.699 18.699
5  2008     3   3   14    18.842 18.842
6  2008     3   3   15    19.508 19.508
7  2008     3   3   16    19.318 19.318
8  2008     3   3   17    17.701 17.701
9  2008     3   3   18    15.414 15.414
10 2008     3   3   19    12.727 12.727</code></pre>
</div>
</div>
<section id="computing-chilling-hours-from-hourly-temperature-data" class="level2"><h2 class="anchored" data-anchor-id="computing-chilling-hours-from-hourly-temperature-data"><strong><em>Computing Chilling Hours from Hourly Temperature data</em></strong></h2>
<ol type="1">
<li>Write a basic function that calculates warm hours (&gt;25Â°C)</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hourtemps</span> <span class="op">&lt;-</span> <span class="va">Winters_hours_gaps</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Year"</span>,</span>
<span>                                   <span class="st">"Month"</span>,</span>
<span>                                   <span class="st">"Day"</span>,</span>
<span>                                   <span class="st">"Hour"</span>,</span>
<span>                                   <span class="st">"Temp"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">hourtemps</span><span class="op">[</span>, <span class="st">"Chilling_Hour"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">hourtemps</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">hourtemps</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&lt;=</span> <span class="fl">7.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>#calculate warm hours</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WH</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">hourtemps</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">hourtemps</span><span class="op">[</span>, <span class="st">"Warm_Hour"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">hourtemps</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&gt;=</span> <span class="fl">25</span> </span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Apply this function to the Winters_hours_gaps dataset</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">WH</span><span class="op">(</span><span class="va">hourtemps</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Year Month Day Hour   Temp Chilling_Hour Warm_Hour
1  2008     3   3   10 15.127         FALSE     FALSE
2  2008     3   3   11 17.153         FALSE     FALSE
3  2008     3   3   12 18.699         FALSE     FALSE
4  2008     3   3   13 18.699         FALSE     FALSE
5  2008     3   3   14 18.842         FALSE     FALSE
6  2008     3   3   15 19.508         FALSE     FALSE
7  2008     3   3   16 19.318         FALSE     FALSE
8  2008     3   3   17 17.701         FALSE     FALSE
9  2008     3   3   18 15.414         FALSE     FALSE
10 2008     3   3   19 12.727         FALSE     FALSE
11 2008     3   3   20 10.369         FALSE     FALSE
12 2008     3   3   21  9.706         FALSE     FALSE
13 2008     3   3   22  9.040         FALSE     FALSE
14 2008     3   3   23  7.920         FALSE     FALSE
15 2008     3   4    0  6.535          TRUE     FALSE
16 2008     3   4    1  6.687          TRUE     FALSE
17 2008     3   4    2  8.767         FALSE     FALSE
18 2008     3   4    3  9.139         FALSE     FALSE
19 2008     3   4    4  6.788          TRUE     FALSE
20 2008     3   4    5  5.076          TRUE     FALSE
21 2008     3   4    6  3.985          TRUE     FALSE
22 2008     3   4    7  3.775          TRUE     FALSE
23 2008     3   4    8 10.001         FALSE     FALSE
24 2008     3   4    9 13.690         FALSE     FALSE
25 2008     3   4   10 15.796         FALSE     FALSE
26 2008     3   4   11 18.081         FALSE     FALSE
27 2008     3   4   12 19.888         FALSE     FALSE
28 2008     3   4   13 20.841         FALSE     FALSE
29 2008     3   4   14 21.366         FALSE     FALSE
30 2008     3   4   15 21.867         FALSE     FALSE
31 2008     3   4   16 21.604         FALSE     FALSE
32 2008     3   4   17 20.079         FALSE     FALSE
33 2008     3   4   18 17.344         FALSE     FALSE
34 2008     3   4   19 13.930         FALSE     FALSE
35 2008     3   4   20 11.929         FALSE     FALSE
36 2008     3   4   21 10.761         FALSE     FALSE
37 2008     3   4   22  9.854         FALSE     FALSE
38 2008     3   4   23  9.706         FALSE     FALSE
39 2008     3   5    0  7.619         FALSE     FALSE
40 2008     3   5    1  9.509         FALSE     FALSE
41 2008     3   5    2 10.883         FALSE     FALSE
42 2008     3   5    3 12.147         FALSE     FALSE
43 2008     3   5    4 12.606         FALSE     FALSE
44 2008     3   5    5 11.880         FALSE     FALSE
45 2008     3   5    6 11.589         FALSE     FALSE
46 2008     3   5    7 11.029         FALSE     FALSE
47 2008     3   5    8 12.171         FALSE     FALSE
48 2008     3   5    9 14.074         FALSE     FALSE
49 2008     3   5   10 15.533         FALSE     FALSE
50 2008     3   5   11 17.605         FALSE     FALSE</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">$</span><span class="va">Warm_Hour</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Extend this function, so that it can take start and end dates as inputs and sums up warm hours between these dates</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sum_WH</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hourtemps</span>, </span>
<span>                   <span class="va">startYEARMODAHO</span>,</span>
<span>                   <span class="va">endYEARMODAHO</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">{</span><span class="va">hourtemps</span><span class="op">[</span>,<span class="st">"Warm_Hour"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">hourtemps</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&gt;</span> <span class="fl">25</span></span>
<span></span>
<span><span class="va">startYear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">startYEARMODAHO</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">startMonth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">startYEARMODAHO</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">startDay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">startYEARMODAHO</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">startHour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">startYEARMODAHO</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">endYear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">endYEARMODAHO</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">endMonth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">endYEARMODAHO</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">endDay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">endYEARMODAHO</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">endHour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">endYEARMODAHO</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Start_Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">$</span><span class="va">Year</span> <span class="op">==</span> <span class="va">startYear</span> <span class="op">&amp;</span></span>
<span>                    <span class="va">hourtemps</span><span class="op">$</span><span class="va">Month</span> <span class="op">==</span> <span class="va">startMonth</span> <span class="op">&amp;</span></span>
<span>                    <span class="va">hourtemps</span><span class="op">$</span><span class="va">Day</span> <span class="op">==</span> <span class="va">startDay</span> <span class="op">&amp;</span></span>
<span>                    <span class="va">hourtemps</span><span class="op">$</span><span class="va">Hour</span> <span class="op">==</span> <span class="va">startHour</span><span class="op">)</span></span>
<span></span>
<span><span class="va">End_Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">$</span><span class="va">Year</span> <span class="op">==</span> <span class="va">endYear</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">hourtemps</span><span class="op">$</span><span class="va">Month</span> <span class="op">==</span> <span class="va">endMonth</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">hourtemps</span><span class="op">$</span><span class="va">Day</span> <span class="op">==</span> <span class="va">endDay</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">hourtemps</span><span class="op">$</span><span class="va">Hour</span> <span class="op">==</span> <span class="va">endHour</span><span class="op">)</span></span>
<span></span>
<span><span class="va">WHs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">$</span><span class="va">Warm_Hour</span><span class="op">[</span><span class="va">Start_Date</span><span class="op">:</span><span class="va">End_Date</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">WHs</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>#Example</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sum_WH</span><span class="op">(</span><span class="va">Winters_hours_gaps</span>, startYEARMODAHO <span class="op">=</span> <span class="fl">2008070100</span>, </span>
<span>                           endYEARMODAHO <span class="op">=</span> <span class="fl">2008073123</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 306</code></pre>
</div>
</div>
<hr></section></section><section id="chapter-7-winter-chill-projections" class="level1"><h1>Chapter 7: Winter Chill Projections</h1>
<section id="exercises-chill-models" class="level2"><h2 class="anchored" data-anchor-id="exercises-chill-models"><strong><em>Exercises Chill Models</em></strong></h2>
<ol type="1">
<li>Run the chilling() function on the Winters_hours_gap dataset #chilling function</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">july</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/chilling.html">chilling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_JDay.html">make_JDay</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">)</span>,</span>
<span>                   Start_JDay <span class="op">=</span> <span class="fl">183</span>, </span>
<span>                   End_JDay <span class="op">=</span> <span class="fl">213</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol type="1">
<li>Create your own temperature-weighting chill model using the step_model() function #step model</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">0</span>,  <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>,   <span class="fl">10</span><span class="op">)</span>,  </span>
<span>  upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>    <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>   <span class="fl">0</span>, <span class="fl">1</span>,  <span class="fl">2</span>,  <span class="fl">3</span>,  <span class="fl">2</span>,  <span class="fl">1</span>,    <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span>, position <span class="op">=</span> <span class="st">"left"</span>, font_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">lower</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">weight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-1000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">custom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/step_model.html">step_model</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">custom</span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">$</span><span class="va">Temp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  [1]  0  0  0  0  0  0  0  0  0  0  0 NA NA NA NA NA NA NA NA NA NA NA NA NA NA
 [26] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
 [51] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
 [76] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
</div>
</div>
<ol type="1">
<li>Run this model on the Winters_hours_gaps dataset using the tempResponse() function.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse.html">tempResponse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_JDay.html">make_JDay</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">)</span>,</span>
<span>                       Start_JDay <span class="op">=</span> <span class="fl">183</span>,</span>
<span>                       End_JDay <span class="op">=</span> <span class="fl">213</span>,</span>
<span>                       models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Chill_Portions <span class="op">=</span> <span class="va">Dynamic_Model</span>, </span>
<span>                                     GDH <span class="op">=</span> <span class="va">GDH</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span>, </span>
<span>                position <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>                font_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Season</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">End_year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Season_days</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Data_days</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Perc_complete</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Chill_Portions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GDH</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">2007/2008</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9771.642</td>
</tr></tbody>
</table>
</div>
</div>
<hr></section></section><section id="chapter-8-making-hourly-temperatures" class="level1"><h1>Chapter 8: Making Hourly Temperatures</h1>
<section id="exercises-on-hourly" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-hourly"><strong><em>Exercises on hourly</em></strong></h2>
<ol type="1">
<li>Choose a location of interest, find out its latitude and produce plots of daily sunrise, sunset and daylength</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="sunset-time-and-daylength-at-rochester-latitude-43.15n-over-the" class="level1"><h1>sunset time and daylength at Rochester (Latitude: 43.15Â°N) over the</h1>
<p>course of the year.</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/daylength.html">daylength</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">43</span>,</span>
<span>                  JDay <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">365</span><span class="op">)</span></span>
<span><span class="va">Days_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    JDay <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">365</span>,</span>
<span>    Sunrise <span class="op">=</span> <span class="va">Days</span><span class="op">$</span><span class="va">Sunrise</span>,</span>
<span>    Sunset <span class="op">=</span> <span class="va">Days</span><span class="op">$</span><span class="va">Sunset</span>,</span>
<span>    Daylength <span class="op">=</span> <span class="va">Days</span><span class="op">$</span><span class="va">Daylength</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">Days_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">Days_df</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Sunrise</span><span class="op">:</span><span class="va">Daylength</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">Days_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">JDay</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Time of Day / Daylength (Hours)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>Produce an hourly dataset, based on idealized daily curves, for the KA_weather dataset (included in chillR)</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/stack_hourly_temps.html">stack_hourly_temps</a></span><span class="op">(</span><span class="va">KA_weather</span>, latitude <span class="op">=</span> <span class="fl">43</span><span class="op">)</span> <span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      Year Month Day Tmax Tmin JDay Hour     Temp
1     1998     1   1  8.2  5.1    1    0 5.100000
4535  1998     1   1  8.2  5.1    1    1 5.100000
9069  1998     1   1  8.2  5.1    1    2 5.100000
13603 1998     1   1  8.2  5.1    1    3 5.100000
18137 1998     1   1  8.2  5.1    1    4 5.100000
22671 1998     1   1  8.2  5.1    1    5 5.100000
27205 1998     1   1  8.2  5.1    1    6 5.100000
31739 1998     1   1  8.2  5.1    1    7 5.100000
36273 1998     1   1  8.2  5.1    1    8 5.494357
40807 1998     1   1  8.2  5.1    1    9 6.215506
45341 1998     1   1  8.2  5.1    1   10 6.872424
49875 1998     1   1  8.2  5.1    1   11 7.427284
54409 1998     1   1  8.2  5.1    1   12 7.848137
58943 1998     1   1  8.2  5.1    1   13 8.110750
63477 1998     1   1  8.2  5.1    1   14 8.200000
68011 1998     1   1  8.2  5.1    1   15 8.110750
72545 1998     1   1  8.2  5.1    1   16 7.848137
77079 1998     1   1  8.2  5.1    1   17 7.275663
81613 1998     1   1  8.2  5.1    1   18 6.780076
86147 1998     1   1  8.2  5.1    1   19 6.455465</code></pre>
</div>
</div>
<ol type="1">
<li>Produce empirical temperature curve parameters for the Winters_hours_gaps dataset, and use them to predict hourly values from daily temperatures (this is very similar to the example above,but please make sure you understand whatâs going on).</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">empi_curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/Empirical_daily_temperature_curve.html">Empirical_daily_temperature_curve</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Winters_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_all_day_table.html">make_all_day_table</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span>, input_timestep <span class="op">=</span> <span class="st">"hour"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr></section><section id="chapter-9-some-useful-tools-in-r" class="level1"><h1>Chapter 9: Some Useful tools in R</h1>
<section id="exercises-on-useful-r-tools" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-useful-r-tools"><strong><em>Exercises on useful R tools</em></strong></h2>
<ol type="1">
<li>Based on the Winters_hours_gaps dataset, use magrittr pipes and functions of the tidyverse to accomplish the following:</li>
</ol>
<ul>
<li>Convert the dataset into a tibble</li>
<li>Select only the top 10 rows of the dataset</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>ââ Attaching core tidyverse packages ââââââââââââââââââââââââ tidyverse 2.0.0 ââ
â forcats   1.0.0     â readr     2.1.5
â lubridate 1.9.3     â stringr   1.5.1
â purrr     1.0.2     â tibble    3.2.1
ââ Conflicts ââââââââââââââââââââââââââââââââââââââââââ tidyverse_conflicts() ââ
â dplyr::filter()          masks stats::filter()
â kableExtra::group_rows() masks dplyr::group_rows()
â dplyr::lag()             masks stats::lag()
â lubridate::leap_year()   masks chillR::leap_year()
â¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">WHG</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 Ã 6
    Year Month   Day  Hour Temp_gaps  Temp
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1  2008     3     3    10      15.1  15.1
 2  2008     3     3    11      17.2  17.2
 3  2008     3     3    12      18.7  18.7
 4  2008     3     3    13      18.7  18.7
 5  2008     3     3    14      18.8  18.8
 6  2008     3     3    15      19.5  19.5
 7  2008     3     3    16      19.3  19.3
 8  2008     3     3    17      17.7  17.7
 9  2008     3     3    18      15.4  15.4
10  2008     3     3    19      12.7  12.7</code></pre>
</div>
</div>
<ul>
<li>Convert the tibble to a long format, with separate rows for Temp_gaps and Temp</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHGlong</span> <span class="op">&lt;-</span> <span class="va">WHG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">Temp_gaps</span><span class="op">:</span><span class="va">Temp</span><span class="op">)</span></span>
<span><span class="va">WHGlong</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 Ã 6
    Year Month   Day  Hour name      value
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;
 1  2008     3     3    10 Temp_gaps  15.1
 2  2008     3     3    10 Temp       15.1
 3  2008     3     3    11 Temp_gaps  17.2
 4  2008     3     3    11 Temp       17.2
 5  2008     3     3    12 Temp_gaps  18.7
 6  2008     3     3    12 Temp       18.7
 7  2008     3     3    13 Temp_gaps  18.7
 8  2008     3     3    13 Temp       18.7
 9  2008     3     3    14 Temp_gaps  18.8
10  2008     3     3    14 Temp       18.8
11  2008     3     3    15 Temp_gaps  19.5
12  2008     3     3    15 Temp       19.5
13  2008     3     3    16 Temp_gaps  19.3
14  2008     3     3    16 Temp       19.3
15  2008     3     3    17 Temp_gaps  17.7
16  2008     3     3    17 Temp       17.7
17  2008     3     3    18 Temp_gaps  15.4
18  2008     3     3    18 Temp       15.4
19  2008     3     3    19 Temp_gaps  12.7
20  2008     3     3    19 Temp       12.7</code></pre>
</div>
</div>
<ul>
<li>Use ggplot2 to plot Temp_gaps and Temp as facets (point or line plot)</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">WHGlong</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Hour</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">12</span>,colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Temperature (Â°C)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Convert the dataset back to the wide format</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHGwide</span> <span class="op">&lt;-</span> <span class="va">WHGlong</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span><span class="va">WHGwide</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 Ã 6
    Year Month   Day  Hour Temp_gaps  Temp
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1  2008     3     3    10      15.1  15.1
 2  2008     3     3    11      17.2  17.2
 3  2008     3     3    12      18.7  18.7
 4  2008     3     3    13      18.7  18.7
 5  2008     3     3    14      18.8  18.8
 6  2008     3     3    15      19.5  19.5
 7  2008     3     3    16      19.3  19.3
 8  2008     3     3    17      17.7  17.7
 9  2008     3     3    18      15.4  15.4
10  2008     3     3    19      12.7  12.7</code></pre>
</div>
</div>
<ul>
<li>Select only the following columns: Year, Month, Day and Temp</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Month</span>, <span class="va">Day</span>, <span class="va">Temp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 Ã 4
    Year Month   Day  Temp
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1  2008     3     3  15.1
 2  2008     3     3  17.2
 3  2008     3     3  18.7
 4  2008     3     3  18.7
 5  2008     3     3  18.8
 6  2008     3     3  19.5
 7  2008     3     3  19.3
 8  2008     3     3  17.7
 9  2008     3     3  15.4
10  2008     3     3  12.7</code></pre>
</div>
</div>
<ul>
<li>Sort the dataset by the Temp column, in descending order</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Temp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 Ã 6
    Year Month   Day  Hour Temp_gaps  Temp
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1  2008     3     3    15      19.5  19.5
 2  2008     3     3    16      19.3  19.3
 3  2008     3     3    14      18.8  18.8
 4  2008     3     3    12      18.7  18.7
 5  2008     3     3    13      18.7  18.7
 6  2008     3     3    17      17.7  17.7
 7  2008     3     3    11      17.2  17.2
 8  2008     3     3    18      15.4  15.4
 9  2008     3     3    10      15.1  15.1
10  2008     3     3    19      12.7  12.7</code></pre>
</div>
</div>
<ol type="1">
<li>For the Winter_hours_gaps dataset, write a for loop to convert all temperatures (Temp column) to degrees Fahrenheit</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Temp</span> <span class="op">&lt;-</span> <span class="va">Winters_hours_gaps</span><span class="op">$</span><span class="va">Temp</span><span class="op">[</span><span class="fl">183</span><span class="op">:</span><span class="fl">213</span><span class="op">]</span> <span class="co"># JDay for July</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">Temp</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">Fahrenheit</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="fl">32</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">Fahrenheit</span><span class="op">)</span> </span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 57.9362
[1] 56.3828
[1] 56.0354
[1] 54.8654
[1] 46.481
[1] 44.7188
[1] 44.2184
[1] 45.3074
[1] 53.078
[1] 59.7884
[1] 64.0328
[1] 68.1422
[1] 68.5274
[1] 70.2014
[1] 68.7848
[1] 69.4706
[1] 70.5434
[1] 68.3132
[1] 62.6612
[1] 57.5924
[1] 54.9518
[1] 52.5092
[1] 51.1484
[1] 52.6406
[1] 57.074
[1] 56.9876
[1] 49.2044
[1] 47.2442
[1] 46.571
[1] 46.346
[1] 44.8556</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Execute the same operation with a function from the apply family</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">Winters_hours_gaps</span><span class="op">$</span><span class="va">Temp</span><span class="op">[</span><span class="fl">183</span><span class="op">:</span><span class="fl">213</span><span class="op">]</span></span>
<span></span>
<span><span class="va">fahrenheit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="fl">32</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fahrenheit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] 57.9362 56.3828 56.0354 54.8654 46.4810 44.7188 44.2184 45.3074 53.0780
[10] 59.7884 64.0328 68.1422 68.5274 70.2014 68.7848 69.4706 70.5434 68.3132
[19] 62.6612 57.5924 54.9518 52.5092 51.1484 52.6406 57.0740 56.9876 49.2044
[28] 47.2442 46.5710 46.3460 44.8556</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Now use the tidyverse function mutate to achieve the same outcome</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHG_F</span> <span class="op">&lt;-</span> <span class="va">WHG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Temp_F <span class="op">=</span> <span class="va">Temp</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="fl">32</span><span class="op">)</span></span>
<span><span class="va">WHG_F</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 Ã 7
    Year Month   Day  Hour Temp_gaps  Temp Temp_F
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1  2008     3     3    10      15.1  15.1   59.2
 2  2008     3     3    11      17.2  17.2   62.9
 3  2008     3     3    12      18.7  18.7   65.7
 4  2008     3     3    13      18.7  18.7   65.7
 5  2008     3     3    14      18.8  18.8   65.9
 6  2008     3     3    15      19.5  19.5   67.1
 7  2008     3     3    16      19.3  19.3   66.8
 8  2008     3     3    17      17.7  17.7   63.9
 9  2008     3     3    18      15.4  15.4   59.7
10  2008     3     3    19      12.7  12.7   54.9</code></pre>
</div>
</div>
<hr></section></section><section id="chapter-10-getting-temperature-data" class="level1"><h1>Chapter 10: Getting temperature data</h1>
<section id="exercises-on-getting-temperature-data" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-getting-temperature-data"><strong><em>Exercises on getting temperature data</em></strong></h2>
<ol type="1">
<li>Choose a location of interest and find the 25 closest weather stations using the handle_gsod function</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="va">station_list_Rochester</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action<span class="op">=</span><span class="st">"list_stations"</span>,</span>
<span>                          location<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span><span class="op">)</span>,</span>
<span>                          time_interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1990</span>,<span class="fl">2020</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'magrittr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    set_names</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">station_list_Rochester</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span>, position <span class="op">=</span> <span class="st">"left"</span>, font_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">chillR_code</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">STATION.NAME</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CTRY</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Long</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BEGIN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">END</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Distance</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Overlap_years</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Perc_interval_covered</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">72529014768</td>
<td style="text-align: left;">GREATER ROCHESTER INTERNATIONAL AP</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.117</td>
<td style="text-align: right;">-77.675</td>
<td style="text-align: right;">19730101</td>
<td style="text-align: right;">20241103</td>
<td style="text-align: right;">7.11</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">99999914768</td>
<td style="text-align: left;">ROCHESTER MONROE CO ARPT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.117</td>
<td style="text-align: right;">-77.677</td>
<td style="text-align: right;">19480101</td>
<td style="text-align: right;">19721231</td>
<td style="text-align: right;">7.25</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72529599999</td>
<td style="text-align: left;">ROCHESTER COAST GUARD LIGHT STAT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.250</td>
<td style="text-align: right;">-77.600</td>
<td style="text-align: right;">19760926</td>
<td style="text-align: right;">19960701</td>
<td style="text-align: right;">11.13</td>
<td style="text-align: right;">6.50</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">99800999999</td>
<td style="text-align: left;">ROCHESTER</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.250</td>
<td style="text-align: right;">-77.583</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">11.22</td>
<td style="text-align: right;">13.00</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">99826799999</td>
<td style="text-align: left;">ROCHESTER</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.269</td>
<td style="text-align: right;">-77.626</td>
<td style="text-align: right;">20100101</td>
<td style="text-align: right;">20210114</td>
<td style="text-align: right;">13.41</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">99719099999</td>
<td style="text-align: left;">LAKE ONTARIO BUOY - 20NM NORTH NORTHEAST</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.620</td>
<td style="text-align: right;">-77.410</td>
<td style="text-align: right;">20080517</td>
<td style="text-align: right;">20081125</td>
<td style="text-align: right;">54.53</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72498899999</td>
<td style="text-align: left;">DANSVILLE MUNI</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.571</td>
<td style="text-align: right;">-77.713</td>
<td style="text-align: right;">20010811</td>
<td style="text-align: right;">20031231</td>
<td style="text-align: right;">65.11</td>
<td style="text-align: right;">2.39</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">72523094704</td>
<td style="text-align: left;">DANSVILLE/MUNICIPAL</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.571</td>
<td style="text-align: right;">-77.713</td>
<td style="text-align: right;">19730101</td>
<td style="text-align: right;">19850131</td>
<td style="text-align: right;">65.11</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">99999994704</td>
<td style="text-align: left;">DANSVILLE MUNI AP</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.571</td>
<td style="text-align: right;">-77.713</td>
<td style="text-align: right;">19490101</td>
<td style="text-align: right;">20001101</td>
<td style="text-align: right;">65.11</td>
<td style="text-align: right;">10.84</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">72498894704</td>
<td style="text-align: left;">DANSVILLE MUNICIPAL ARPT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.570</td>
<td style="text-align: right;">-77.714</td>
<td style="text-align: right;">20010102</td>
<td style="text-align: right;">20241030</td>
<td style="text-align: right;">65.23</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: right;">65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72523099999</td>
<td style="text-align: left;">DANSVILLE MUNICIPAL</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.567</td>
<td style="text-align: right;">-77.717</td>
<td style="text-align: right;">20020418</td>
<td style="text-align: right;">20041014</td>
<td style="text-align: right;">65.60</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">72519454778</td>
<td style="text-align: left;">PENN YAN AIRPORT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.644</td>
<td style="text-align: right;">-77.053</td>
<td style="text-align: right;">20060101</td>
<td style="text-align: right;">20241103</td>
<td style="text-align: right;">71.85</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9999994727</td>
<td style="text-align: left;">GENEVA SAMPSON AFB</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.750</td>
<td style="text-align: right;">-76.900</td>
<td style="text-align: right;">19520102</td>
<td style="text-align: right;">19560624</td>
<td style="text-align: right;">72.36</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">72519499999</td>
<td style="text-align: left;">PENN YAN</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.633</td>
<td style="text-align: right;">-77.050</td>
<td style="text-align: right;">19990114</td>
<td style="text-align: right;">20051231</td>
<td style="text-align: right;">72.97</td>
<td style="text-align: right;">6.97</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">71430099999</td>
<td style="text-align: left;">POINT PETRE (AUT) ONT</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.833</td>
<td style="text-align: right;">-77.150</td>
<td style="text-align: right;">19770611</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">84.27</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">71626899999</td>
<td style="text-align: left;">PT PETRE</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.833</td>
<td style="text-align: right;">-77.150</td>
<td style="text-align: right;">19770701</td>
<td style="text-align: right;">19800625</td>
<td style="text-align: right;">84.27</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72626899999</td>
<td style="text-align: left;">POINT PETRE (MARS)</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.833</td>
<td style="text-align: right;">-77.150</td>
<td style="text-align: right;">19750905</td>
<td style="text-align: right;">19770630</td>
<td style="text-align: right;">84.27</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">99596099999</td>
<td style="text-align: left;">PRINCE EDWARD PT</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.790</td>
<td style="text-align: right;">-76.870</td>
<td style="text-align: right;">19911018</td>
<td style="text-align: right;">20081123</td>
<td style="text-align: right;">92.49</td>
<td style="text-align: right;">17.10</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">99798999999</td>
<td style="text-align: left;">OLCOTT HARBOR</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.333</td>
<td style="text-align: right;">-78.717</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">92.85</td>
<td style="text-align: right;">13.00</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="even">
<td style="text-align: left;">72519599999</td>
<td style="text-align: left;">OSWEGO COAST GUARD STATION</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.470</td>
<td style="text-align: right;">-76.520</td>
<td style="text-align: right;">19760926</td>
<td style="text-align: right;">19960701</td>
<td style="text-align: right;">94.46</td>
<td style="text-align: right;">6.50</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">99726499999</td>
<td style="text-align: left;">9052030 - OSWEGO NY</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.460</td>
<td style="text-align: right;">-76.510</td>
<td style="text-align: right;">20041122</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">94.81</td>
<td style="text-align: right;">16.11</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="even">
<td style="text-align: left;">99999914733</td>
<td style="text-align: left;">BUFFALO BUFFALO ARPT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.941</td>
<td style="text-align: right;">-78.736</td>
<td style="text-align: right;">19720101</td>
<td style="text-align: right;">19721231</td>
<td style="text-align: right;">95.30</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72528014733</td>
<td style="text-align: left;">BUFFALO NIAGARA INTERNATIONAL AIRPOR</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.940</td>
<td style="text-align: right;">-78.736</td>
<td style="text-align: right;">19420201</td>
<td style="text-align: right;">20241103</td>
<td style="text-align: right;">95.33</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">71431099999</td>
<td style="text-align: left;">COBOURG (AUT) ONT</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.950</td>
<td style="text-align: right;">-78.167</td>
<td style="text-align: right;">19770611</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">100.12</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">71626699999</td>
<td style="text-align: left;">COBOURG</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.950</td>
<td style="text-align: right;">-78.167</td>
<td style="text-align: right;">19770701</td>
<td style="text-align: right;">19800809</td>
<td style="text-align: right;">100.12</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">station_list_Rochester</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 Ã 10
   chillR_code STATION.NAME             CTRY    Lat  Long  BEGIN    END Distance
   &lt;chr&gt;       &lt;chr&gt;                    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1 72529014768 GREATER ROCHESTER INTERâ¦ US     43.1 -77.7 1.97e7 2.02e7     7.11
 2 99999914768 ROCHESTER MONROE CO ARPT US     43.1 -77.7 1.95e7 1.97e7     7.25
 3 72529599999 ROCHESTER COAST GUARD Lâ¦ US     43.2 -77.6 1.98e7 2.00e7    11.1 
 4 99800999999 ROCHESTER                US     43.2 -77.6 2.01e7 2.02e7    11.2 
 5 99826799999 ROCHESTER                US     43.3 -77.6 2.01e7 2.02e7    13.4 
 6 99719099999 LAKE ONTARIO BUOY - 20Nâ¦ US     43.6 -77.4 2.01e7 2.01e7    54.5 
 7 72498899999 DANSVILLE MUNI           US     42.6 -77.7 2.00e7 2.00e7    65.1 
 8 72523094704 DANSVILLE/MUNICIPAL      US     42.6 -77.7 1.97e7 1.99e7    65.1 
 9 99999994704 DANSVILLE MUNI AP        US     42.6 -77.7 1.95e7 2.00e7    65.1 
10 72498894704 DANSVILLE MUNICIPAL ARPT US     42.6 -77.7 2.00e7 2.02e7    65.2 
# â¹ 15 more rows
# â¹ 2 more variables: Overlap_years &lt;dbl&gt;, Perc_interval_covered &lt;dbl&gt;</code></pre>
</div>
</div>
<ol type="1">
<li>Download weather data for the most promising station on the list</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"download_weather"</span>,</span>
<span>                       location <span class="op">=</span> <span class="va">station_list_Rochester</span><span class="op">$</span><span class="va">chillR_code</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                       time_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1990</span>, <span class="fl">2020</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Loading data for 31 years from station 'GREATER ROCHESTER INTERNATIONAL AP'
================================================================================</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       STATION       DATE LATITUDE LONGITUDE ELEVATION
1  72529014768 1990-01-01 43.11723 -77.67539     164.5
2  72529014768 1990-01-02 43.11723 -77.67539     164.5
3  72529014768 1990-01-03 43.11723 -77.67539     164.5
4  72529014768 1990-01-04 43.11723 -77.67539     164.5
5  72529014768 1990-01-05 43.11723 -77.67539     164.5
6  72529014768 1990-01-06 43.11723 -77.67539     164.5
7  72529014768 1990-01-07 43.11723 -77.67539     164.5
8  72529014768 1990-01-08 43.11723 -77.67539     164.5
9  72529014768 1990-01-09 43.11723 -77.67539     164.5
10 72529014768 1990-01-10 43.11723 -77.67539     164.5
11 72529014768 1990-01-11 43.11723 -77.67539     164.5
12 72529014768 1990-01-12 43.11723 -77.67539     164.5
13 72529014768 1990-01-13 43.11723 -77.67539     164.5
14 72529014768 1990-01-14 43.11723 -77.67539     164.5
15 72529014768 1990-01-15 43.11723 -77.67539     164.5
16 72529014768 1990-01-16 43.11723 -77.67539     164.5
17 72529014768 1990-01-17 43.11723 -77.67539     164.5
18 72529014768 1990-01-18 43.11723 -77.67539     164.5
19 72529014768 1990-01-19 43.11723 -77.67539     164.5
20 72529014768 1990-01-20 43.11723 -77.67539     164.5
                                                                NAME TEMP
1  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 31.1
2  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 30.1
3  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 33.8
4  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 43.7
5  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 33.0
6  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 26.2
7  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 29.0
8  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 37.3
9  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 36.7
10 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 36.5
11 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 34.3
12 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 28.7
13 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 16.3
14 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 23.5
15 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 35.7
16 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 41.5
17 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 45.4
18 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 46.8
19 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 29.2
20 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 28.3
   TEMP_ATTRIBUTES DEWP DEWP_ATTRIBUTES    SLP SLP_ATTRIBUTES   STP
1               24 25.0              24 1006.2             24 985.6
2               24 20.1              24 1022.9             24   1.8
3               24 22.0              24 1023.5             24   2.5
4               24 34.3              24 1012.1             24 991.5
5               24 26.3              24 1018.9             24 998.1
6               24 22.2              24 1018.1             24 997.0
7               24 20.6              24 1017.0             24 996.0
8               24 27.7              24 1012.2             24 991.5
9               24 27.4              24 1008.0             24 987.4
10              24 31.8              24 1002.7             24 982.3
11              24 29.2              24 1002.0             24 981.4
12              24 23.5              24  995.5             24 975.0
13              24 10.5              24 1015.8             24 994.6
14              24 15.0              24 1026.1             24   4.7
15              24 25.0              24 1020.2             24 999.2
16              24 37.0              24 1023.3             24   2.5
17              24 42.6              24 1020.9             24   0.2
18              24 42.4              24 1013.1             24 992.7
19              24 19.7              24 1027.7             24   6.6
20              24 21.1              24 1022.3             24   1.2
   STP_ATTRIBUTES VISIB VISIB_ATTRIBUTES WDSP WDSP_ATTRIBUTES MXSPD  GUST  MAX
1              24   9.6               24 15.2              24  21.0  27.0 44.1
2              24  14.8               24 13.7              24  19.0  28.9 36.0
3              24  16.4               24  6.5              24  11.1 999.9 44.1
4              24  15.2               24  9.2              24  17.1  27.0 46.9
5              24  15.6               24 10.0              24  15.0 999.9 48.0
6              24  11.7               24  8.5              24  18.1  25.1 35.1
7              24  16.9               24  9.1              24  20.0  25.1 43.0
8              24  14.0               24  7.9              24  15.9 999.9 44.1
9              24  12.6               24  8.2              24  12.0 999.9 45.0
10             24   7.0               24  7.8              24  15.9 999.9 41.0
11             24   8.9               24 11.9              24  25.1  34.0 39.9
12             24   5.9               24 17.3              24  22.9  34.0 39.9
13             24   8.3               24 14.5              24  21.0  25.1 34.0
14             24  11.2               24 10.3              24  18.1  25.1 25.0
15             24  12.1               24  8.2              24  15.9  22.9 43.0
16             24   6.4               24  8.0              24  14.0  20.0 50.0
17             24   4.1               24  6.5              24  12.0 999.9 55.0
18             24   9.8               24 12.9              24  17.1  22.0 55.9
19             24  15.8               24 10.6              24  17.1  25.1 36.0
20             24  13.8               24  4.0              24   6.0 999.9 35.1
   MAX_ATTRIBUTES  MIN MIN_ATTRIBUTES PRCP PRCP_ATTRIBUTES  SNDP FRSHTT
1                 25.0                0.20               G   2.8  11000
2               * 26.1                0.04               G   2.8      0
3               * 27.0                0.00               G   2.0      0
4               * 37.9                0.02               D   0.8  10000
5                 28.0                0.08               G 999.9  10000
6                 19.0                0.00               G 999.9 101000
7               * 15.1                0.02               C 999.9      0
8               * 28.9                0.00               D 999.9      0
9                 34.0                0.00               C 999.9  10000
10                33.1              * 0.08               G 999.9 111000
11                32.0                0.08               G 999.9 111000
12                21.0              * 0.08               G 999.9   1000
13                10.0                0.12               G   2.0   1000
14              * 18.0                0.00               G   0.8   1000
15              * 25.0                0.01               G   0.8  10000
16              * 37.0                0.00               G 999.9 110000
17              * 36.0                0.04               G 999.9 110000
18                36.0              * 0.35               G 999.9  10000
19              * 24.1                0.04               G 999.9   1000
20              * 23.0                0.00               G 999.9      0</code></pre>
</div>
</div>
<ol type="1">
<li>Convert the weather data into chillR format</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cleaned_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span><span class="va">weather</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cleaned_weather</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Date Year Month Day    Tmin   Tmax  Tmean  Prec
1  1990-01-01 1990     1   1  -3.889  6.722 -0.500 5.080
2  1990-01-02 1990     1   2  -3.278  2.222 -1.056 1.016
3  1990-01-03 1990     1   3  -2.778  6.722  1.000 0.000
4  1990-01-04 1990     1   4   3.278  8.278  6.500 0.508
5  1990-01-05 1990     1   5  -2.222  8.889  0.556 2.032
6  1990-01-06 1990     1   6  -7.222  1.722 -3.222 0.000
7  1990-01-07 1990     1   7  -9.389  6.111 -1.667 0.508
8  1990-01-08 1990     1   8  -1.722  6.722  2.944 0.000
9  1990-01-09 1990     1   9   1.111  7.222  2.611 0.000
10 1990-01-10 1990     1  10   0.611  5.000  2.500 2.032
11 1990-01-11 1990     1  11   0.000  4.389  1.278 2.032
12 1990-01-12 1990     1  12  -6.111  4.389 -1.833 2.032
13 1990-01-13 1990     1  13 -12.222  1.111 -8.722 3.048
14 1990-01-14 1990     1  14  -7.778 -3.889 -4.722 0.000
15 1990-01-15 1990     1  15  -3.889  6.111  2.056 0.254
16 1990-01-16 1990     1  16   2.778 10.000  5.278 0.000
17 1990-01-17 1990     1  17   2.222 12.778  7.444 1.016
18 1990-01-18 1990     1  18   2.222 13.278  8.222 8.890
19 1990-01-19 1990     1  19  -4.389  2.222 -1.556 1.016
20 1990-01-20 1990     1  20  -5.000  1.722 -2.056 0.000</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="st">"data_New_York"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in dir.create("data_New_York"): 'data_New_York' already exists</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">station_list_Rochester</span>,</span>
<span>          <span class="st">"data_New_York/station_list_Rochester.csv"</span>,</span>
<span>          row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">weather</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>          <span class="st">"data_New_York/Rochester_weather.csv"</span>,</span>
<span>          row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">cleaned_weather</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>          <span class="st">"data_New_York/Rochester_chillR_weather.csv"</span>,</span>
<span>          row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr></section></section><section id="chapter-11-getting-temperature-data" class="level1"><h1>Chapter 11: Getting temperature data</h1>
<section id="exercises-on-getting-temperature-data-1" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-getting-temperature-data-1"><strong><em>Exercises on getting temperature data</em></strong></h2>
<ol type="1">
<li>Use chillR functions to find out how many gaps you have in this dataset (even if you have none, please still follow all further steps)</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Rochester</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data_New_York/Rochester_chillR_weather.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Rochester_QC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">Rochester</span><span class="op">)</span><span class="op">$</span><span class="va">QC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Create a list of the 25 closest weather stations using the handle_gsod function</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">station_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action<span class="op">=</span><span class="st">"list_stations"</span>,</span>
<span>                            location<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span><span class="op">)</span>,</span>
<span>                              time_interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1990</span>,<span class="fl">2020</span><span class="op">)</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">station_list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 Ã 10
   chillR_code STATION.NAME             CTRY    Lat  Long  BEGIN    END Distance
   &lt;chr&gt;       &lt;chr&gt;                    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1 72529014768 GREATER ROCHESTER INTERâ¦ US     43.1 -77.7 1.97e7 2.02e7     7.11
 2 99999914768 ROCHESTER MONROE CO ARPT US     43.1 -77.7 1.95e7 1.97e7     7.25
 3 72529599999 ROCHESTER COAST GUARD Lâ¦ US     43.2 -77.6 1.98e7 2.00e7    11.1 
 4 99800999999 ROCHESTER                US     43.2 -77.6 2.01e7 2.02e7    11.2 
 5 99826799999 ROCHESTER                US     43.3 -77.6 2.01e7 2.02e7    13.4 
 6 99719099999 LAKE ONTARIO BUOY - 20Nâ¦ US     43.6 -77.4 2.01e7 2.01e7    54.5 
 7 72498899999 DANSVILLE MUNI           US     42.6 -77.7 2.00e7 2.00e7    65.1 
 8 72523094704 DANSVILLE/MUNICIPAL      US     42.6 -77.7 1.97e7 1.99e7    65.1 
 9 99999994704 DANSVILLE MUNI AP        US     42.6 -77.7 1.95e7 2.00e7    65.1 
10 72498894704 DANSVILLE MUNICIPAL ARPT US     42.6 -77.7 2.00e7 2.02e7    65.2 
# â¹ 15 more rows
# â¹ 2 more variables: Overlap_years &lt;dbl&gt;, Perc_interval_covered &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">station_list</span>, n <span class="op">=</span> <span class="fl">26</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 Ã 10
   chillR_code STATION.NAME             CTRY    Lat  Long  BEGIN    END Distance
   &lt;chr&gt;       &lt;chr&gt;                    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1 72529014768 GREATER ROCHESTER INTERâ¦ US     43.1 -77.7 1.97e7 2.02e7     7.11
 2 99999914768 ROCHESTER MONROE CO ARPT US     43.1 -77.7 1.95e7 1.97e7     7.25
 3 72529599999 ROCHESTER COAST GUARD Lâ¦ US     43.2 -77.6 1.98e7 2.00e7    11.1 
 4 99800999999 ROCHESTER                US     43.2 -77.6 2.01e7 2.02e7    11.2 
 5 99826799999 ROCHESTER                US     43.3 -77.6 2.01e7 2.02e7    13.4 
 6 99719099999 LAKE ONTARIO BUOY - 20Nâ¦ US     43.6 -77.4 2.01e7 2.01e7    54.5 
 7 72498899999 DANSVILLE MUNI           US     42.6 -77.7 2.00e7 2.00e7    65.1 
 8 72523094704 DANSVILLE/MUNICIPAL      US     42.6 -77.7 1.97e7 1.99e7    65.1 
 9 99999994704 DANSVILLE MUNI AP        US     42.6 -77.7 1.95e7 2.00e7    65.1 
10 72498894704 DANSVILLE MUNICIPAL ARPT US     42.6 -77.7 2.00e7 2.02e7    65.2 
11 72523099999 DANSVILLE MUNICIPAL      US     42.6 -77.7 2.00e7 2.00e7    65.6 
12 72519454778 PENN YAN AIRPORT         US     42.6 -77.1 2.01e7 2.02e7    71.8 
13 9999994727  GENEVA SAMPSON AFB       US     42.8 -76.9 1.95e7 1.96e7    72.4 
14 72519499999 PENN YAN                 US     42.6 -77.0 2.00e7 2.01e7    73.0 
15 71430099999 POINT PETRE (AUT)  ONT   CA     43.8 -77.2 1.98e7 2.02e7    84.3 
16 71626899999 PT PETRE                 CA     43.8 -77.2 1.98e7 1.98e7    84.3 
17 72626899999 POINT PETRE (MARS)       CA     43.8 -77.2 1.98e7 1.98e7    84.3 
18 99596099999 PRINCE EDWARD PT         CA     43.8 -76.9 1.99e7 2.01e7    92.5 
19 99798999999 OLCOTT HARBOR            US     43.3 -78.7 2.01e7 2.02e7    92.8 
20 72519599999 OSWEGO COAST GUARD STATâ¦ US     43.5 -76.5 1.98e7 2.00e7    94.5 
21 99726499999 9052030 - OSWEGO  NY     US     43.5 -76.5 2.00e7 2.02e7    94.8 
22 99999914733 BUFFALO BUFFALO ARPT     US     42.9 -78.7 1.97e7 1.97e7    95.3 
23 72528014733 BUFFALO NIAGARA INTERNAâ¦ US     42.9 -78.7 1.94e7 2.02e7    95.3 
24 71431099999 COBOURG (AUT)  ONT       CA     44.0 -78.2 1.98e7 2.02e7   100.  
25 71626699999 COBOURG                  CA     44.0 -78.2 1.98e7 1.98e7   100.  
# â¹ 2 more variables: Overlap_years &lt;dbl&gt;, Perc_interval_covered &lt;dbl&gt;</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Identify suitable weather stations for patching gaps</li>
</ol>
<p>#download stations number 4, 5, and 10 these will be used to patch the gaps</p>
<ol start="4" type="1">
<li>Download weather data for promising stations, convert them to chillR format and compile them in a list</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patch_weather</span><span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"download_weather"</span>,</span>
<span>              location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">station_list</span><span class="op">$</span><span class="va">chillR_code</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>              time_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1990</span>,<span class="fl">2020</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Loading data for 31 years from station 'DANSVILLE MUNICIPAL ARPT'
================================================================================

Loading data for 31 years from station 'ROCHESTER'
================================================================================

Loading data for 31 years from station 'ROCHESTER'
================================================================================</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Use the patch_daily_temperatures function to fill gaps</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/patch_daily_temperatures.html">patch_daily_temperatures</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester</span>,</span>
<span>                                    patch_weather <span class="op">=</span> <span class="va">patch_weather</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -0.213      2.319      0           0
Tmax    -0.521      2.143      0           1</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -2.944      2.520      0           0
Tmax     2.408      2.624      0           1</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -2.238      2.316      0           0
Tmax     2.325      2.761      0           1</code></pre>
</div>
</div>
<p>#set minimum quality criteria</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/patch_daily_temperatures.html">patch_daily_temperatures</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester</span>,</span>
<span>                                    patch_weather <span class="op">=</span> <span class="va">patch_weather</span>,</span>
<span>                                    max_mean_bias <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                    max_stdev_bias <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -0.213      2.319      0           0
Tmax    -0.521      2.143      0           1</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -2.944      2.520      0           0
Tmax     2.408      2.624      0           1</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -2.238      2.316      0           0
Tmax     2.325      2.761      0           1</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Investigate the results - have all gaps been filled?</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_patch_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">patched</span><span class="op">)</span><span class="op">$</span><span class="va">QC</span></span>
<span></span>
<span><span class="va">post_patch_stats</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      Season End_year Season_days Data_days Missing_Tmin Missing_Tmax
1  1989/1990     1990         365       365            0            0
2  1990/1991     1991         365       365            0            0
3  1991/1992     1992         366       366            0            0
4  1992/1993     1993         365       365            0            0
5  1993/1994     1994         365       365            0            0
6  1994/1995     1995         365       365            0            0
7  1995/1996     1996         366       366            0            0
8  1996/1997     1997         365       365            0            0
9  1997/1998     1998         365       365            0            0
10 1998/1999     1999         365       365            0            0
11 1999/2000     2000         366       366            0            0
12 2000/2001     2001         365       365            0            0
13 2001/2002     2002         365       365            0            1
14 2002/2003     2003         365       365            0            0
15 2003/2004     2004         366       366            0            0
16 2004/2005     2005         365       365            0            0
17 2005/2006     2006         365       365            0            0
18 2006/2007     2007         365       365            0            0
19 2007/2008     2008         366       366            0            0
20 2008/2009     2009         365       365            0            0
21 2009/2010     2010         365       365            0            0
22 2010/2011     2011         365       365            0            0
23 2011/2012     2012         366       366            0            0
24 2012/2013     2013         365       365            0            0
25 2013/2014     2014         365       365            0            0
26 2014/2015     2015         365       365            0            0
27 2015/2016     2016         366       366            0            0
28 2016/2017     2017         365       365            0            0
29 2017/2018     2018         365       365            0            0
30 2018/2019     2019         365       365            0            0
31 2019/2020     2020         366       366            0            0
   Incomplete_days Perc_complete
1                0         100.0
2                0         100.0
3                0         100.0
4                0         100.0
5                0         100.0
6                0         100.0
7                0         100.0
8                0         100.0
9                0         100.0
10               0         100.0
11               0         100.0
12               0         100.0
13               1          99.7
14               0         100.0
15               0         100.0
16               0         100.0
17               0         100.0
18               0         100.0
19               0         100.0
20               0         100.0
21               0         100.0
22               0         100.0
23               0         100.0
24               0         100.0
25               0         100.0
26               0         100.0
27               0         100.0
28               0         100.0
29               0         100.0
30               0         100.0
31               0         100.0</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>If necessary, repeat until you have a dataset you can work with in further analyses</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Rochester_weather</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">patched</span><span class="op">)</span></span>
<span></span>
<span><span class="va">patched_monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/patch_daily_temps.html">patch_daily_temps</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester</span>,</span>
<span>                                     patch_weather <span class="op">=</span> <span class="va">patch_weather</span>,</span>
<span>                                     max_mean_bias <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                     max_stdev_bias <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                     time_interval <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>#saving the data for later</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">monthly_bias_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">patched_monthly</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">monthly_bias_fixed</span><span class="op">$</span><span class="va">weather</span>,</span>
<span>          <span class="st">"data_New_York/Rochester_weather.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr></section></section><section id="chapter-12-generating-temperature-scenarios" class="level1"><h1>Chapter 12: Generating temperature scenarios</h1>
<section id="exercises-on-getting-temperature-data-2" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-getting-temperature-data-2"><strong><em>Exercises on getting temperature data</em></strong></h2>
<ol type="1">
<li>For the location you chose for your earlier analyses, use chillRâs weather generator to produce 100 years of synthetic temperature data.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Rochester</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'data_New_York/Rochester_weather.csv'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Temp</span> <span class="op">&lt;-</span> <span class="va">Rochester</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_generation.html">temperature_generation</a></span><span class="op">(</span>years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1998</span>,<span class="fl">2009</span><span class="op">)</span>,</span>
<span>                         sim_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2001</span>,<span class="fl">2100</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: scenario doesn't contain named elements - consider using the following
element names: 'data', 'reference_year','scenario_type','labels'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: setting scenario_type to 'relative'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Reference year missing - can't check if relative temperature scenario
is valid</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Temperatures</span> <span class="op">&lt;-</span> <span class="va">Rochester</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Month</span>, <span class="va">Day</span>, <span class="va">Tmin</span>, <span class="va">Tmax</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1998</span><span class="op">:</span><span class="fl">2009</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>Data_source <span class="op">=</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">Temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Year</span>,</span>
<span>                           <span class="va">Month</span>,</span>
<span>                           <span class="va">Day</span>,</span>
<span>                           <span class="va">Tmin</span>,</span>
<span>                           <span class="va">Tmax</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>Data_source <span class="op">=</span> <span class="st">"simulated"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2000</span>,</span>
<span>                                <span class="va">Month</span>,</span>
<span>                                <span class="va">Day</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Temperatures</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Date</span>,</span>
<span>           <span class="va">Tmin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">Data_source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Temperatures</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Date</span>,</span>
<span>           <span class="va">Tmax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">Data_source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Calculate winter chill (in Chill Portions) for your synthetic weather, and illustrate your results as histograms and cumulative distributions.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">chill_observed</span> <span class="op">&lt;-</span> <span class="va">Temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Data_source</span> <span class="op">==</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/stack_hourly_temps.html">stack_hourly_temps</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">43.15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/chilling.html">chilling</a></span><span class="op">(</span>Start_JDay <span class="op">=</span> <span class="fl">305</span>,</span>
<span>           End_JDay <span class="op">=</span> <span class="fl">59</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">chill_simulated</span> <span class="op">&lt;-</span> <span class="va">Temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Data_source</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/stack_hourly_temps.html">stack_hourly_temps</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">43.15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/chilling.html">chilling</a></span><span class="op">(</span>Start_JDay <span class="op">=</span> <span class="fl">305</span>,</span>
<span>           End_JDay <span class="op">=</span> <span class="fl">59</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">chill_comparison</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">chill_observed</span>,</span>
<span>        Data_source <span class="op">=</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">chill_simulated</span>,</span>
<span>              Data_source <span class="op">=</span> <span class="st">"simulated"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">chill_comparison_full_seasons</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">chill_comparison</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Perc_complete</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">chill_comparison_full_seasons</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Chill_portions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Data_source</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Data source"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Chill accumulation (Chill Portions)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">chill_simulations</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">chill_comparison_full_seasons</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Data_source</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">chill_simulations</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Chill_portions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span>,</span>
<span>            lwd <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>            col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Cumulative probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Chill accumulation (in Chill Portions)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Produce similar plots for the number of freezing hours (&lt;0Â°C) in April (or October, if your site is in the Southern Hemisphere) for your location of interest.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  lower <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>,    <span class="fl">0</span><span class="op">)</span>,</span>
<span>  upper <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>    <span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>    <span class="fl">1</span>,    <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">freezing_hours</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/step_model.html">step_model</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_observed</span> <span class="op">&lt;-</span> <span class="va">Temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Data_source</span> <span class="op">==</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/stack_hourly_temps.html">stack_hourly_temps</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">43.15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse.html">tempResponse</a></span><span class="op">(</span>Start_JDay <span class="op">=</span> <span class="fl">91</span>,</span>
<span>               End_JDay <span class="op">=</span> <span class="fl">120</span>,</span>
<span>               models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Frost <span class="op">=</span> <span class="va">freezing_hours</span>,</span>
<span>                             Chill_portions <span class="op">=</span> <span class="va">Dynamic_Model</span>,</span>
<span>                             GDH <span class="op">=</span> <span class="va">GDH</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_simulated</span> <span class="op">&lt;-</span> <span class="va">Temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Data_source</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/stack_hourly_temps.html">stack_hourly_temps</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">43.15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse.html">tempResponse</a></span><span class="op">(</span>Start_JDay <span class="op">=</span> <span class="fl">91</span>,</span>
<span>               End_JDay <span class="op">=</span> <span class="fl">120</span>,</span>
<span>               models<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Frost <span class="op">=</span> <span class="va">freezing_hours</span>,</span>
<span>                           Chill_portions <span class="op">=</span> <span class="va">Dynamic_Model</span>,</span>
<span>                           GDH <span class="op">=</span> <span class="va">GDH</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_comparison</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">chill_observed</span>,</span>
<span>        Data_source <span class="op">=</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">chill_simulated</span>,</span>
<span>              Data_source <span class="op">=</span> <span class="st">"simulated"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_comparison_full_seasons</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">chill_comparison</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Perc_complete</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">chill_comparison_full_seasons</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Frost</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Data_source</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Data source"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Frost incidence during April (hours)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">chill_simulations</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">chill_comparison_full_seasons</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Data_source</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">chill_simulations</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Frost</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span>,</span>
<span>            lwd <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>            col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Cumulative probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Frost incidence during April (hours)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr></section></section><section id="chapter-14-generating-historic-temperature-scenarios" class="level1"><h1>Chapter 14: Generating historic temperature scenarios</h1>
<section id="exercises-on-historic-temperature-scenarios" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-historic-temperature-scenarios"><strong><em>Exercises on historic temperature scenarios</em></strong></h2>
<ol type="1">
<li>For the location you chose for previous exercises, produce historic temperature scenarios representing several years of the historic record (your choice).</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># downloading weather station list for the vicinity of Rochester</span></span>
<span><span class="va">station_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"list_stations"</span>,</span>
<span>                            location<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># downloading weather data for Greater Rochester International AP and convert it to chillR format</span></span>
<span><span class="va">Rochester_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"download_weather"</span>,</span>
<span>                            location <span class="op">=</span> <span class="va">station_list</span><span class="op">$</span><span class="va">chillR_code</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                            time_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1973</span>,<span class="fl">2019</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Loading data for 47 years from station 'GREATER ROCHESTER INTERNATIONAL AP'
================================================================================</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check record for missing data</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">Rochester_weather</span><span class="op">$</span><span class="st">'GREATER ROCHESTER INTERNATIONAL AP'</span><span class="op">)</span><span class="op">$</span><span class="va">QC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      Season End_year Season_days Data_days Missing_Tmin Missing_Tmax
1  1972/1973     1973         365       365            1            0
2  1973/1974     1974         365       365            0            1
3  1974/1975     1975         365       365            0            0
4  1975/1976     1976         366       366            0            0
5  1976/1977     1977         365       365            0            0
6  1977/1978     1978         365       365            0            0
7  1978/1979     1979         365       365            0            0
8  1979/1980     1980         366       366            0            0
9  1980/1981     1981         365       365            0            0
10 1981/1982     1982         365       365            0            0
11 1982/1983     1983         365       365            0            0
12 1983/1984     1984         366       366            0            0
13 1984/1985     1985         365       365            0            0
14 1985/1986     1986         365       365            0            0
15 1986/1987     1987         365       365            0            0
16 1987/1988     1988         366       366            0            0
17 1988/1989     1989         365       365            0            0
18 1989/1990     1990         365       365            0            0
19 1990/1991     1991         365       365            0            0
20 1991/1992     1992         366       366            0            0
21 1992/1993     1993         365       365            0            0
22 1993/1994     1994         365       365            0            0
23 1994/1995     1995         365       365            0            0
24 1995/1996     1996         366       366            0            0
25 1996/1997     1997         365       365            0            0
26 1997/1998     1998         365       365            0            0
27 1998/1999     1999         365       365            0            0
28 1999/2000     2000         366       366            0            0
29 2000/2001     2001         365       365            0            0
30 2001/2002     2002         365       365            0            1
31 2002/2003     2003         365       365            0            0
32 2003/2004     2004         366       366            0            0
33 2004/2005     2005         365       365            0            0
34 2005/2006     2006         365       365            0            0
35 2006/2007     2007         365       365            0            0
36 2007/2008     2008         366       366            0            0
37 2008/2009     2009         365       365            0            0
38 2009/2010     2010         365       365            0            0
39 2010/2011     2011         365       365            0            0
40 2011/2012     2012         366       366            0            0
41 2012/2013     2013         365       365            0            0
42 2013/2014     2014         365       365            0            0
43 2014/2015     2015         365       365            0            0
44 2015/2016     2016         366       366            0            0
45 2016/2017     2017         365       365            0            0
46 2017/2018     2018         365       365            0            0
47 2018/2019     2019         365       365            0            0
   Incomplete_days Perc_complete
1                1          99.7
2                1          99.7
3                0         100.0
4                0         100.0
5                0         100.0
6                0         100.0
7                0         100.0
8                0         100.0
9                0         100.0
10               0         100.0
11               0         100.0
12               0         100.0
13               0         100.0
14               0         100.0
15               0         100.0
16               0         100.0
17               0         100.0
18               0         100.0
19               0         100.0
20               0         100.0
21               0         100.0
22               0         100.0
23               0         100.0
24               0         100.0
25               0         100.0
26               0         100.0
27               0         100.0
28               0         100.0
29               0         100.0
30               1          99.7
31               0         100.0
32               0         100.0
33               0         100.0
34               0         100.0
35               0         100.0
36               0         100.0
37               0         100.0
38               0         100.0
39               0         100.0
40               0         100.0
41               0         100.0
42               0         100.0
43               0         100.0
44               0         100.0
45               0         100.0
46               0         100.0
47               0         100.0</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Rochester_patched</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/patch_daily_temperatures.html">patch_daily_temperatures</a></span><span class="op">(</span></span>
<span>  weather <span class="op">=</span> <span class="va">Rochester_weather</span><span class="op">$</span><span class="st">'GREATER ROCHESTER INTERNATIONAL AP'</span>,</span>
<span>  patch_weather <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">KA_weather</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">Rochester_patched</span><span class="op">)</span><span class="op">$</span><span class="va">QC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      Season End_year Season_days Data_days Missing_Tmin Missing_Tmax
1  1972/1973     1973         365       365            1            0
2  1973/1974     1974         365       365            0            1
3  1974/1975     1975         365       365            0            0
4  1975/1976     1976         366       366            0            0
5  1976/1977     1977         365       365            0            0
6  1977/1978     1978         365       365            0            0
7  1978/1979     1979         365       365            0            0
8  1979/1980     1980         366       366            0            0
9  1980/1981     1981         365       365            0            0
10 1981/1982     1982         365       365            0            0
11 1982/1983     1983         365       365            0            0
12 1983/1984     1984         366       366            0            0
13 1984/1985     1985         365       365            0            0
14 1985/1986     1986         365       365            0            0
15 1986/1987     1987         365       365            0            0
16 1987/1988     1988         366       366            0            0
17 1988/1989     1989         365       365            0            0
18 1989/1990     1990         365       365            0            0
19 1990/1991     1991         365       365            0            0
20 1991/1992     1992         366       366            0            0
21 1992/1993     1993         365       365            0            0
22 1993/1994     1994         365       365            0            0
23 1994/1995     1995         365       365            0            0
24 1995/1996     1996         366       366            0            0
25 1996/1997     1997         365       365            0            0
26 1997/1998     1998         365       365            0            0
27 1998/1999     1999         365       365            0            0
28 1999/2000     2000         366       366            0            0
29 2000/2001     2001         365       365            0            0
30 2001/2002     2002         365       365            0            0
31 2002/2003     2003         365       365            0            0
32 2003/2004     2004         366       366            0            0
33 2004/2005     2005         365       365            0            0
34 2005/2006     2006         365       365            0            0
35 2006/2007     2007         365       365            0            0
36 2007/2008     2008         366       366            0            0
37 2008/2009     2009         365       365            0            0
38 2009/2010     2010         365       365            0            0
39 2010/2011     2011         365       365            0            0
40 2011/2012     2012         366       366            0            0
41 2012/2013     2013         365       365            0            0
42 2013/2014     2014         365       365            0            0
43 2014/2015     2015         365       365            0            0
44 2015/2016     2016         366       366            0            0
45 2016/2017     2017         365       365            0            0
46 2017/2018     2018         365       365            0            0
47 2018/2019     2019         365       365            0            0
   Incomplete_days Perc_complete
1                1          99.7
2                1          99.7
3                0         100.0
4                0         100.0
5                0         100.0
6                0         100.0
7                0         100.0
8                0         100.0
9                0         100.0
10               0         100.0
11               0         100.0
12               0         100.0
13               0         100.0
14               0         100.0
15               0         100.0
16               0         100.0
17               0         100.0
18               0         100.0
19               0         100.0
20               0         100.0
21               0         100.0
22               0         100.0
23               0         100.0
24               0         100.0
25               0         100.0
26               0         100.0
27               0         100.0
28               0         100.0
29               0         100.0
30               0         100.0
31               0         100.0
32               0         100.0
33               0         100.0
34               0         100.0
35               0         100.0
36               0         100.0
37               0         100.0
38               0         100.0
39               0         100.0
40               0         100.0
41               0         100.0
42               0         100.0
43               0         100.0
44               0         100.0
45               0         100.0
46               0         100.0
47               0         100.0</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># interpolating these gaps now</span></span>
<span></span>
<span><span class="va">Rochester</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">Rochester_patched</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Rochester_temps</span><span class="op">&lt;-</span><span class="va">Rochester</span><span class="op">$</span><span class="va">weather</span></span>
<span></span>
<span><span class="va">scenario_1980</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_from_records.html">temperature_scenario_from_records</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester_temps</span>,</span>
<span>                                                   year <span class="op">=</span> <span class="fl">1980</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scenario_1980</span><span class="op">$</span><span class="st">'1980'</span><span class="op">$</span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Tmin       Tmax
1  -9.0606903 -0.2377527
2  -8.3935684  1.2871192
3  -3.1461946  7.7567505
4   2.4820978 14.6988933
5   8.2266344 21.4878763
6  12.7138378 26.1672733
7  15.7862688 28.8997677
8  14.9787247 27.4813677
9  10.9520867 23.2034578
10  5.0596366 16.8388409
11  0.6538422 10.5016111
12 -5.1744237  3.4223441</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#what could have happened in 1980 not what happpened</span></span>
<span></span>
<span><span class="va">temps_1980</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_generation.html">temperature_generation</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester_temps</span>,</span>
<span>                                     years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1973</span>, <span class="fl">2019</span><span class="op">)</span>,</span>
<span>                                     sim_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2001</span>, <span class="fl">2100</span><span class="op">)</span>,</span>
<span>                                     temperature_scenario <span class="op">=</span> <span class="va">scenario_1980</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Absolute temperature scenario specified - calibration weather record
only used for simulating temperature variation, but not for the means</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scenario_1996</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_from_records.html">temperature_scenario_from_records</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester_temps</span>,</span>
<span>                                                   year <span class="op">=</span> <span class="fl">1996</span><span class="op">)</span></span>
<span><span class="va">scenario_1996</span><span class="op">$</span><span class="st">'1996'</span><span class="op">$</span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Tmin      Tmax
1  -7.3350065  1.708824
2  -7.2736048  2.784257
3  -3.7285505  6.945298
4   2.2708667 14.404947
5   7.8130086 20.694505
6  13.4496222 26.245800
7  15.7692989 28.041933
8  15.4046581 27.207546
9  11.1955444 23.207882
10  5.5140839 16.876695
11  0.6022156  9.889624
12 -4.7273634  3.822239</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">relative_scenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_baseline_adjustment.html">temperature_scenario_baseline_adjustment</a></span><span class="op">(</span></span>
<span>  baseline <span class="op">=</span> <span class="va">scenario_1996</span>,</span>
<span>  temperature_scenario <span class="op">=</span> <span class="va">scenario_1980</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># error message here</span></span>
<span></span>
<span><span class="va">temps_1980</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_generation.html">temperature_generation</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester_temps</span>,</span>
<span>                                     years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1973</span>, <span class="fl">2019</span><span class="op">)</span>,</span>
<span>                                     sim_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2001</span>, <span class="fl">2100</span><span class="op">)</span>,</span>
<span>                                     temperature_scenario <span class="op">=</span> <span class="va">relative_scenario</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_past_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_from_records.html">temperature_scenario_from_records</a></span><span class="op">(</span></span>
<span>  weather <span class="op">=</span> <span class="va">Rochester_temps</span>,</span>
<span>  year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1980</span>,</span>
<span>           <span class="fl">1990</span>,</span>
<span>           <span class="fl">2000</span>,</span>
<span>           <span class="fl">2010</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adjusted_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_baseline_adjustment.html">temperature_scenario_baseline_adjustment</a></span><span class="op">(</span></span>
<span>  baseline <span class="op">=</span> <span class="va">scenario_1996</span>,</span>
<span>  temperature_scenario <span class="op">=</span> <span class="va">all_past_scenarios</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_past_scenario_temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_generation.html">temperature_generation</a></span><span class="op">(</span></span>
<span>  weather <span class="op">=</span> <span class="va">Rochester_temps</span>,</span>
<span>  years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1973</span>,<span class="fl">2019</span><span class="op">)</span>,</span>
<span>  sim_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2001</span>,<span class="fl">2100</span><span class="op">)</span>,</span>
<span>  temperature_scenario <span class="op">=</span> <span class="va">adjusted_scenarios</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">frost_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/step_model.html">step_model</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>               lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>               upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>               weight<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Chill_Portions <span class="op">=</span> <span class="va">Dynamic_Model</span>,</span>
<span>               GDH <span class="op">=</span> <span class="va">GDH</span>,</span>
<span>               Frost_H <span class="op">=</span> <span class="va">frost_model</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">chill_hist_scenario_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse_daily_list.html">tempResponse_daily_list</a></span><span class="op">(</span><span class="va">all_past_scenario_temps</span>,</span>
<span>                                                    latitude <span class="op">=</span> <span class="fl">43.15</span>,</span>
<span>                                                    Start_JDay <span class="op">=</span> <span class="fl">305</span>,</span>
<span>                                                    End_JDay <span class="op">=</span> <span class="fl">59</span>,</span>
<span>                                                    models <span class="op">=</span> <span class="va">models</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Produce chill distributions for these scenarios and plot them.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill_hist_scenario_list</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">all_scenarios</span> <span class="op">&lt;-</span> <span class="va">chill_hist_scenario_list</span><span class="op">[[</span><span class="va">scenarios</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">scenarios</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sc</span> <span class="kw">in</span> <span class="va">scenarios</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span> <span class="va">all_scenarios</span> <span class="op">&lt;-</span> <span class="va">all_scenarios</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">chill_hist_scenario_list</span><span class="op">[[</span><span class="va">sc</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>            scenario<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sc</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Perc_complete</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's compute the actual 'observed' chill for comparison</span></span>
<span><span class="va">actual_chill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse_daily_list.html">tempResponse_daily_list</a></span><span class="op">(</span><span class="va">Rochester_temps</span>,</span>
<span>                                        latitude <span class="op">=</span> <span class="fl">43.15</span>,</span>
<span>                                        Start_JDay <span class="op">=</span> <span class="fl">305</span>,</span>
<span>                                        End_JDay <span class="op">=</span> <span class="fl">59</span>,</span>
<span>                                        <span class="va">models</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Perc_complete</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_scenarios</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">scenario</span>,</span>
<span>           <span class="va">Chill_Portions</span>,</span>
<span>           fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>draw_quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Chill accumulation (Chill Portions)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Scenario year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">actual_chill</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">End_year</span>,</span>
<span>                 <span class="va">Chill_Portions</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>             col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>             show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_fill_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Scenario"</span>,</span>
<span>                      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">all_scenarios</span><span class="op">$</span><span class="va">scenario</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temperature_means</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Rochester_temps</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Rochester_temps</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span>,</span>
<span>             Tmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">Rochester_temps</span><span class="op">$</span><span class="va">Tmin</span>,</span>
<span>                              FUN <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                              by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">Rochester_temps</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>             Tmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">Rochester_temps</span><span class="op">$</span><span class="va">Tmax</span>,</span>
<span>                            FUN <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">Rochester_temps</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>runn_mean_Tmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/runn_mean.html">runn_mean</a></span><span class="op">(</span><span class="va">Tmin</span>,<span class="fl">15</span><span class="op">)</span>,</span>
<span>         runn_mean_Tmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/runn_mean.html">runn_mean</a></span><span class="op">(</span><span class="va">Tmax</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Tmin_regression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Tmin</span> <span class="op">~</span> <span class="va">Year</span>,</span>
<span>                      <span class="va">temperature_means</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Tmax_regression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Tmax</span> <span class="op">~</span> <span class="va">Year</span>,</span>
<span>                      <span class="va">temperature_means</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temperature_means</span> <span class="op">&lt;-</span> <span class="va">temperature_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>regression_Tmin <span class="op">=</span> <span class="va">Tmin_regression</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span></span>
<span>           <span class="va">Tmin_regression</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">temperature_means</span><span class="op">$</span><span class="va">Year</span>,</span>
<span>         regression_Tmax <span class="op">=</span> <span class="va">Tmax_regression</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span></span>
<span>           <span class="va">Tmax_regression</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">temperature_means</span><span class="op">$</span><span class="va">Year</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">temperature_means</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>,</span>
<span>           <span class="va">Tmin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">temperature_means</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>,</span>
<span>                <span class="va">runn_mean_Tmin</span><span class="op">)</span>,</span>
<span>            lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">temperature_means</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>,</span>
<span>                <span class="va">regression_Tmin</span><span class="op">)</span>,</span>
<span>            lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Mean monthly minimum temperature (Â°C)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-49-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">temperature_means</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>,</span>
<span>           <span class="va">Tmax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">temperature_means</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>,</span>
<span>                <span class="va">runn_mean_Tmax</span><span class="op">)</span>,</span>
<span>            lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">temperature_means</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, </span>
<span>                <span class="va">regression_Tmax</span><span class="op">)</span>,</span>
<span>            lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Mean monthly maximum temperature (Â°C)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-49-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr></section></section><section id="chapter-15-future-temperature-scenarios" class="level1"><h1>Chapter 15: Future temperature scenarios</h1>
<section id="exercises-on-future-temperature-scenarios" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-future-temperature-scenarios">*<strong>Exercises on future temperature scenarios</strong>
</h2>
<ol type="1">
<li>Briefly describe the differences between the RCPs and the SSPs.</li>
</ol>
<p>Representative Concentration Pathways (RCPs) are climate change scenarios to project future greenhouse gas concentrations.These pathways (or trajectories) describe future greenhouse gas concentrations (not emissions) and have been formally adopted by the IPCC. The pathways describe different climate change scenarios, all of which were considered possible depending on the amount of greenhouse gases (GHG) emitted in the years to come.</p>
<p>Shared Socioeconomic Pathways (SSPs) are climate change scenarios of projected socioeconomic global changes up to 2100 as defined in the IPCC Sixth Assessment Report on climate change in 2021.The SRES scenarios are âbaselineâ (or âreferenceâ) scenarios, which means that they do not take into account any current or future measures to limit greenhouse gas (GHG) emissions.</p>
<p>A major difference between both models is that RCPs focus on Emissions and Radiative Forcing while SSPs emphasize Socioeconomic Pathways.In phenology SSPs integrate societal drivers, allowing phenologists to link temperature scenarios with land use changes, habitat fragmentation, or conservation efforts.</p>
</section></section><section id="chapter-16-generating-cmip6-temperature-scenarios" class="level1"><h1>Chapter 16: Generating CMIP6 temperature scenarios</h1>
<section id="exercises-on-generating-cmip6-temperature-scenarios" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-generating-cmip6-temperature-scenarios"><strong><em>Exercises on generating CMIP6 temperature scenarios</em></strong></h2>
<ol type="1">
<li>Analyze the historic and future impact of climate change on two agroclimatic metrics of your choice, for the location youâve chosen for your earlier analyses.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bluegreen-labs/ecmwfr">ecmwfr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#read Rochester_temps</span></span>
<span></span>
<span><span class="va">Rochester_temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/read_tab.html">read_tab</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_temps.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">location</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span><span class="op">)</span> <span class="co">#Rochester</span></span>
<span></span>
<span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="op">-</span><span class="fl">79</span>, <span class="fl">40</span>, <span class="op">-</span><span class="fl">71</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/download_cmip6_ecmwfr.html">download_cmip6_ecmwfr</a></span><span class="op">(</span></span>
<span>  scenarios <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ssp126"</span>, <span class="st">"ssp245"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span><span class="op">)</span>,</span>
<span>  area <span class="op">=</span> <span class="va">area</span>,</span>
<span>  key <span class="op">=</span> <span class="st">'e1bd6995-c569-4df1-bbe8-3549cb586e4a'</span>,</span>
<span>  model <span class="op">=</span> <span class="st">'default'</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">'monthly'</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Tmin'</span>,  <span class="st">'Tmax'</span><span class="op">)</span>,</span>
<span>  year_start <span class="op">=</span> <span class="fl">2015</span>,</span>
<span>  year_end <span class="op">=</span> <span class="fl">2100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
---------------
Download of scenario: ssp1_2_6
---------------
File tmax_ssp1_2_6_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_bcc_csm2_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_canesm5_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_cesm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp1_2_6_ukesm1_0_ll_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_bcc_csm2_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_canesm5_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_cesm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp1_2_6_ukesm1_0_ll_monthly_45_-79_40_-71.zip is already downloaded
In case of ssp1_2_6: The download request is empty after filtering blacklisted scenario-model-variable combinations and already downloaded files.

---------------
Download of scenario: ssp2_4_5
---------------
File tmax_ssp2_4_5_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_bcc_csm2_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_cesm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_ec_earth3_cc_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp2_4_5_ukesm1_0_ll_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_bcc_csm2_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_cesm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_ec_earth3_cc_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp2_4_5_ukesm1_0_ll_monthly_45_-79_40_-71.zip is already downloaded
In case of ssp2_4_5: The download request is empty after filtering blacklisted scenario-model-variable combinations and already downloaded files.

---------------
Download of scenario: ssp3_7_0
---------------
File tmax_ssp3_7_0_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_bcc_csm2_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_ec_earth3_aerchem_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_cesm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp3_7_0_ukesm1_0_ll_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_bcc_csm2_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_ec_earth3_aerchem_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_cesm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp3_7_0_ukesm1_0_ll_monthly_45_-79_40_-71.zip is already downloaded
In case of ssp3_7_0: The download request is empty after filtering blacklisted scenario-model-variable combinations and already downloaded files.

---------------
Download of scenario: ssp5_8_5
---------------
File tmax_ssp5_8_5_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_bcc_csm2_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_cesm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_ciesm_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_ec_earth3_cc_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_ssp5_8_5_ukesm1_0_ll_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_bcc_csm2_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_cesm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_ciesm_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_ec_earth3_cc_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_ssp5_8_5_ukesm1_0_ll_monthly_45_-79_40_-71.zip is already downloaded
In case of ssp5_8_5: The download request is empty after filtering blacklisted scenario-model-variable combinations and already downloaded files.</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/download_baseline_cmip6_ecmwfr.html">download_baseline_cmip6_ecmwfr</a></span><span class="op">(</span></span>
<span>  area <span class="op">=</span> <span class="va">area</span>,</span>
<span>  key <span class="op">=</span> <span class="st">'e1bd6995-c569-4df1-bbe8-3549cb586e4a'</span>,</span>
<span>  model <span class="op">=</span> <span class="st">'match_downloaded'</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">'monthly'</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Tmin'</span>, <span class="st">'Tmax'</span><span class="op">)</span>,</span>
<span>  year_start <span class="op">=</span> <span class="fl">1986</span>, </span>
<span>  year_end <span class="op">=</span> <span class="fl">2014</span>, </span>
<span>  month <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in download_cmip6_ecmwfr(scenarios = "historical", area = area, : At least one of the provided model name did match any of the known GCM model names. The function will try to download it anyway, but it is likely to fail. Please check if there are no typos in the GCMs name.
This affects the provided model names: r1i1p1f1_historical_ACCESS-CM2_Amon r1i1p1f1_ssp126_ACCESS-CM2_Amon r1i1p1f1_ssp245_ACCESS-CM2_Amon r1i1p1f1_ssp370_ACCESS-CM2_Amon r1i1p1f1_ssp585_ACCESS-CM2_Amon r1i1p1f1_historical_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp126_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp245_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp370_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp585_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp126_BCC-CSM2-MR_Amon r1i1p1f1_ssp245_BCC-CSM2-MR_Amon r1i1p1f1_ssp370_BCC-CSM2-MR_Amon r1i1p1f1_ssp585_BCC-CSM2-MR_Amon r1i1p1f1_historical_CanESM5_Amon r1i1p1f1_ssp126_CanESM5_Amon r4i1p1f1_ssp126_CESM2_Amon r4i1p1f1_ssp245_CESM2_Amon r4i1p1f1_ssp370_CESM2_Amon r4i1p1f1_ssp585_CESM2_Amon r1i1p1f1_historical_CIESM_Amon r1i1p1f1_ssp585_CIESM_Amon r1i1p1f1_historical_CMCC-ESM2_Amon r1i1p1f1_ssp126_CMCC-ESM2_Amon r1i1p1f1_ssp245_CMCC-ESM2_Amon r1i1p1f1_ssp585_CMCC-ESM2_Amon r1i1p1f2_historical_CNRM-CM6-1-HR_Amon r1i1p1f2_ssp126_CNRM-CM6-1-HR_Amon r1i1p1f2_ssp245_CNRM-CM6-1-HR_Amon r1i1p1f2_ssp370_CNRM-CM6-1-HR_Amon r1i1p1f2_ssp585_CNRM-CM6-1-HR_Amon r1i1p1f2_historical_CNRM-CM6-1_Amon r1i1p1f2_ssp126_CNRM-CM6-1_Amon r1i1p1f2_ssp245_CNRM-CM6-1_Amon r1i1p1f2_ssp370_CNRM-CM6-1_Amon r1i1p1f2_ssp585_CNRM-CM6-1_Amon r1i1p1f2_historical_CNRM-ESM2-1_Amon r1i1p1f2_ssp126_CNRM-ESM2-1_Amon r1i1p1f2_ssp245_CNRM-ESM2-1_Amon r1i1p1f2_ssp370_CNRM-ESM2-1_Amon r1i1p1f2_ssp585_CNRM-ESM2-1_Amon r1i1p1f1_historical_EC-Earth3-AerChem_Amon r1i1p1f1_ssp370_EC-Earth3-AerChem_Amon r1i1p1f1_historical_EC-Earth3-CC_Amon r1i1p1f1_ssp245_EC-Earth3-CC_Amon r1i1p1f1_ssp585_EC-Earth3-CC_Amon r1i1p1f1_historical_EC-Earth3-Veg-LR_Amon r1i1p1f1_ssp126_EC-Earth3-Veg-LR_Amon r1i1p1f1_ssp245_EC-Earth3-Veg-LR_Amon r1i1p1f1_ssp370_EC-Earth3-Veg-LR_Amon r1i1p1f1_ssp585_EC-Earth3-Veg-LR_Amon r1i1p1f1_historical_FGOALS-g3_Amon r1i1p1f1_ssp126_FGOALS-g3_Amon r1i1p1f1_ssp245_FGOALS-g3_Amon r1i1p1f1_ssp370_FGOALS-g3_Amon r1i1p1f1_ssp585_FGOALS-g3_Amon r1i1p1f1_historical_FIO-ESM-2-0_Amon r1i1p1f1_ssp126_FIO-ESM-2-0_Amon r1i1p1f1_ssp245_FIO-ESM-2-0_Amon r1i1p1f1_ssp585_FIO-ESM-2-0_Amon r1i1p1f1_historical_GFDL-ESM4_Amon r1i1p1f1_ssp126_GFDL-ESM4_Amon r1i1p1f1_ssp245_GFDL-ESM4_Amon r1i1p1f1_ssp370_GFDL-ESM4_Amon r1i1p1f1_ssp585_GFDL-ESM4_Amon r1i1p1f1_historical_INM-CM4-8_Amon r1i1p1f1_ssp126_INM-CM4-8_Amon r1i1p1f1_ssp245_INM-CM4-8_Amon r1i1p1f1_ssp370_INM-CM4-8_Amon r1i1p1f1_ssp585_INM-CM4-8_Amon r1i1p1f1_historical_INM-CM5-0_Amon r1i1p1f1_ssp126_INM-CM5-0_Amon r1i1p1f1_ssp245_INM-CM5-0_Amon r1i1p1f1_ssp370_INM-CM5-0_Amon r1i1p1f1_ssp585_INM-CM5-0_Amon r1i1p1f1_historical_IPSL-CM6A-LR_Amon r1i1p1f1_ssp126_IPSL-CM6A-LR_Amon r1i1p1f1_ssp245_IPSL-CM6A-LR_Amon r1i1p1f1_ssp370_IPSL-CM6A-LR_Amon r1i1p1f1_ssp585_IPSL-CM6A-LR_Amon r1i1p1f2_historical_MIROC-ES2L_Amon r1i1p1f2_ssp126_MIROC-ES2L_Amon r1i1p1f2_ssp245_MIROC-ES2L_Amon r1i1p1f2_ssp370_MIROC-ES2L_Amon r1i1p1f2_ssp585_MIROC-ES2L_Amon r1i1p1f1_historical_MIROC6_Amon r1i1p1f1_ssp126_MIROC6_Amon r1i1p1f1_ssp245_MIROC6_Amon r1i1p1f1_ssp370_MIROC6_Amon r1i1p1f1_ssp585_MIROC6_Amon r1i1p1f1_historical_MPI-ESM1-2-LR_Amon r1i1p1f1_ssp126_MPI-ESM1-2-LR_Amon r1i1p1f1_ssp245_MPI-ESM1-2-LR_Amon r1i1p1f1_ssp370_MPI-ESM1-2-LR_Amon r1i1p1f1_ssp585_MPI-ESM1-2-LR_Amon r1i1p1f1_historical_MRI-ESM2-0_Amon r1i1p1f1_ssp126_MRI-ESM2-0_Amon r1i1p1f1_ssp245_MRI-ESM2-0_Amon r1i1p1f1_ssp370_MRI-ESM2-0_Amon r1i1p1f1_ssp585_MRI-ESM2-0_Amon r1i1p1f1_historical_NESM3_Amon r1i1p1f1_ssp126_NESM3_Amon r1i1p1f1_ssp245_NESM3_Amon r1i1p1f1_ssp585_NESM3_Amon r1i1p1f2_ssp126_UKESM1-0-LL_Amon r13i1p1f2_ssp245_UKESM1-0-LL_Amon r1i1p1f2_ssp370_UKESM1-0-LL_Amon r1i1p1f2_ssp585_UKESM1-0-LL_Amon monthly_cm2 1_1_mr 45_monthly_canesm5 45_monthly_ciesm monthly_esm2 1_hr 1 aerchem cc veg_lr monthly_g3 2_0 monthly_esm4 8 0 lr monthly_es2l 45_monthly_miroc6 2_lr 45_monthly_nesm3 access_cm2 awi_cm_1_1_mr bcc_csm2_mr canesm5 cesm2 cmcc_esm2 cnrm_cm6_1_hr cnrm_cm6_1 cnrm_esm2_1 ec_earth3_veg_lr fgoals_g3 fio_esm_2_0 gfdl_esm4 inm_cm4_8 inm_cm5_0 ipsl_cm6a_lr miroc_es2l miroc6 mpi_esm1_2_lr mri_esm2_0 nesm3 ukesm1_0_ll ec_earth3_cc ec_earth3_aerchem ciesm</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
---------------
Download of scenario: historical
---------------
File tmax_historical_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_canesm5_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ec_earth3_cc_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ec_earth3_aerchem_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ciesm_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_canesm5_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ec_earth3_cc_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ec_earth3_aerchem_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ciesm_monthly_45_-79_40_-71.zip is already downloaded

Downloading: 262 file(s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Unknown error when downloading the CMIP6 data. Error happended for model BCC-CSM2-MR
The model was dropped from the request list.
Unknown error when downloading the CMIP6 data. Error happended for model CESM2
The model was dropped from the request list.
Unknown error when downloading the CMIP6 data. Error happended for model UKESM1-0-LL
The model was dropped from the request list.</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/download_baseline_cmip6_ecmwfr.html">download_baseline_cmip6_ecmwfr</a></span><span class="op">(</span></span>
<span>  area <span class="op">=</span> <span class="va">area</span>,</span>
<span>  key <span class="op">=</span> <span class="st">'e1bd6995-c569-4df1-bbe8-3549cb586e4a'</span>,</span>
<span>  model <span class="op">=</span> <span class="st">'match_downloaded'</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">'monthly'</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Tmin'</span>, <span class="st">'Tmax'</span><span class="op">)</span>,</span>
<span>  year_start <span class="op">=</span> <span class="fl">1986</span>,</span>
<span>  year_end <span class="op">=</span> <span class="fl">2014</span>,</span>
<span>  month <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in download_cmip6_ecmwfr(scenarios = "historical", area = area, : At least one of the provided model name did match any of the known GCM model names. The function will try to download it anyway, but it is likely to fail. Please check if there are no typos in the GCMs name.
This affects the provided model names: r1i1p1f1_historical_ACCESS-CM2_Amon r1i1p1f1_ssp126_ACCESS-CM2_Amon r1i1p1f1_ssp245_ACCESS-CM2_Amon r1i1p1f1_ssp370_ACCESS-CM2_Amon r1i1p1f1_ssp585_ACCESS-CM2_Amon r1i1p1f1_historical_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp126_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp245_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp370_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp585_AWI-CM-1-1-MR_Amon r1i1p1f1_ssp126_BCC-CSM2-MR_Amon r1i1p1f1_ssp245_BCC-CSM2-MR_Amon r1i1p1f1_ssp370_BCC-CSM2-MR_Amon r1i1p1f1_ssp585_BCC-CSM2-MR_Amon r1i1p1f1_historical_CanESM5_Amon r1i1p1f1_ssp126_CanESM5_Amon r4i1p1f1_ssp126_CESM2_Amon r4i1p1f1_ssp245_CESM2_Amon r4i1p1f1_ssp370_CESM2_Amon r4i1p1f1_ssp585_CESM2_Amon r1i1p1f1_historical_CIESM_Amon r1i1p1f1_ssp585_CIESM_Amon r1i1p1f1_historical_CMCC-ESM2_Amon r1i1p1f1_ssp126_CMCC-ESM2_Amon r1i1p1f1_ssp245_CMCC-ESM2_Amon r1i1p1f1_ssp585_CMCC-ESM2_Amon r1i1p1f2_historical_CNRM-CM6-1-HR_Amon r1i1p1f2_ssp126_CNRM-CM6-1-HR_Amon r1i1p1f2_ssp245_CNRM-CM6-1-HR_Amon r1i1p1f2_ssp370_CNRM-CM6-1-HR_Amon r1i1p1f2_ssp585_CNRM-CM6-1-HR_Amon r1i1p1f2_historical_CNRM-CM6-1_Amon r1i1p1f2_ssp126_CNRM-CM6-1_Amon r1i1p1f2_ssp245_CNRM-CM6-1_Amon r1i1p1f2_ssp370_CNRM-CM6-1_Amon r1i1p1f2_ssp585_CNRM-CM6-1_Amon r1i1p1f2_historical_CNRM-ESM2-1_Amon r1i1p1f2_ssp126_CNRM-ESM2-1_Amon r1i1p1f2_ssp245_CNRM-ESM2-1_Amon r1i1p1f2_ssp370_CNRM-ESM2-1_Amon r1i1p1f2_ssp585_CNRM-ESM2-1_Amon r1i1p1f1_historical_EC-Earth3-AerChem_Amon r1i1p1f1_ssp370_EC-Earth3-AerChem_Amon r1i1p1f1_historical_EC-Earth3-CC_Amon r1i1p1f1_ssp245_EC-Earth3-CC_Amon r1i1p1f1_ssp585_EC-Earth3-CC_Amon r1i1p1f1_historical_EC-Earth3-Veg-LR_Amon r1i1p1f1_ssp126_EC-Earth3-Veg-LR_Amon r1i1p1f1_ssp245_EC-Earth3-Veg-LR_Amon r1i1p1f1_ssp370_EC-Earth3-Veg-LR_Amon r1i1p1f1_ssp585_EC-Earth3-Veg-LR_Amon r1i1p1f1_historical_FGOALS-g3_Amon r1i1p1f1_ssp126_FGOALS-g3_Amon r1i1p1f1_ssp245_FGOALS-g3_Amon r1i1p1f1_ssp370_FGOALS-g3_Amon r1i1p1f1_ssp585_FGOALS-g3_Amon r1i1p1f1_historical_FIO-ESM-2-0_Amon r1i1p1f1_ssp126_FIO-ESM-2-0_Amon r1i1p1f1_ssp245_FIO-ESM-2-0_Amon r1i1p1f1_ssp585_FIO-ESM-2-0_Amon r1i1p1f1_historical_GFDL-ESM4_Amon r1i1p1f1_ssp126_GFDL-ESM4_Amon r1i1p1f1_ssp245_GFDL-ESM4_Amon r1i1p1f1_ssp370_GFDL-ESM4_Amon r1i1p1f1_ssp585_GFDL-ESM4_Amon r1i1p1f1_historical_INM-CM4-8_Amon r1i1p1f1_ssp126_INM-CM4-8_Amon r1i1p1f1_ssp245_INM-CM4-8_Amon r1i1p1f1_ssp370_INM-CM4-8_Amon r1i1p1f1_ssp585_INM-CM4-8_Amon r1i1p1f1_historical_INM-CM5-0_Amon r1i1p1f1_ssp126_INM-CM5-0_Amon r1i1p1f1_ssp245_INM-CM5-0_Amon r1i1p1f1_ssp370_INM-CM5-0_Amon r1i1p1f1_ssp585_INM-CM5-0_Amon r1i1p1f1_historical_IPSL-CM6A-LR_Amon r1i1p1f1_ssp126_IPSL-CM6A-LR_Amon r1i1p1f1_ssp245_IPSL-CM6A-LR_Amon r1i1p1f1_ssp370_IPSL-CM6A-LR_Amon r1i1p1f1_ssp585_IPSL-CM6A-LR_Amon r1i1p1f2_historical_MIROC-ES2L_Amon r1i1p1f2_ssp126_MIROC-ES2L_Amon r1i1p1f2_ssp245_MIROC-ES2L_Amon r1i1p1f2_ssp370_MIROC-ES2L_Amon r1i1p1f2_ssp585_MIROC-ES2L_Amon r1i1p1f1_historical_MIROC6_Amon r1i1p1f1_ssp126_MIROC6_Amon r1i1p1f1_ssp245_MIROC6_Amon r1i1p1f1_ssp370_MIROC6_Amon r1i1p1f1_ssp585_MIROC6_Amon r1i1p1f1_historical_MPI-ESM1-2-LR_Amon r1i1p1f1_ssp126_MPI-ESM1-2-LR_Amon r1i1p1f1_ssp245_MPI-ESM1-2-LR_Amon r1i1p1f1_ssp370_MPI-ESM1-2-LR_Amon r1i1p1f1_ssp585_MPI-ESM1-2-LR_Amon r1i1p1f1_historical_MRI-ESM2-0_Amon r1i1p1f1_ssp126_MRI-ESM2-0_Amon r1i1p1f1_ssp245_MRI-ESM2-0_Amon r1i1p1f1_ssp370_MRI-ESM2-0_Amon r1i1p1f1_ssp585_MRI-ESM2-0_Amon r1i1p1f1_historical_NESM3_Amon r1i1p1f1_ssp126_NESM3_Amon r1i1p1f1_ssp245_NESM3_Amon r1i1p1f1_ssp585_NESM3_Amon r1i1p1f2_ssp126_UKESM1-0-LL_Amon r13i1p1f2_ssp245_UKESM1-0-LL_Amon r1i1p1f2_ssp370_UKESM1-0-LL_Amon r1i1p1f2_ssp585_UKESM1-0-LL_Amon monthly_cm2 1_1_mr 45_monthly_canesm5 45_monthly_ciesm monthly_esm2 1_hr 1 aerchem cc veg_lr monthly_g3 2_0 monthly_esm4 8 0 lr monthly_es2l 45_monthly_miroc6 2_lr 45_monthly_nesm3 access_cm2 awi_cm_1_1_mr bcc_csm2_mr canesm5 cesm2 cmcc_esm2 cnrm_cm6_1_hr cnrm_cm6_1 cnrm_esm2_1 ec_earth3_veg_lr fgoals_g3 fio_esm_2_0 gfdl_esm4 inm_cm4_8 inm_cm5_0 ipsl_cm6a_lr miroc_es2l miroc6 mpi_esm1_2_lr mri_esm2_0 nesm3 ukesm1_0_ll ec_earth3_cc ec_earth3_aerchem ciesm</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
---------------
Download of scenario: historical
---------------
File tmax_historical_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_canesm5_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ec_earth3_cc_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ec_earth3_aerchem_monthly_45_-79_40_-71.zip is already downloaded
File tmax_historical_ciesm_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_access_cm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_awi_cm_1_1_mr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_canesm5_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_cmcc_esm2_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_cnrm_cm6_1_hr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_cnrm_cm6_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_cnrm_esm2_1_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ec_earth3_veg_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_fgoals_g3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_fio_esm_2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_gfdl_esm4_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_inm_cm4_8_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_inm_cm5_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ipsl_cm6a_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_miroc_es2l_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_miroc6_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_mpi_esm1_2_lr_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_mri_esm2_0_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_nesm3_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ec_earth3_cc_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ec_earth3_aerchem_monthly_45_-79_40_-71.zip is already downloaded
File tmin_historical_ciesm_monthly_45_-79_40_-71.zip is already downloaded

Downloading: 262 file(s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Unknown error when downloading the CMIP6 data. Error happended for model BCC-CSM2-MR
The model was dropped from the request list.
Unknown error when downloading the CMIP6 data. Error happended for model CESM2
The model was dropped from the request list.
Unknown error when downloading the CMIP6 data. Error happended for model UKESM1-0-LL
The model was dropped from the request list.</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">station</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  station_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rochester"</span><span class="op">)</span>,</span>
<span>  longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.60</span><span class="op">)</span>,</span>
<span>  latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">43.15</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cirrus.ucsd.edu/~pierce/ncdf/">ncdf4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">PCICt</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">extracted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/extract_cmip6_data.html">extract_cmip6_data</a></span><span class="op">(</span>stations <span class="op">=</span> <span class="va">station</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Unzipping files</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> â â â â â â â â â â â â â â â                    48% |  ETA:  4s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> â â â â â â â â â â â â â â â â â â â â â â â â â â         82% |  ETA:  1s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Extracting downloaded CMIP6 files</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> â â â â â                              14% |  ETA:  8s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> â â â â â â â â â â â â â â â â â â                 56% |  ETA:  3s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> â â â â â â â â â â â â â â â â â â â â â â â â â â â â â      94% |  ETA:  0s</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">extracted</span><span class="op">$</span><span class="va">`ssp126_AWI-CM-1-1-MR`</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Date  Year Month   Day      lat      lon  location         model
       &lt;Date&gt; &lt;num&gt; &lt;num&gt; &lt;int&gt;    &lt;num&gt;    &lt;num&gt;    &lt;char&gt;        &lt;char&gt;
1: 2015-01-16  2015     1    16 43.48034 282.1875 Rochester AWI-CM-1-1-MR
2: 2015-02-15  2015     2    15 43.48034 282.1875 Rochester AWI-CM-1-1-MR
3: 2015-03-16  2015     3    16 43.48034 282.1875 Rochester AWI-CM-1-1-MR
4: 2015-04-16  2015     4    16 43.48034 282.1875 Rochester AWI-CM-1-1-MR
5: 2015-05-16  2015     5    16 43.48034 282.1875 Rochester AWI-CM-1-1-MR
6: 2015-06-16  2015     6    16 43.48034 282.1875 Rochester AWI-CM-1-1-MR
      ssp    Tmin    Tmax
   &lt;char&gt;   &lt;num&gt;   &lt;num&gt;
1: ssp126 -9.3603  7.8444
2: ssp126 -9.2727  6.6381
3: ssp126 -4.8507 11.4168
4: ssp126  0.2643 16.5636
5: ssp126  8.9686 21.1074
6: ssp126 15.2826 27.4111</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">change_scenarios</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/gen_rel_change_scenario.html">gen_rel_change_scenario</a></span><span class="op">(</span><span class="va">extracted</span>,</span>
<span>                          scenarios <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>, <span class="fl">2085</span><span class="op">)</span>,</span>
<span>                          reference_period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1986</span><span class="op">:</span><span class="fl">2014</span><span class="op">)</span>,</span>
<span>                          future_window_width <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">change_scenarios</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã 11
  location  Month  Tmax  Tmin scenario start_year end_year scenario_year
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;
1 Rochester     1  3.58  4.31 ssp126         2035     2065          2050
2 Rochester     2  4.27  5.20 ssp126         2035     2065          2050
3 Rochester     3  3.07  3.10 ssp126         2035     2065          2050
4 Rochester     4  3.23  2.74 ssp126         2035     2065          2050
5 Rochester     5  2.49  2.26 ssp126         2035     2065          2050
6 Rochester     6  2.01  1.75 ssp126         2035     2065          2050
# â¹ 3 more variables: reference_year &lt;int&gt;, scenario_type &lt;chr&gt;, labels &lt;chr&gt;</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">change_scenarios</span>, <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/all_change_scenarios.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">change_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/all_change_scenarios.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/convert_scen_information.html">convert_scen_information</a></span><span class="op">(</span><span class="va">change_scenarios</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen_frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/convert_scen_information.html">convert_scen_information</a></span><span class="op">(</span><span class="va">scen_list</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen_list</span><span class="op">$</span><span class="va">Rochester</span><span class="op">$</span><span class="va">ssp126</span><span class="op">$</span><span class="va">`ACCESS-CM2`</span><span class="op">$</span><span class="st">'2050'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$data
       Tmin     Tmax
1  4.308037 3.576496
2  5.201117 4.271004
3  3.096214 3.073813
4  2.744128 3.232927
5  2.258048 2.494196
6  1.748971 2.006512
7  3.182554 3.676657
8  3.687777 4.053021
9  2.722016 2.962822
10 2.493781 2.837000
11 3.141337 3.853089
12 4.391084 3.480197

$scenario
[1] "ssp126"

$start_year
[1] 2035

$end_year
[1] 2065

$scenario_year
[1] 2050

$reference_year
[1] 2000

$scenario_type
[1] "relative"

$labels
[1] "ACCESS-CM2"</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temps_1996</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_from_records.html">temperature_scenario_from_records</a></span><span class="op">(</span><span class="va">Rochester_temps</span>,</span>
<span>                                                <span class="fl">1996</span><span class="op">)</span></span>
<span><span class="va">temps_2000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_from_records.html">temperature_scenario_from_records</a></span><span class="op">(</span><span class="va">Rochester_temps</span>,</span>
<span>                                                <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">temps_1996</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$`1996`
$`1996`$data
         Tmin      Tmax
1  -7.3350065  1.708824
2  -7.2736048  2.784257
3  -3.7285505  6.945298
4   2.2708667 14.404947
5   7.8130086 20.694505
6  13.4496222 26.245800
7  15.7692989 28.041933
8  15.4046581 27.207546
9  11.1955444 23.207882
10  5.5140839 16.876695
11  0.6022156  9.889624
12 -4.7273634  3.822239

$`1996`$scenario_year
[1] 1996

$`1996`$reference_year
[1] NA

$`1996`$scenario_type
[1] "absolute"

$`1996`$labels
[1] "running mean scenario"</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temps_2000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$`2000`
$`2000`$data
         Tmin      Tmax
1  -7.9256946  1.345632
2  -7.9806543  2.291952
3  -3.8981935  6.875522
4   1.8492667 14.403951
5   7.3377505 20.719359
6  13.3362889 26.243818
7  15.6826753 28.097488
8  15.4461140 27.468000
9  11.4013489 23.562458
10  5.6995118 17.044794
11  0.6801111 10.382707
12 -4.3175613  4.008974

$`2000`$scenario_year
[1] 2000

$`2000`$reference_year
[1] NA

$`2000`$scenario_type
[1] "absolute"

$`2000`$labels
[1] "running mean scenario"</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_baseline_adjustment.html">temperature_scenario_baseline_adjustment</a></span><span class="op">(</span><span class="va">temps_1996</span>,</span>
<span>                                                 <span class="va">temps_2000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">base</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$`2000`
$`2000`$data
          Tmin          Tmax
1  -0.59068817 -0.3631913978
2  -0.70704943 -0.4923046798
3  -0.16964301 -0.0697763441
4  -0.42160000 -0.0009955556
5  -0.47525806  0.0248537634
6  -0.11333333 -0.0019822222
7  -0.08662366  0.0555548387
8   0.04145591  0.2604537634
9   0.20580444  0.3545755556
10  0.18542796  0.1680989247
11  0.07789556  0.4930822222
12  0.40980215  0.1867354839

$`2000`$scenario_year
[1] 2000

$`2000`$reference_year
[1] 1996

$`2000`$scenario_type
[1] "relative"

$`2000`$labels
[1] "running mean scenario"</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scen_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/convert_scen_information.html">convert_scen_information</a></span><span class="op">(</span><span class="va">change_scenarios</span>,</span>
<span>                                      give_structure <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adjusted_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_scenario_baseline_adjustment.html">temperature_scenario_baseline_adjustment</a></span><span class="op">(</span><span class="va">base</span>,</span>
<span>                                                          <span class="va">scen_list</span>,</span>
<span>                   temperature_check_args <span class="op">=</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>scenario_check_thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># temps &lt;- temperature_generation(Rochester_temps,</span></span>
<span><span class="co">#                                 years = c(1973, 2019),</span></span>
<span><span class="co">#                                 sim_years = c(2001, 2100),</span></span>
<span><span class="co">#                                 adjusted_list,  </span></span>
<span><span class="co">#                                 temperature_check_args = </span></span>
<span><span class="co">#                                   list( scenario_check_thresholds = c(-5, 15)))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># save_temperature_scenarios(temps,</span></span>
<span><span class="co">#                            "data_New_York/future_climate","Rochester_future")</span></span>
<span></span>
<span><span class="co"># temps &lt;- load_temperature_scenarios("data_New_Year/future_climate","Rochester_future_")</span></span>
<span></span>
<span></span>
<span><span class="co"># now we have temperature scenarios</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">scen</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">adjusted_list</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate/Rochester_future_"</span>,</span>
<span>                       <span class="va">scen</span>,<span class="st">"_"</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">adjusted_list</span><span class="op">)</span><span class="op">[</span><span class="va">scen</span><span class="op">]</span>,<span class="st">".csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="op">{</span><span class="va">temp_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/temperature_generation.html">temperature_generation</a></span><span class="op">(</span><span class="va">Rochester_temps</span>,</span>
<span>                                   years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1973</span>, <span class="fl">2019</span><span class="op">)</span>,</span>
<span>                                   sim_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2001</span>, <span class="fl">2100</span><span class="op">)</span>,</span>
<span>                                   <span class="va">adjusted_list</span><span class="op">[</span><span class="va">scen</span><span class="op">]</span>,  </span>
<span>                                   temperature_check_args <span class="op">=</span> </span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> scenario_check_thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">temp_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate/Rochester_future_"</span>,<span class="va">scen</span>,<span class="st">"_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">adjusted_list</span><span class="op">)</span><span class="op">[</span><span class="va">scen</span><span class="op">]</span>,<span class="st">".csv"</span><span class="op">)</span>,</span>
<span>                             row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Processed object"</span>,<span class="va">scen</span>,<span class="st">"of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">adjusted_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/load_temperature_scenarios.html">load_temperature_scenarios</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,<span class="st">"Rochester_future_"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">frost_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/step_model.html">step_model</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>               lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>               upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>               weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Chill_Portions <span class="op">=</span> <span class="va">Dynamic_Model</span>,</span>
<span>               GDH <span class="op">=</span> <span class="va">GDH</span>,</span>
<span>               Frost_H <span class="op">=</span> <span class="va">frost_model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_future_scenario_list</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse_daily_list.html">tempResponse_daily_list</a></span><span class="op">(</span><span class="va">temps</span>,</span>
<span>                          latitude <span class="op">=</span> <span class="fl">43.15</span>,</span>
<span>                          Start_JDay <span class="op">=</span> <span class="fl">305</span>,</span>
<span>                          End_JDay <span class="op">=</span> <span class="fl">59</span>,</span>
<span>                          models <span class="op">=</span> <span class="va">models</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_future_scenario_list</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">chill_future_scenario_list</span>,</span>
<span>         <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Perc_complete</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/save_temperature_scenarios.html">save_temperature_scenarios</a></span><span class="op">(</span><span class="va">chill_future_scenario_list</span>,</span>
<span>                           <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,</span>
<span>                           <span class="st">"Rochester_futurechill"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># this would be for spring frost, but we're not running this</span></span>
<span><span class="va">chill_future_scenario_list_frost</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse_daily_list.html">tempResponse_daily_list</a></span><span class="op">(</span><span class="va">temps</span>,</span>
<span>                          latitude <span class="op">=</span> <span class="fl">43.15</span>,</span>
<span>                          Start_JDay <span class="op">=</span> <span class="fl">75</span>,</span>
<span>                          End_JDay <span class="op">=</span> <span class="fl">120</span>,</span>
<span>                          models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>GDH <span class="op">=</span> <span class="va">GDH</span>,</span>
<span>                                        Frost_H <span class="op">=</span> <span class="va">frost_model</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_future_scenario_list_frost</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">chill_future_scenario_list_frost</span>,</span>
<span>         <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Perc_complete</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/save_temperature_scenarios.html">save_temperature_scenarios</a></span><span class="op">(</span><span class="va">chill_future_scenario_list_frost</span>,</span>
<span>                           <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,</span>
<span>                           <span class="st">"Rochester_futurefrost"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate for the observed record</span></span>
<span></span>
<span><span class="va">Rochester_temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/read_tab.html">read_tab</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_temps.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">observed_chill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse_daily_list.html">tempResponse_daily_list</a></span><span class="op">(</span><span class="va">Rochester_temps</span>,</span>
<span>                                          latitude <span class="op">=</span> <span class="fl">43.15</span>,</span>
<span>                                          Start_JDay <span class="op">=</span> <span class="fl">305</span>,</span>
<span>                                          End_JDay <span class="op">=</span> <span class="fl">59</span>,</span>
<span>                                          models <span class="op">=</span> <span class="va">models</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">observed_chill</span>, <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_observed_chill_305_59.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate chill for historic scenarios</span></span>
<span></span>
<span><span class="va">hist_temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/load_temperature_scenarios.html">load_temperature_scenarios</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York"</span>,<span class="st">"all_past_temps"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">chill_hist_scenario_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse_daily_list.html">tempResponse_daily_list</a></span><span class="op">(</span><span class="va">hist_temps</span>,</span>
<span>                                                    latitude <span class="op">=</span> <span class="fl">43.15</span>,</span>
<span>                                                    Start_JDay <span class="op">=</span> <span class="fl">305</span>,</span>
<span>                                                    End_JDay <span class="op">=</span> <span class="fl">59</span>,</span>
<span>                                                    models <span class="op">=</span> <span class="va">models</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_hist_scenario_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">chill_hist_scenario_list</span>,</span>
<span>                                   <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Perc_complete</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/save_temperature_scenarios.html">save_temperature_scenarios</a></span><span class="op">(</span><span class="va">chill_hist_scenario_list</span>,</span>
<span>                           <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,</span>
<span>                           <span class="st">"Rochester_hist_chill_305_59"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_future_scenario_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/load_temperature_scenarios.html">load_temperature_scenarios</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,<span class="st">"Rochester_futurechill"</span><span class="op">)</span></span>
<span><span class="va">chill_hist_scenario_list</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/load_temperature_scenarios.html">load_temperature_scenarios</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York"</span>,<span class="st">"Rochester_hist_chill_305_59"</span><span class="op">)</span></span>
<span><span class="va">observed_chill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/read_tab.html">read_tab</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_observed_chill_305_59.csv"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># prepare for plotting</span></span>
<span></span>
<span><span class="va">chills</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_climate_scenario.html">make_climate_scenario</a></span><span class="op">(</span></span>
<span>  metric_summary <span class="op">=</span> <span class="va">chill_hist_scenario_list</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Historical"</span>,</span>
<span>  historic_data <span class="op">=</span> <span class="va">observed_chill</span>,</span>
<span>  time_series <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/plot_climate_scenarios.html">plot_climate_scenarios</a></span><span class="op">(</span></span>
<span>  climate_scenario_list <span class="op">=</span> <span class="va">chills</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"Chill_Portions"</span>,</span>
<span>  metric_label <span class="op">=</span> <span class="st">"Chill (Chill Portions)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "time series labels"</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">list_ssp</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill_future_scenario_list</span><span class="op">)</span>,</span>
<span>           <span class="st">'\\.'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">list_gcm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill_future_scenario_list</span><span class="op">)</span>, <span class="st">'\\.'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">list_time</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill_future_scenario_list</span><span class="op">)</span>, <span class="st">'\\.'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SSPs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ssp126"</span>, <span class="st">"ssp245"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span><span class="op">)</span></span>
<span><span class="va">Times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>, <span class="fl">2085</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">SSP</span> <span class="kw">in</span> <span class="va">SSPs</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">Time</span> <span class="kw">in</span> <span class="va">Times</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># find all scenarios for the ssp and time</span></span>
<span>    <span class="va">chill</span> <span class="op">&lt;-</span> <span class="va">chill_future_scenario_list</span><span class="op">[</span><span class="va">list_ssp</span> <span class="op">==</span> <span class="va">SSP</span> <span class="op">&amp;</span></span>
<span>                                          <span class="va">list_time</span> <span class="op">==</span> <span class="va">Time</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">list_gcm</span><span class="op">[</span><span class="va">list_ssp</span> <span class="op">==</span> <span class="va">SSP</span> <span class="op">&amp;</span></span>
<span>                               <span class="va">list_time</span> <span class="op">==</span> <span class="va">Time</span><span class="op">]</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">SSP</span> <span class="op">==</span> <span class="st">"ssp126"</span><span class="op">)</span> <span class="va">SSPcaption</span> <span class="op">&lt;-</span> <span class="st">"SSP1"</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">SSP</span> <span class="op">==</span> <span class="st">"ssp245"</span><span class="op">)</span> <span class="va">SSPcaption</span> <span class="op">&lt;-</span> <span class="st">"SSP2"</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">SSP</span> <span class="op">==</span> <span class="st">"ssp370"</span><span class="op">)</span> <span class="va">SSPcaption</span> <span class="op">&lt;-</span> <span class="st">"SSP3"</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">SSP</span> <span class="op">==</span> <span class="st">"ssp585"</span><span class="op">)</span> <span class="va">SSPcaption</span> <span class="op">&lt;-</span> <span class="st">"SSP5"</span>    </span>
<span>    <span class="va">chills</span> <span class="op">&lt;-</span> <span class="va">chill</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_climate_scenario.html">make_climate_scenario</a></span><span class="op">(</span></span>
<span>        caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">SSPcaption</span>,</span>
<span>                    <span class="va">Time</span><span class="op">)</span>,</span>
<span>        add_to <span class="op">=</span> <span class="va">chills</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">info_chill</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/plot_climate_scenarios.html">plot_climate_scenarios</a></span><span class="op">(</span></span>
<span>    climate_scenario_list <span class="op">=</span> <span class="va">chills</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"Chill_Portions"</span>,</span>
<span>    metric_label <span class="op">=</span> <span class="st">"Chill (Chill Portions)"</span>,</span>
<span>    texcex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-50-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">info_heat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/plot_climate_scenarios.html">plot_climate_scenarios</a></span><span class="op">(</span></span>
<span>    climate_scenario_list <span class="op">=</span> <span class="va">chills</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"GDH"</span>,</span>
<span>    metric_label <span class="op">=</span> <span class="st">"Heat (Growing Degree Hours)"</span>,</span>
<span>    texcex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-50-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">info_frost</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/plot_climate_scenarios.html">plot_climate_scenarios</a></span><span class="op">(</span>  </span>
<span>    climate_scenario_list<span class="op">=</span><span class="va">chills</span>,</span>
<span>    metric<span class="op">=</span><span class="st">"Frost_H"</span>,</span>
<span>    metric_label<span class="op">=</span><span class="st">"Frost incidence (hours)"</span>,</span>
<span>    texcex<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-50-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">info_chill</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   code            Label
1     1        INM-CM4-8
2     2    MPI-ESM1-2-LR
3     3       MIROC-ES2L
4     4    CNRM-CM6-1-HR
5     5        CMCC-ESM2
6     6        INM-CM4-8
7     7       MIROC-ES2L
8     8        FGOALS-g3
9     9    CNRM-CM6-1-HR
10   10           MIROC6
11   11        INM-CM4-8
12   12      CNRM-ESM2-1
13   13        INM-CM5-0
14   14       MIROC-ES2L
15   15      FIO-ESM-2-0
16   16        FGOALS-g3
17   17      FIO-ESM-2-0
18   18    MPI-ESM1-2-LR
19   19     IPSL-CM6A-LR
20   20    CNRM-CM6-1-HR
21   21 EC-Earth3-Veg-LR
22   22        GFDL-ESM4
23   23        INM-CM5-0
24   24           MIROC6
25   25       MRI-ESM2-0
26   26       ACCESS-CM2
27   27    AWI-CM-1-1-MR
28   28          CanESM5
29   29        CMCC-ESM2
30   30      CNRM-ESM2-1
31   31 EC-Earth3-Veg-LR
32   32        INM-CM5-0
33   33      FIO-ESM-2-0
34   34        GFDL-ESM4
35   35           MIROC6
36   36    MPI-ESM1-2-LR
37   37      CNRM-ESM2-1
38   38     IPSL-CM6A-LR
39   39     IPSL-CM6A-LR
40   40            NESM3
41   41 EC-Earth3-Veg-LR
42   42        FGOALS-g3
43   43        GFDL-ESM4
44   44       ACCESS-CM2
45   45    AWI-CM-1-1-MR
46   46    AWI-CM-1-1-MR
47   47          CanESM5
48   48        CMCC-ESM2
49   49          CanESM5</code></pre>
</div>
</div>
<hr></section></section><section id="chapter-18-plotting-climate-scenarios" class="level1"><h1>Chapter 18: Plotting Climate Scenarios</h1>
<section id="exercises-on-plotting-future-projections" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-plotting-future-projections"><strong><em>Exercises on plotting future projections</em></strong></h2>
<p>1.Produce similar plots for the weather station you selected for earlier exercises.</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#library(ggpmisc)</span></span>
<span><span class="co">#library(patchwork)</span></span>
<span></span>
<span><span class="va">chill_hist_scenario_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/load_temperature_scenarios.html">load_temperature_scenarios</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York"</span>,</span>
<span>                                                       <span class="st">"Rochester_hist_chill_305_59"</span><span class="op">)</span></span>
<span><span class="va">actual_chill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/read_tab.html">read_tab</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_observed_chill_305_59.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chill_future_scenario_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/load_temperature_scenarios.html">load_temperature_scenarios</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,</span>
<span>                                                         <span class="st">"Rochester_futurechill"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chills</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_climate_scenario.html">make_climate_scenario</a></span><span class="op">(</span></span>
<span>  <span class="va">chill_hist_scenario_list</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Historic"</span>,</span>
<span>  historic_data <span class="op">=</span> <span class="va">actual_chill</span>,</span>
<span>  time_series <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SSPs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ssp126"</span>, <span class="st">"ssp245"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span><span class="op">)</span></span>
<span><span class="va">Times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>, <span class="fl">2085</span><span class="op">)</span></span>
<span></span>
<span><span class="va">list_ssp</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill_future_scenario_list</span><span class="op">)</span>, <span class="st">'\\.'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">list_gcm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill_future_scenario_list</span><span class="op">)</span>, <span class="st">'\\.'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">list_time</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill_future_scenario_list</span><span class="op">)</span>, <span class="st">'\\.'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">SSP</span> <span class="kw">in</span> <span class="va">SSPs</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">Time</span> <span class="kw">in</span> <span class="va">Times</span><span class="op">)</span></span>
<span>    <span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># find all scenarios for the ssp and time</span></span>
<span>    <span class="va">chill</span> <span class="op">&lt;-</span> <span class="va">chill_future_scenario_list</span><span class="op">[</span><span class="va">list_ssp</span> <span class="op">==</span> <span class="va">SSP</span> <span class="op">&amp;</span> <span class="va">list_time</span> <span class="op">==</span> <span class="va">Time</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chill</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">list_gcm</span><span class="op">[</span><span class="va">list_ssp</span> <span class="op">==</span> <span class="va">SSP</span> <span class="op">&amp;</span> <span class="va">list_time</span> <span class="op">==</span> <span class="va">Time</span><span class="op">]</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">SSP</span> <span class="op">==</span> <span class="st">"ssp126"</span><span class="op">)</span> <span class="va">SSPcaption</span> <span class="op">&lt;-</span> <span class="st">"SSP1"</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">SSP</span> <span class="op">==</span> <span class="st">"ssp245"</span><span class="op">)</span> <span class="va">SSPcaption</span> <span class="op">&lt;-</span> <span class="st">"SSP2"</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">SSP</span> <span class="op">==</span> <span class="st">"ssp370"</span><span class="op">)</span> <span class="va">SSPcaption</span> <span class="op">&lt;-</span> <span class="st">"SSP3"</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">SSP</span> <span class="op">==</span> <span class="st">"ssp585"</span><span class="op">)</span> <span class="va">SSPcaption</span> <span class="op">&lt;-</span> <span class="st">"SSP5"</span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="st">"2050"</span><span class="op">)</span> <span class="va">Time_caption</span> <span class="op">&lt;-</span> <span class="st">"2050"</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="st">"2085"</span><span class="op">)</span> <span class="va">Time_caption</span> <span class="op">&lt;-</span> <span class="st">"2085"</span></span>
<span>    <span class="va">chills</span> <span class="op">&lt;-</span> <span class="va">chill</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_climate_scenario.html">make_climate_scenario</a></span><span class="op">(</span></span>
<span>        caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">SSPcaption</span>,</span>
<span>                    <span class="va">Time_caption</span><span class="op">)</span>,</span>
<span>        add_to <span class="op">=</span> <span class="va">chills</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/plot_climate_scenarios.html">plot_climate_scenarios</a></span><span class="op">(</span></span>
<span>  climate_scenario_list <span class="op">=</span> <span class="va">chills</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"Chill_Portions"</span>,</span>
<span>  metric_label <span class="op">=</span> <span class="st">"Chill (Chill Portions)"</span>,</span>
<span>  texcex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "time series labels"

[[2]]
   code            Label
1     1        INM-CM4-8
2     2    MPI-ESM1-2-LR
3     3       MIROC-ES2L
4     4    CNRM-CM6-1-HR
5     5        CMCC-ESM2
6     6        INM-CM4-8
7     7       MIROC-ES2L
8     8        FGOALS-g3
9     9    CNRM-CM6-1-HR
10   10           MIROC6
11   11        INM-CM4-8
12   12      CNRM-ESM2-1
13   13        INM-CM5-0
14   14       MIROC-ES2L
15   15      FIO-ESM-2-0
16   16        FGOALS-g3
17   17      FIO-ESM-2-0
18   18    MPI-ESM1-2-LR
19   19     IPSL-CM6A-LR
20   20    CNRM-CM6-1-HR
21   21 EC-Earth3-Veg-LR
22   22        GFDL-ESM4
23   23        INM-CM5-0
24   24           MIROC6
25   25       MRI-ESM2-0
26   26       ACCESS-CM2
27   27    AWI-CM-1-1-MR
28   28          CanESM5
29   29        CMCC-ESM2
30   30      CNRM-ESM2-1
31   31 EC-Earth3-Veg-LR
32   32        INM-CM5-0
33   33      FIO-ESM-2-0
34   34        GFDL-ESM4
35   35           MIROC6
36   36    MPI-ESM1-2-LR
37   37      CNRM-ESM2-1
38   38     IPSL-CM6A-LR
39   39     IPSL-CM6A-LR
40   40            NESM3
41   41 EC-Earth3-Veg-LR
42   42        FGOALS-g3
43   43        GFDL-ESM4
44   44       ACCESS-CM2
45   45    AWI-CM-1-1-MR
46   46    AWI-CM-1-1-MR
47   47          CanESM5
48   48        CMCC-ESM2
49   49          CanESM5

[[3]]
   code            Label
1     1       ACCESS-CM2
2     2       MIROC-ES2L
3     3       ACCESS-CM2
4     4    CNRM-CM6-1-HR
5     5        INM-CM4-8
6     6       MIROC-ES2L
7     7        FGOALS-g3
8     8    CNRM-CM6-1-HR
9     9    AWI-CM-1-1-MR
10   10       ACCESS-CM2
11   11        CMCC-ESM2
12   12        INM-CM4-8
13   13           MIROC6
14   14      CNRM-ESM2-1
15   15        INM-CM5-0
16   16        FGOALS-g3
17   17      FIO-ESM-2-0
18   18      FIO-ESM-2-0
19   19          CanESM5
20   20    MPI-ESM1-2-LR
21   21    AWI-CM-1-1-MR
22   22        CMCC-ESM2
23   23     IPSL-CM6A-LR
24   24           MIROC6
25   25 EC-Earth3-Veg-LR
26   26        GFDL-ESM4
27   27      CNRM-ESM2-1
28   28    CNRM-CM6-1-HR
29   29        INM-CM5-0
30   30    AWI-CM-1-1-MR
31   31      FIO-ESM-2-0
32   32 EC-Earth3-Veg-LR
33   33        GFDL-ESM4
34   34          CanESM5
35   35    MPI-ESM1-2-LR
36   36        CMCC-ESM2
37   37     IPSL-CM6A-LR
38   38 EC-Earth3-Veg-LR
39   39        GFDL-ESM4
40   40      CNRM-ESM2-1
41   41          CanESM5
42   42        FGOALS-g3
43   43        INM-CM4-8
44   44        INM-CM5-0
45   45     IPSL-CM6A-LR
46   46       MIROC-ES2L
47   47           MIROC6
48   48    MPI-ESM1-2-LR
49   49       MRI-ESM2-0
50   50            NESM3

[[4]]
   code            Label
1     1 EC-Earth3-Veg-LR
2     2        GFDL-ESM4
3     3 EC-Earth3-Veg-LR
4     4        FGOALS-g3
5     5        GFDL-ESM4
6     6       MIROC-ES2L
7     7    CNRM-CM6-1-HR
8     8        INM-CM4-8
9     9        INM-CM4-8
10   10    MPI-ESM1-2-LR
11   11        FGOALS-g3
12   12        CMCC-ESM2
13   13       MIROC-ES2L
14   14           MIROC6
15   15      CNRM-ESM2-1
16   16        INM-CM5-0
17   17    CNRM-CM6-1-HR
18   18     EC-Earth3-CC
19   19        INM-CM4-8
20   20      FIO-ESM-2-0
21   21       MIROC-ES2L
22   22    MPI-ESM1-2-LR
23   23        FGOALS-g3
24   24      FIO-ESM-2-0
25   25     IPSL-CM6A-LR
26   26       ACCESS-CM2
27   27    AWI-CM-1-1-MR
28   28        CMCC-ESM2
29   29    CNRM-CM6-1-HR
30   30        INM-CM5-0
31   31           MIROC6
32   32       MRI-ESM2-0
33   33      CNRM-ESM2-1
34   34 EC-Earth3-Veg-LR
35   35        INM-CM5-0
36   36      FIO-ESM-2-0
37   37        GFDL-ESM4
38   38           MIROC6
39   39    MPI-ESM1-2-LR
40   40      CNRM-ESM2-1
41   41     IPSL-CM6A-LR
42   42     IPSL-CM6A-LR
43   43            NESM3
44   44       ACCESS-CM2
45   45    AWI-CM-1-1-MR
46   46    AWI-CM-1-1-MR
47   47        CMCC-ESM2

[[5]]
   code            Label
1     1        FGOALS-g3
2     2       ACCESS-CM2
3     3       MIROC-ES2L
4     4    CNRM-CM6-1-HR
5     5        INM-CM4-8
6     6       ACCESS-CM2
7     7        FGOALS-g3
8     8       MIROC-ES2L
9     9    AWI-CM-1-1-MR
10   10           MIROC6
11   11    CNRM-CM6-1-HR
12   12      CNRM-ESM2-1
13   13       ACCESS-CM2
14   14        INM-CM5-0
15   15        CMCC-ESM2
16   16        INM-CM4-8
17   17      FIO-ESM-2-0
18   18        FGOALS-g3
19   19    MPI-ESM1-2-LR
20   20     EC-Earth3-CC
21   21        CMCC-ESM2
22   22      FIO-ESM-2-0
23   23     IPSL-CM6A-LR
24   24    AWI-CM-1-1-MR
25   25 EC-Earth3-Veg-LR
26   26        GFDL-ESM4
27   27           MIROC6
28   28      CNRM-ESM2-1
29   29    CNRM-CM6-1-HR
30   30        INM-CM5-0
31   31    AWI-CM-1-1-MR
32   32      FIO-ESM-2-0
33   33 EC-Earth3-Veg-LR
34   34        GFDL-ESM4
35   35    MPI-ESM1-2-LR
36   36        CMCC-ESM2
37   37     IPSL-CM6A-LR
38   38 EC-Earth3-Veg-LR
39   39        GFDL-ESM4
40   40      CNRM-ESM2-1
41   41        INM-CM4-8
42   42        INM-CM5-0
43   43     IPSL-CM6A-LR
44   44       MIROC-ES2L
45   45           MIROC6
46   46    MPI-ESM1-2-LR
47   47       MRI-ESM2-0
48   48            NESM3

[[6]]
   code             Label
1     1       CNRM-ESM2-1
2     2        CNRM-CM6-1
3     3  EC-Earth3-Veg-LR
4     4      IPSL-CM6A-LR
5     5         GFDL-ESM4
6     6        CNRM-CM6-1
7     7  EC-Earth3-Veg-LR
8     8         FGOALS-g3
9     9         GFDL-ESM4
10   10         INM-CM4-8
11   11 EC-Earth3-AerChem
12   12         FGOALS-g3
13   13         INM-CM4-8
14   14     MPI-ESM1-2-LR
15   15       CNRM-ESM2-1
16   16         INM-CM4-8
17   17     MPI-ESM1-2-LR
18   18        MIROC-ES2L
19   19         FGOALS-g3
20   20     CNRM-CM6-1-HR
21   21         INM-CM5-0
22   22        MRI-ESM2-0
23   23       CNRM-ESM2-1
24   24  EC-Earth3-Veg-LR
25   25         GFDL-ESM4
26   26            MIROC6
27   27     MPI-ESM1-2-LR
28   28        ACCESS-CM2
29   29     AWI-CM-1-1-MR

[[7]]
   code             Label
1     1        CNRM-CM6-1
2     2  EC-Earth3-Veg-LR
3     3         GFDL-ESM4
4     4        CNRM-CM6-1
5     5  EC-Earth3-Veg-LR
6     6         GFDL-ESM4
7     7       CNRM-ESM2-1
8     8         FGOALS-g3
9     9         INM-CM4-8
10   10         FGOALS-g3
11   11 EC-Earth3-AerChem
12   12       CNRM-ESM2-1
13   13        ACCESS-CM2
14   14         INM-CM4-8
15   15     MPI-ESM1-2-LR
16   16         FGOALS-g3
17   17       CNRM-ESM2-1
18   18     CNRM-CM6-1-HR
19   19     AWI-CM-1-1-MR
20   20  EC-Earth3-Veg-LR
21   21         GFDL-ESM4
22   22     MPI-ESM1-2-LR
23   23         INM-CM4-8
24   24         INM-CM5-0
25   25      IPSL-CM6A-LR
26   26        MIROC-ES2L
27   27            MIROC6
28   28     MPI-ESM1-2-LR
29   29        MRI-ESM2-0

[[8]]
   code            Label
1     1            CIESM
2     2        CMCC-ESM2
3     3        CMCC-ESM2
4     4     IPSL-CM6A-LR
5     5     IPSL-CM6A-LR
6     6            NESM3
7     7 EC-Earth3-Veg-LR
8     8      CNRM-ESM2-1
9     9     IPSL-CM6A-LR
10   10       MIROC-ES2L
11   11    CNRM-CM6-1-HR
12   12 EC-Earth3-Veg-LR
13   13        FGOALS-g3
14   14           MIROC6
15   15        CMCC-ESM2
16   16        INM-CM4-8
17   17        INM-CM5-0
18   18       MIROC-ES2L
19   19    MPI-ESM1-2-LR
20   20      CNRM-ESM2-1
21   21      FIO-ESM-2-0
22   22    CNRM-CM6-1-HR
23   23     EC-Earth3-CC
24   24       ACCESS-CM2
25   25    AWI-CM-1-1-MR
26   26      FIO-ESM-2-0
27   27       MIROC-ES2L
28   28           MIROC6
29   29    CNRM-CM6-1-HR
30   30        INM-CM5-0
31   31        INM-CM5-0
32   32       MRI-ESM2-0
33   33      CNRM-ESM2-1
34   34 EC-Earth3-Veg-LR
35   35      FIO-ESM-2-0
36   36        GFDL-ESM4
37   37           MIROC6
38   38       ACCESS-CM2
39   39       ACCESS-CM2
40   40    AWI-CM-1-1-MR
41   41    AWI-CM-1-1-MR

[[9]]
   code            Label
1     1 EC-Earth3-Veg-LR
2     2            CIESM
3     3       ACCESS-CM2
4     4       MIROC-ES2L
5     5    CNRM-CM6-1-HR
6     6 EC-Earth3-Veg-LR
7     7      CNRM-ESM2-1
8     8        FGOALS-g3
9     9       ACCESS-CM2
10   10    AWI-CM-1-1-MR
11   11           MIROC6
12   12       MIROC-ES2L
13   13        INM-CM5-0
14   14    CNRM-CM6-1-HR
15   15      CNRM-ESM2-1
16   16      FIO-ESM-2-0
17   17        CMCC-ESM2
18   18        CMCC-ESM2
19   19     IPSL-CM6A-LR
20   20       ACCESS-CM2
21   21     EC-Earth3-CC
22   22      FIO-ESM-2-0
23   23    AWI-CM-1-1-MR
24   24           MIROC6
25   25        INM-CM5-0
26   26      CNRM-ESM2-1
27   27      FIO-ESM-2-0
28   28    CNRM-CM6-1-HR
29   29    AWI-CM-1-1-MR
30   30 EC-Earth3-Veg-LR
31   31        GFDL-ESM4
32   32        CMCC-ESM2
33   33     IPSL-CM6A-LR
34   34        INM-CM4-8
35   35        INM-CM5-0
36   36     IPSL-CM6A-LR
37   37       MIROC-ES2L
38   38           MIROC6
39   39    MPI-ESM1-2-LR
40   40       MRI-ESM2-0
41   41            NESM3</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># We'll first process the past scenarios (element 1 of the chills list).</span></span>
<span><span class="co"># Within the data element, we have a list of multiple data.frames for</span></span>
<span><span class="co"># the various past scenarios.</span></span>
<span><span class="co"># Using a 'for' loop, we cycle through all these data.frames.</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">nam</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chills</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>   <span class="co"># Extract the data frame.</span></span>
<span>   <span class="va">ch</span> <span class="op">&lt;-</span> <span class="va">chills</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">nam</span><span class="op">]</span><span class="op">]</span></span>
<span>   <span class="co"># Add columns for the new information we have to add and fill them.</span></span>
<span>   <span class="va">ch</span><span class="op">[</span>,<span class="st">"GCM"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"none"</span></span>
<span>   <span class="va">ch</span><span class="op">[</span>,<span class="st">"SSP"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"none"</span></span>
<span>   <span class="va">ch</span><span class="op">[</span>,<span class="st">"Year"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">nam</span><span class="op">)</span></span>
<span>   </span>
<span>   <span class="co"># Now check if this is the first time we've gone through this loop.</span></span>
<span>   <span class="co"># If this is the first time, the ch data.frame becomes the output</span></span>
<span>   <span class="co"># object (past_simulated).</span></span>
<span>   <span class="co"># If it is not the first time ('else'), we add the current data.frame</span></span>
<span>   <span class="co"># to the 'past_simulated' object</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">nam</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chills</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">past_simulated</span> <span class="op">&lt;-</span> <span class="va">ch</span> <span class="kw">else</span></span>
<span>      <span class="va">past_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">past_simulated</span>,</span>
<span>                              <span class="va">ch</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="co"># We add another column called 'Scenario' and label all rows as 'Historical' </span></span>
<span><span class="va">past_simulated</span><span class="op">[</span><span class="st">"Scenario"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Historical"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">past_simulated</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     Season End_year Season_days Data_days Perc_complete Chill_Portions
1 2001/2002     2002         120       120           100       59.17632
2 2002/2003     2003         120       120           100       64.73074
3 2003/2004     2004         120       120           100       64.49436
4 2004/2005     2005         121       121           100       65.42315
5 2005/2006     2006         120       120           100       60.80443
6 2006/2007     2007         120       120           100       67.88429
        GDH Frost_H  GCM  SSP Year   Scenario
1 2256.1999    1715 none none 1980 Historical
2  787.1541    1889 none none 1980 Historical
3 2522.8398    1649 none none 1980 Historical
4 2891.9442    1537 none none 1980 Historical
5 1975.9134    1622 none none 1980 Historical
6 2628.1954    1461 none none 1980 Historical</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">past_simulated</span> <span class="op">&lt;-</span> <span class="va">past_simulated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Perc_complete</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We'll want to add the historic observation too, so let's simplify the</span></span>
<span><span class="co"># pointer to this information for easier use later</span></span>
<span></span>
<span><span class="va">past_observed</span> <span class="op">&lt;-</span> <span class="va">chills</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"historic_data"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">past_observed</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  X    Season End_year Season_days Data_days Interpolated_days Perc_complete
1 2 1973/1974     1974         120       120                 0           100
2 3 1974/1975     1975         120       120                 0           100
3 4 1975/1976     1976         120       120                 0           100
4 5 1976/1977     1977         121       121                 0           100
5 6 1977/1978     1978         120       120                 0           100
6 7 1978/1979     1979         120       120                 0           100
  Chill_Portions       GDH Frost_H
1       67.98883 2570.8981    1398
2       64.52425 1888.0505    1543
3       57.50491 4012.6694    1593
4       49.24001  608.3197    2081
5       43.54521 2657.3013    1888
6       59.77596 1895.7134    1752</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract future data</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">chills</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">nam</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chills</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="va">ch</span> <span class="op">&lt;-</span> <span class="va">chills</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">nam</span><span class="op">]</span><span class="op">]</span></span>
<span>     <span class="va">ch</span><span class="op">[</span>,<span class="st">"GCM"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">nam</span></span>
<span>     <span class="va">ch</span><span class="op">[</span>,<span class="st">"SSP"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">chills</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">caption</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>     <span class="va">ch</span><span class="op">[</span>,<span class="st">"Year"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">chills</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">caption</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>     <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">nam</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">chills</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>       <span class="va">future_data</span> <span class="op">&lt;-</span> <span class="va">ch</span> <span class="kw">else</span></span>
<span>         <span class="va">future_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">future_data</span>,<span class="va">ch</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">future_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     Season End_year Season_days Data_days Perc_complete Chill_Portions
1 2001/2002     2002         120       120           100       68.50341
2 2002/2003     2003         120       120           100       72.46375
3 2003/2004     2004         120       120           100       73.69366
4 2004/2005     2005         121       121           100       70.15026
5 2005/2006     2006         120       120           100       68.10887
6 2006/2007     2007         120       120           100       71.11982
       GDH Frost_H       GCM  SSP Year
1 3143.617    1367 INM-CM4-8 SSP1 2050
2 1414.789    1487 INM-CM4-8 SSP1 2050
3 3840.303    1109 INM-CM4-8 SSP1 2050
4 4208.921    1102 INM-CM4-8 SSP1 2050
5 2613.576    1227 INM-CM4-8 SSP1 2050
6 4132.875     898 INM-CM4-8 SSP1 2050</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">metric</span> <span class="op">&lt;-</span> <span class="st">"GDH"</span></span>
<span><span class="va">axis_label</span> <span class="op">&lt;-</span> <span class="st">"Heat (in GDH)"</span></span>
<span></span>
<span><span class="co"># get extreme values for the axis scale</span></span>
<span></span>
<span></span>
<span><span class="va">rng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">past_observed</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span>,</span>
<span>             <span class="va">past_simulated</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span>,</span>
<span>             <span class="va">future_data</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>  </span>
<span><span class="va">rng</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]   495.836 21994.013</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">past_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">past_simulated</span>,</span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"as.numeric(Year)"</span>,</span>
<span>                          <span class="va">metric</span>,</span>
<span>                          group <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
â¹ Please use tidy evaluation idioms with `aes()`.
â¹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">past_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">past_plot</span> <span class="op">&lt;-</span> <span class="va">past_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, </span>
<span>       y <span class="op">=</span> <span class="va">axis_label</span><span class="op">)</span></span>
<span></span>
<span><span class="va">past_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">past_plot</span> <span class="op">&lt;-</span> <span class="va">past_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Scenario</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="va">past_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">past_plot</span> <span class="op">&lt;-</span> <span class="va">past_plot</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                                   hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">past_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add historic data</span></span>
<span><span class="va">past_plot</span> <span class="op">&lt;-</span> <span class="va">past_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">past_observed</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"End_year"</span>,</span>
<span>                        <span class="va">metric</span><span class="op">)</span>,</span>
<span>             col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">past_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2050</span></span>
<span></span>
<span><span class="va">future_2050</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">future_data</span><span class="op">[</span><span class="va">future_data</span><span class="op">$</span><span class="va">Year</span> <span class="op">==</span> <span class="va">y</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"GCM"</span>, </span>
<span>                          <span class="va">metric</span>, </span>
<span>                          fill <span class="op">=</span> <span class="st">"GCM"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">future_2050</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">future_2050</span> <span class="op">&lt;-</span> <span class="va">future_2050</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">SSP</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>add <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'ggpp':
  method                  from   
  heightDetails.titleGrob ggplot2
  widthDetails.titleGrob  ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggpp'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    annotate</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">future_2050</span> <span class="op">&lt;-</span> <span class="va">future_2050</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">*</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_npc.html">geom_text_npc</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>npcx <span class="op">=</span> <span class="st">"center"</span>, </span>
<span>                      npcy <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>                      label <span class="op">=</span> <span class="va">Year</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">future_2050</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">future_2050</span> <span class="op">&lt;-</span> <span class="va">future_2050</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>                               <span class="fl">0</span>,</span>
<span>                               <span class="fl">0</span>,</span>
<span>                               <span class="fl">0</span>,</span>
<span>                               <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        legend.box.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                     vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>                                     size <span class="op">=</span> <span class="fl">15</span> <span class="op">*</span> <span class="fl">1.05</span>,</span>
<span>                                     face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">future_2050</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb183"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">future_plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>, <span class="fl">2085</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">y</span> <span class="kw">in</span> <span class="va">time_points</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">future_plot_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="va">time_points</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">future_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">future_data</span><span class="op">$</span><span class="va">Year</span><span class="op">==</span><span class="va">y</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"GCM"</span>,</span>
<span>                            <span class="va">metric</span>,</span>
<span>                            fill<span class="op">=</span><span class="st">"GCM"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">SSP</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>add <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">*</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_npc.html">geom_text_npc</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>npcx <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>                      npcy <span class="op">=</span> <span class="st">"top"</span>, </span>
<span>                      label <span class="op">=</span> <span class="va">Year</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>          legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                                 <span class="fl">0</span>, </span>
<span>                                 <span class="fl">0</span>, </span>
<span>                                 <span class="fl">0</span>, </span>
<span>                                 <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>          legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>          legend.box.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>          plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span></span>
<span>            hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">15</span> <span class="op">*</span> <span class="fl">1.05</span>,</span>
<span>            face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">future_plot_list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">both_plots</span> <span class="op">&lt;-</span> <span class="va">past_plot</span> <span class="op">+</span> <span class="va">future_plot_list</span></span>
<span></span>
<span><span class="va">both_plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb187"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">both_plots</span> <span class="op">+</span></span>
<span>           <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>                       widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1.8</span>,</span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">future_plot_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>         </span>
<span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                     legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>                     legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                     axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">metric</span> <span class="op">&lt;-</span> <span class="st">"Chill_Portions"</span></span>
<span><span class="va">axis_label</span> <span class="op">&lt;-</span> <span class="st">"Chill (in CP)"</span></span>
<span></span>
<span><span class="co"># get extreme values for the axis scale</span></span>
<span></span>
<span><span class="va">rng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">past_observed</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span>,</span>
<span>             <span class="va">past_simulated</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span>,</span>
<span>             <span class="va">future_data</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>  </span>
<span><span class="va">past_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">past_simulated</span>,</span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"as.numeric(Year)"</span>,</span>
<span>                          <span class="va">metric</span>,group<span class="op">=</span><span class="st">"Year"</span><span class="op">)</span>,</span>
<span>               fill<span class="op">=</span><span class="st">"skyblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">*</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="va">axis_label</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Scenario</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>           strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>           axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">past_observed</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"End_year"</span>,</span>
<span>                        <span class="va">metric</span><span class="op">)</span>,</span>
<span>             col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">future_plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">y</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>,</span>
<span>           <span class="fl">2085</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">future_plot_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>,<span class="fl">2085</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">future_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">future_data</span><span class="op">$</span><span class="va">Year</span><span class="op">==</span><span class="va">y</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"GCM"</span>, </span>
<span>                            <span class="va">metric</span>, </span>
<span>                            fill<span class="op">=</span><span class="st">"GCM"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">SSP</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>add <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">*</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_npc.html">geom_text_npc</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>npcx <span class="op">=</span> <span class="st">"center"</span>, </span>
<span>                      npcy <span class="op">=</span> <span class="st">"top"</span>, </span>
<span>                      label <span class="op">=</span> <span class="va">Year</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>                               <span class="fl">0</span>, </span>
<span>                               <span class="fl">0</span>,</span>
<span>                               <span class="fl">0</span>, </span>
<span>                               <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        legend.box.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                                     vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>                                     size <span class="op">=</span> <span class="fl">15</span> <span class="op">*</span> <span class="fl">1.05</span>,</span>
<span>                                     face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">past_plot</span> <span class="op">+</span></span>
<span>           <span class="va">future_plot_list</span> <span class="op">+</span></span>
<span>           <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>                       widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1.8</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">future_plot_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                   legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>                   legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                   axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb189"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">metric</span> <span class="op">&lt;-</span> <span class="st">"Frost_H"</span></span>
<span><span class="va">axis_label</span> <span class="op">&lt;-</span> <span class="st">"Frost duration (in hours)"</span></span>
<span></span>
<span><span class="co"># get extreme values for the axis scale</span></span>
<span></span>
<span><span class="va">rng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">past_observed</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span>,</span>
<span>             <span class="va">past_simulated</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span>,</span>
<span>             <span class="va">future_data</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>  </span>
<span><span class="va">past_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">past_simulated</span>,</span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"as.numeric(Year)"</span>,</span>
<span>                          <span class="va">metric</span>,group<span class="op">=</span><span class="st">"Year"</span><span class="op">)</span>,</span>
<span>               fill<span class="op">=</span><span class="st">"skyblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">*</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="va">axis_label</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Scenario</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>           strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>           axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">past_observed</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"End_year"</span>,</span>
<span>                        <span class="va">metric</span><span class="op">)</span>,</span>
<span>             col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">future_plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">y</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>,</span>
<span>           <span class="fl">2085</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">future_plot_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>,<span class="fl">2085</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">future_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">future_data</span><span class="op">$</span><span class="va">Year</span><span class="op">==</span><span class="va">y</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"GCM"</span>, </span>
<span>                            <span class="va">metric</span>, </span>
<span>                            fill<span class="op">=</span><span class="st">"GCM"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">SSP</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>add <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">*</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_npc.html">geom_text_npc</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>npcx <span class="op">=</span> <span class="st">"center"</span>, </span>
<span>                      npcy <span class="op">=</span> <span class="st">"top"</span>, </span>
<span>                      label <span class="op">=</span> <span class="va">Year</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>                               <span class="fl">0</span>, </span>
<span>                               <span class="fl">0</span>,</span>
<span>                               <span class="fl">0</span>, </span>
<span>                               <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        legend.box.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                                     vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>                                     size <span class="op">=</span> <span class="fl">15</span> <span class="op">*</span> <span class="fl">1.05</span>,</span>
<span>                                     face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">past_plot</span> <span class="op">+</span></span>
<span>           <span class="va">future_plot_list</span> <span class="op">+</span></span>
<span>           <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>                       widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1.8</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">future_plot_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                   legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>                   legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                   axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_scenarios_gg</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">past_observed</span>,</span>
<span>                              <span class="va">past_simulated</span>,</span>
<span>                              <span class="va">future_data</span>,</span>
<span>                              <span class="va">metric</span>,</span>
<span>                              <span class="va">axis_label</span>,</span>
<span>                              <span class="va">time_points</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">rng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">past_observed</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span>,</span>
<span>               <span class="va">past_simulated</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span>,</span>
<span>               <span class="va">future_data</span><span class="op">[[</span><span class="va">metric</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>  </span>
<span>  <span class="va">past_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">past_simulated</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"as.numeric(Year)"</span>,</span>
<span>                            <span class="va">metric</span>,</span>
<span>                            group<span class="op">=</span><span class="st">"Year"</span><span class="op">)</span>,</span>
<span>                 fill<span class="op">=</span><span class="st">"skyblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">*</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="va">axis_label</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Scenario</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>          axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span>, </span>
<span>                                     hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">past_observed</span>,</span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"End_year"</span>,</span>
<span>                          <span class="va">metric</span><span class="op">)</span>,</span>
<span>               col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">future_plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">y</span> <span class="kw">in</span> <span class="va">time_points</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="va">future_plot_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="va">time_points</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">future_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">future_data</span><span class="op">$</span><span class="va">Year</span><span class="op">==</span><span class="va">y</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span><span class="st">"GCM"</span>, </span>
<span>                              <span class="va">metric</span>, </span>
<span>                              fill<span class="op">=</span><span class="st">"GCM"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">SSP</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                       expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>add <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">*</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/geom_text_npc.html">geom_text_npc</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>npcx <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>                        npcy <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>                        label <span class="op">=</span> <span class="va">Year</span><span class="op">)</span>,</span>
<span>                    size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>            legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>                                   <span class="fl">0</span>, </span>
<span>                                   <span class="fl">0</span>, </span>
<span>                                   <span class="fl">0</span>, </span>
<span>                                   <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>            legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>            legend.box.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>            plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                         vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>                                         size <span class="op">=</span> <span class="fl">15</span> <span class="op">*</span> <span class="fl">1.05</span>,</span>
<span>                                         face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">past_plot</span> <span class="op">+</span></span>
<span>             <span class="va">future_plot_list</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>                         widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1.8</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">future_plot_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>           <span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                     legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>                     legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>                     axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">plot</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu">plot_scenarios_gg</span><span class="op">(</span>past_observed <span class="op">=</span> <span class="va">past_observed</span>,</span>
<span>                  past_simulated <span class="op">=</span> <span class="va">past_simulated</span>,</span>
<span>                  future_data <span class="op">=</span> <span class="va">future_data</span>,</span>
<span>                  metric <span class="op">=</span> <span class="st">"GDH"</span>,</span>
<span>                  axis_label <span class="op">=</span> <span class="st">"Heat (in Growing Degree Hours)"</span>,</span>
<span>                  time_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>, <span class="fl">2085</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb191"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_scenarios_gg</span><span class="op">(</span>past_observed <span class="op">=</span> <span class="va">past_observed</span>,</span>
<span>                  past_simulated <span class="op">=</span> <span class="va">past_simulated</span>,</span>
<span>                  future_data <span class="op">=</span> <span class="va">future_data</span>,</span>
<span>                  metric <span class="op">=</span> <span class="st">"Chill_Portions"</span>,</span>
<span>                  axis_label <span class="op">=</span> <span class="st">"Chill (in Chill Portions)"</span>,</span>
<span>                  time_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>, <span class="fl">2085</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_scenarios_gg</span><span class="op">(</span>past_observed <span class="op">=</span> <span class="va">past_observed</span>,</span>
<span>                  past_simulated <span class="op">=</span> <span class="va">past_simulated</span>,</span>
<span>                  future_data <span class="op">=</span> <span class="va">future_data</span>,</span>
<span>                  metric <span class="op">=</span> <span class="st">"Frost_H"</span>,</span>
<span>                  axis_label <span class="op">=</span> <span class="st">"Frost duration (in hours)"</span>,</span>
<span>                  time_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2050</span>, <span class="fl">2085</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-51-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb193"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_frost_plot.png"</span>, </span>
<span>       width <span class="op">=</span> <span class="fl">10</span>,</span>
<span>       height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>       dpi <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr></section></section><section id="chapter-19-chill-model-comparison" class="level1"><h1>Chapter 19: Chill model comparison</h1>
<section id="exercises-on-chill-model-comparison" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-chill-model-comparison"><strong><em>Exercises on chill model comparison</em></strong></h2>
<p>1.Produce similar plots for the weather station you selected for earlier exercises. 2. Make a heat map illustrating past and future changes in Safe Winter Chill, relative to a past scenario, for the 13 chill models used here 3. Produce an animated line plot of your results (summarizing Safe Winter Chill across all the GCMs).</p>
<!-- -->

</section></section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb194" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tree Phenology Assignment"</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Olamide Akinlade"</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.time(), '%B %d, %Y')`"</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc_float: true</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Contents"</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="co">    number_sections: true</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a><span class="co">    fig_caption: true</span></span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: 'Show code'</span></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code_highlight: tango</span></span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code_download: true</span></span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: sandstone</span></span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight: tango</span></span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(echo = TRUE)</span></span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 3: Tree Phenology Analysis</span></span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 Tree Dormancy</span></span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a>Winter dormancy may be defined as a trade-off between the length of the</span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>growing season and the protection against winter damage. To enter</span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a>dormancy, vegetative growth is stopped in the late summer or early</span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a>autumn and the shoots are converted into buds, where the shoot apical</span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a>meristems are protected by tightly closed and hardened bud scales.</span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.1.1 Dormancy Phases</span></span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Dormancy Establishment</span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Endodormancy 1: Ecodormancy</span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Growth resumption</span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.1.2 Physological processes that regulate dormancy</span></span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-52"><a href="#cb194-52" aria-hidden="true" tabindex="-1"></a>a.  Transport</span>
<span id="cb194-53"><a href="#cb194-53" aria-hidden="true" tabindex="-1"></a>b.  Photohormones</span>
<span id="cb194-54"><a href="#cb194-54" aria-hidden="true" tabindex="-1"></a>c.  Genetics</span>
<span id="cb194-55"><a href="#cb194-55" aria-hidden="true" tabindex="-1"></a>d.  Carbohydrates dynamics</span>
<span id="cb194-56"><a href="#cb194-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-57"><a href="#cb194-57" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on Tree Dormancy***</span></span>
<span id="cb194-58"><a href="#cb194-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-59"><a href="#cb194-59" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Put yourself in the place of a breeder who wants to calculate the</span>
<span id="cb194-60"><a href="#cb194-60" aria-hidden="true" tabindex="-1"></a>    temperature requirements of a newly released cultivar. Which method</span>
<span id="cb194-61"><a href="#cb194-61" aria-hidden="true" tabindex="-1"></a>    will you use to calculate the chilling and forcing periods? Please</span>
<span id="cb194-62"><a href="#cb194-62" aria-hidden="true" tabindex="-1"></a>    justify your answer</span>
<span id="cb194-63"><a href="#cb194-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-64"><a href="#cb194-64" aria-hidden="true" tabindex="-1"></a>Statistical method is recommended to calculate the temperature</span>
<span id="cb194-65"><a href="#cb194-65" aria-hidden="true" tabindex="-1"></a>requirements (chilling and forcing periods) of a newly released</span>
<span id="cb194-66"><a href="#cb194-66" aria-hidden="true" tabindex="-1"></a>cultivar. This involves using partial least square regression analysis</span>
<span id="cb194-67"><a href="#cb194-67" aria-hidden="true" tabindex="-1"></a>for daily temperatures over a continuous period.</span>
<span id="cb194-68"><a href="#cb194-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-69"><a href="#cb194-69" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Which are the advantages (2) of the BBCH scale compared with earlier</span>
<span id="cb194-70"><a href="#cb194-70" aria-hidden="true" tabindex="-1"></a>    scales?</span>
<span id="cb194-71"><a href="#cb194-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-72"><a href="#cb194-72" aria-hidden="true" tabindex="-1"></a>Two advantages of the BBCH scale over traditional scale include: a. It</span>
<span id="cb194-73"><a href="#cb194-73" aria-hidden="true" tabindex="-1"></a>was developed in a general frame for all the species b. It covers the</span>
<span id="cb194-74"><a href="#cb194-74" aria-hidden="true" tabindex="-1"></a>whole development of a plant.</span>
<span id="cb194-75"><a href="#cb194-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-76"><a href="#cb194-76" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Classify the following phenological stages of sweet cherry according</span>
<span id="cb194-77"><a href="#cb194-77" aria-hidden="true" tabindex="-1"></a>    to the BBCH scale:</span>
<span id="cb194-78"><a href="#cb194-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-79"><a href="#cb194-79" aria-hidden="true" tabindex="-1"></a>Phenological stages of cherry + Image 1: 51</span>
<span id="cb194-80"><a href="#cb194-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-81"><a href="#cb194-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Image 2: 63</span>
<span id="cb194-82"><a href="#cb194-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-83"><a href="#cb194-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Image 3: 87</span>
<span id="cb194-84"><a href="#cb194-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-85"><a href="#cb194-85" aria-hidden="true" tabindex="-1"></a>![Stages of</span>
<span id="cb194-86"><a href="#cb194-86" aria-hidden="true" tabindex="-1"></a>Cherry](\Users\Home\Downloads\photo_5834526249584805567_y.jpg)</span>
<span id="cb194-87"><a href="#cb194-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-88"><a href="#cb194-88" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-89"><a href="#cb194-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-90"><a href="#cb194-90" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 4: Climate Change and impact projection</span></span>
<span id="cb194-91"><a href="#cb194-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-92"><a href="#cb194-92" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1.1 Drivers of Climate change include:</span></span>
<span id="cb194-93"><a href="#cb194-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-94"><a href="#cb194-94" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sun: Warms the earth through radiation. It is an important driver of</span>
<span id="cb194-95"><a href="#cb194-95" aria-hidden="true" tabindex="-1"></a>    climate change on geological timescales, but not of recent climate</span>
<span id="cb194-96"><a href="#cb194-96" aria-hidden="true" tabindex="-1"></a>    change.</span>
<span id="cb194-97"><a href="#cb194-97" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aerosols: They are largely dusts. Suspensions of liquid, solid, or</span>
<span id="cb194-98"><a href="#cb194-98" aria-hidden="true" tabindex="-1"></a>    mixed particles with highly variable chemical composition and size</span>
<span id="cb194-99"><a href="#cb194-99" aria-hidden="true" tabindex="-1"></a>    distribution.</span>
<span id="cb194-100"><a href="#cb194-100" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Clouds: Can have both cooling and warming effect.</span>
<span id="cb194-101"><a href="#cb194-101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ozone: Surface (tropospheric) ozone: constituent of smog, health</span>
<span id="cb194-102"><a href="#cb194-102" aria-hidden="true" tabindex="-1"></a>    hazard (bad ozone). Greenhouse gas: presence in the stratosphere has</span>
<span id="cb194-103"><a href="#cb194-103" aria-hidden="true" tabindex="-1"></a>    a warming effect. Destroyed by chlorofluorocarbons (CFCs).</span>
<span id="cb194-104"><a href="#cb194-104" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Surface albedo: Reflection of radiation by the land surface. Light</span>
<span id="cb194-105"><a href="#cb194-105" aria-hidden="true" tabindex="-1"></a>    surfaces (e.g. ice, snow) reflect almost all radiation, dark</span>
<span id="cb194-106"><a href="#cb194-106" aria-hidden="true" tabindex="-1"></a>    surfaces (ocean, dark soil, forest) very little.</span>
<span id="cb194-107"><a href="#cb194-107" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Greenhouse gases: Atmospheric gases that trap heat on Earth.</span>
<span id="cb194-108"><a href="#cb194-108" aria-hidden="true" tabindex="-1"></a>    Greenhouse effects warms the planet.</span>
<span id="cb194-109"><a href="#cb194-109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Long-term drivers:</span>
<span id="cb194-110"><a href="#cb194-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-111"><a href="#cb194-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on Climate Change***</span></span>
<span id="cb194-112"><a href="#cb194-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-113"><a href="#cb194-113" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>List the main drivers of climate change at the decade to century</span>
<span id="cb194-114"><a href="#cb194-114" aria-hidden="true" tabindex="-1"></a>    scale, and briefly explain the mechanism through which the currently</span>
<span id="cb194-115"><a href="#cb194-115" aria-hidden="true" tabindex="-1"></a>    most important driver affects our climate.</span>
<span id="cb194-116"><a href="#cb194-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-117"><a href="#cb194-117" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sun</span>
<span id="cb194-118"><a href="#cb194-118" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aerosols</span>
<span id="cb194-119"><a href="#cb194-119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Clouds</span>
<span id="cb194-120"><a href="#cb194-120" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ozone</span>
<span id="cb194-121"><a href="#cb194-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Surface albedo</span>
<span id="cb194-122"><a href="#cb194-122" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Greenhouse gases</span>
<span id="cb194-123"><a href="#cb194-123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Long-term drivers</span>
<span id="cb194-124"><a href="#cb194-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-125"><a href="#cb194-125" aria-hidden="true" tabindex="-1"></a>Most important: **GHGs** **Greenhouse effect** + Raises Earthâs mean</span>
<span id="cb194-126"><a href="#cb194-126" aria-hidden="true" tabindex="-1"></a>temperature: +14Â°C instead of -18Â°C without GHGs! + Major GHGs: water</span>
<span id="cb194-127"><a href="#cb194-127" aria-hidden="true" tabindex="-1"></a>vapor, CO2 (carbon dioxide), CH4 (methane), N2O (nitrous oxide)</span>
<span id="cb194-128"><a href="#cb194-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-129"><a href="#cb194-129" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Explain briefly what is special about temperature dynamics of recent</span>
<span id="cb194-130"><a href="#cb194-130" aria-hidden="true" tabindex="-1"></a>    decades, and why we have good reasons to be concerned.</span>
<span id="cb194-131"><a href="#cb194-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-132"><a href="#cb194-132" aria-hidden="true" tabindex="-1"></a>Since 1901 strong warming (almost) everywhere on Earth.Up to 8Â°C warmer</span>
<span id="cb194-133"><a href="#cb194-133" aria-hidden="true" tabindex="-1"></a>than the 2003-2018 average. Precipitation anomalies (relative to median</span>
<span id="cb194-134"><a href="#cb194-134" aria-hidden="true" tabindex="-1"></a>prec.) for Cologne/Bonn weather station. Some years with dry</span>
<span id="cb194-135"><a href="#cb194-135" aria-hidden="true" tabindex="-1"></a>springs/summer.</span>
<span id="cb194-136"><a href="#cb194-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-137"><a href="#cb194-137" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>What does the abbreviation âRCPâ stand for, how are RCPs defined,</span>
<span id="cb194-138"><a href="#cb194-138" aria-hidden="true" tabindex="-1"></a>    and what is their role in projecting future climates? Representative</span>
<span id="cb194-139"><a href="#cb194-139" aria-hidden="true" tabindex="-1"></a>    Concentration Pathways (RCPs). It is a new greenhouse forcing</span>
<span id="cb194-140"><a href="#cb194-140" aria-hidden="true" tabindex="-1"></a>    scenarios in the IPCCâs5th Assessment Report. From RCP to inputs for</span>
<span id="cb194-141"><a href="#cb194-141" aria-hidden="true" tabindex="-1"></a>    climate change impact models.</span>
<span id="cb194-142"><a href="#cb194-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-143"><a href="#cb194-143" aria-hidden="true" tabindex="-1"></a>Roles of RCP:</span>
<span id="cb194-144"><a href="#cb194-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-145"><a href="#cb194-145" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Briefly describe the 4 climate impact projection methods described</span>
<span id="cb194-146"><a href="#cb194-146" aria-hidden="true" tabindex="-1"></a>    in the fourth video.</span>
<span id="cb194-147"><a href="#cb194-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-148"><a href="#cb194-148" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Statistical models</span>
<span id="cb194-149"><a href="#cb194-149" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Species distribution modeling</span>
<span id="cb194-150"><a href="#cb194-150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Process-based models</span>
<span id="cb194-151"><a href="#cb194-151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Climate analogue analysis</span>
<span id="cb194-152"><a href="#cb194-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-153"><a href="#cb194-153" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-154"><a href="#cb194-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-155"><a href="#cb194-155" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 5: Winter Chill Projections</span></span>
<span id="cb194-156"><a href="#cb194-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-157"><a href="#cb194-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on past chill projections***</span></span>
<span id="cb194-158"><a href="#cb194-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-159"><a href="#cb194-159" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Sketch out three data access and processing challenges that had to</span>
<span id="cb194-160"><a href="#cb194-160" aria-hidden="true" tabindex="-1"></a>    be overcome in order to produce chill projections with</span>
<span id="cb194-161"><a href="#cb194-161" aria-hidden="true" tabindex="-1"></a>    state-of-the-art methodology.</span>
<span id="cb194-162"><a href="#cb194-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-163"><a href="#cb194-163" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Accessing Climate Data for Specific Locations: Previous climate</span>
<span id="cb194-164"><a href="#cb194-164" aria-hidden="true" tabindex="-1"></a>    datasets like AFRICLIM and ClimateWizard only provided large-scale</span>
<span id="cb194-165"><a href="#cb194-165" aria-hidden="true" tabindex="-1"></a>    data. To get weather data for specific locations without downloading</span>
<span id="cb194-166"><a href="#cb194-166" aria-hidden="true" tabindex="-1"></a>    too much extra information, an API was created to quickly access</span>
<span id="cb194-167"><a href="#cb194-167" aria-hidden="true" tabindex="-1"></a>    data for single sites</span>
<span id="cb194-168"><a href="#cb194-168" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Converting Daily to Hourly Temperature Data: Chill models need</span>
<span id="cb194-169"><a href="#cb194-169" aria-hidden="true" tabindex="-1"></a>    hourly temperature data, but many databases only give daily</span>
<span id="cb194-170"><a href="#cb194-170" aria-hidden="true" tabindex="-1"></a>    averages. Early methods for converting daily to hourly data werenât</span>
<span id="cb194-171"><a href="#cb194-171" aria-hidden="true" tabindex="-1"></a>    very good, especially in areas with unique temperatures. Improved</span>
<span id="cb194-172"><a href="#cb194-172" aria-hidden="true" tabindex="-1"></a>    algorithms were developed to estimate hourly temperatures more</span>
<span id="cb194-173"><a href="#cb194-173" aria-hidden="true" tabindex="-1"></a>    accurately from daily data</span>
<span id="cb194-174"><a href="#cb194-174" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Handling Large Volumes of Climate Model Outputs: Studying different</span>
<span id="cb194-175"><a href="#cb194-175" aria-hidden="true" tabindex="-1"></a>    climate futures involves dealing with a lot of data from many</span>
<span id="cb194-176"><a href="#cb194-176" aria-hidden="true" tabindex="-1"></a>    climate models, which can be hard to manage. To handle this large</span>
<span id="cb194-177"><a href="#cb194-177" aria-hidden="true" tabindex="-1"></a>    amount of data effectively, workflows were streamlined and selective</span>
<span id="cb194-178"><a href="#cb194-178" aria-hidden="true" tabindex="-1"></a>    processing techniques were used</span>
<span id="cb194-179"><a href="#cb194-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-180"><a href="#cb194-180" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Outline, in your understanding, the basic steps that are necessary</span>
<span id="cb194-181"><a href="#cb194-181" aria-hidden="true" tabindex="-1"></a>    to make such projections.</span>
<span id="cb194-182"><a href="#cb194-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-183"><a href="#cb194-183" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data Collection and Calibration: collect historical weather data and</span>
<span id="cb194-184"><a href="#cb194-184" aria-hidden="true" tabindex="-1"></a>    use it to calibrate a weather generator for realistic temperature</span>
<span id="cb194-185"><a href="#cb194-185" aria-hidden="true" tabindex="-1"></a>    simulations</span>
<span id="cb194-186"><a href="#cb194-186" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model Selection and Scenario Setup: choose relevant climate models</span>
<span id="cb194-187"><a href="#cb194-187" aria-hidden="true" tabindex="-1"></a>    and emission scenarios to explore various future climates</span>
<span id="cb194-188"><a href="#cb194-188" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Generate Temperature Projections: downscale climate data, converting</span>
<span id="cb194-189"><a href="#cb194-189" aria-hidden="true" tabindex="-1"></a>    it to daily or hourly temperatures as needed for chill calculations</span>
<span id="cb194-190"><a href="#cb194-190" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chill Calculation: apply chill models to estimate chill accumulation</span>
<span id="cb194-191"><a href="#cb194-191" aria-hidden="true" tabindex="-1"></a>    across different climate scenarios</span>
<span id="cb194-192"><a href="#cb194-192" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Analysis and Visualization: compare chill projections across models</span>
<span id="cb194-193"><a href="#cb194-193" aria-hidden="true" tabindex="-1"></a>    and scenarios and visualize the findings</span>
<span id="cb194-194"><a href="#cb194-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation: validate projections with observed data where</span>
<span id="cb194-195"><a href="#cb194-195" aria-hidden="true" tabindex="-1"></a>    possible and assess agricultural impacts and adaptation needs</span>
<span id="cb194-196"><a href="#cb194-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-197"><a href="#cb194-197" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-198"><a href="#cb194-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-199"><a href="#cb194-199" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 6: Manual Chill Analysis</span></span>
<span id="cb194-200"><a href="#cb194-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-203"><a href="#cb194-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-204"><a href="#cb194-204" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb194-205"><a href="#cb194-205" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb194-206"><a href="#cb194-206" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb194-207"><a href="#cb194-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-208"><a href="#cb194-208" aria-hidden="true" tabindex="-1"></a>Winters_hours_gaps[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb194-209"><a href="#cb194-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-210"><a href="#cb194-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-211"><a href="#cb194-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Computing Chilling Hours from Hourly Temperature data***</span></span>
<span id="cb194-212"><a href="#cb194-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-213"><a href="#cb194-213" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Write a basic function that calculates warm hours (<span class="sc">\&gt;</span>25Â°C)</span>
<span id="cb194-214"><a href="#cb194-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-217"><a href="#cb194-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-218"><a href="#cb194-218" aria-hidden="true" tabindex="-1"></a>hourtemps <span class="ot">&lt;-</span> Winters_hours_gaps[,<span class="fu">c</span>(<span class="st">"Year"</span>,</span>
<span id="cb194-219"><a href="#cb194-219" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Month"</span>,</span>
<span id="cb194-220"><a href="#cb194-220" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Day"</span>,</span>
<span id="cb194-221"><a href="#cb194-221" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Hour"</span>,</span>
<span id="cb194-222"><a href="#cb194-222" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Temp"</span>)]</span>
<span id="cb194-223"><a href="#cb194-223" aria-hidden="true" tabindex="-1"></a>hourtemps[, <span class="st">"Chilling_Hour"</span>] <span class="ot">&lt;-</span> hourtemps<span class="sc">$</span>Temp <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> hourtemps<span class="sc">$</span>Temp <span class="sc">&lt;=</span> <span class="fl">7.2</span></span>
<span id="cb194-224"><a href="#cb194-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-225"><a href="#cb194-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-226"><a href="#cb194-226" aria-hidden="true" tabindex="-1"></a>#calculate warm hours</span>
<span id="cb194-227"><a href="#cb194-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-230"><a href="#cb194-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-231"><a href="#cb194-231" aria-hidden="true" tabindex="-1"></a>WH<span class="ot">&lt;-</span><span class="cf">function</span>(hourtemps)</span>
<span id="cb194-232"><a href="#cb194-232" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb194-233"><a href="#cb194-233" aria-hidden="true" tabindex="-1"></a>  hourtemps[, <span class="st">"Warm_Hour"</span>] <span class="ot">&lt;-</span></span>
<span id="cb194-234"><a href="#cb194-234" aria-hidden="true" tabindex="-1"></a>    hourtemps<span class="sc">$</span>Temp <span class="sc">&gt;=</span> <span class="dv">25</span> </span>
<span id="cb194-235"><a href="#cb194-235" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-236"><a href="#cb194-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(hourtemps)</span>
<span id="cb194-237"><a href="#cb194-237" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-238"><a href="#cb194-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-239"><a href="#cb194-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-240"><a href="#cb194-240" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Apply this function to the Winters_hours_gaps dataset</span>
<span id="cb194-241"><a href="#cb194-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-244"><a href="#cb194-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-245"><a href="#cb194-245" aria-hidden="true" tabindex="-1"></a><span class="fu">WH</span>(hourtemps)[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ]</span>
<span id="cb194-246"><a href="#cb194-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-247"><a href="#cb194-247" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(hourtemps<span class="sc">$</span>Warm_Hour)</span>
<span id="cb194-248"><a href="#cb194-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-249"><a href="#cb194-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-250"><a href="#cb194-250" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Extend this function, so that it can take start and end dates as</span>
<span id="cb194-251"><a href="#cb194-251" aria-hidden="true" tabindex="-1"></a>    inputs and sums up warm hours between these dates</span>
<span id="cb194-252"><a href="#cb194-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-255"><a href="#cb194-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-256"><a href="#cb194-256" aria-hidden="true" tabindex="-1"></a>sum_WH <span class="ot">&lt;-</span> <span class="cf">function</span>(hourtemps, </span>
<span id="cb194-257"><a href="#cb194-257" aria-hidden="true" tabindex="-1"></a>                   startYEARMODAHO,</span>
<span id="cb194-258"><a href="#cb194-258" aria-hidden="true" tabindex="-1"></a>                   endYEARMODAHO)</span>
<span id="cb194-259"><a href="#cb194-259" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-260"><a href="#cb194-260" aria-hidden="true" tabindex="-1"></a>{hourtemps[,<span class="st">"Warm_Hour"</span>] <span class="ot">&lt;-</span> hourtemps<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">25</span></span>
<span id="cb194-261"><a href="#cb194-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-262"><a href="#cb194-262" aria-hidden="true" tabindex="-1"></a>startYear <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(startYEARMODAHO, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb194-263"><a href="#cb194-263" aria-hidden="true" tabindex="-1"></a>startMonth <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(startYEARMODAHO, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb194-264"><a href="#cb194-264" aria-hidden="true" tabindex="-1"></a>startDay <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(startYEARMODAHO, <span class="dv">7</span>, <span class="dv">8</span>))</span>
<span id="cb194-265"><a href="#cb194-265" aria-hidden="true" tabindex="-1"></a>startHour <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(startYEARMODAHO, <span class="dv">9</span>, <span class="dv">10</span>))</span>
<span id="cb194-266"><a href="#cb194-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-267"><a href="#cb194-267" aria-hidden="true" tabindex="-1"></a>endYear <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(endYEARMODAHO, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb194-268"><a href="#cb194-268" aria-hidden="true" tabindex="-1"></a>endMonth <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(endYEARMODAHO, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb194-269"><a href="#cb194-269" aria-hidden="true" tabindex="-1"></a>endDay <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(endYEARMODAHO, <span class="dv">7</span>, <span class="dv">8</span>))</span>
<span id="cb194-270"><a href="#cb194-270" aria-hidden="true" tabindex="-1"></a>endHour <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(endYEARMODAHO, <span class="dv">9</span>, <span class="dv">10</span>))</span>
<span id="cb194-271"><a href="#cb194-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-272"><a href="#cb194-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-273"><a href="#cb194-273" aria-hidden="true" tabindex="-1"></a>Start_Date <span class="ot">&lt;-</span> <span class="fu">which</span>(hourtemps<span class="sc">$</span>Year <span class="sc">==</span> startYear <span class="sc">&amp;</span></span>
<span id="cb194-274"><a href="#cb194-274" aria-hidden="true" tabindex="-1"></a>                    hourtemps<span class="sc">$</span>Month <span class="sc">==</span> startMonth <span class="sc">&amp;</span></span>
<span id="cb194-275"><a href="#cb194-275" aria-hidden="true" tabindex="-1"></a>                    hourtemps<span class="sc">$</span>Day <span class="sc">==</span> startDay <span class="sc">&amp;</span></span>
<span id="cb194-276"><a href="#cb194-276" aria-hidden="true" tabindex="-1"></a>                    hourtemps<span class="sc">$</span>Hour <span class="sc">==</span> startHour)</span>
<span id="cb194-277"><a href="#cb194-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-278"><a href="#cb194-278" aria-hidden="true" tabindex="-1"></a>End_Date <span class="ot">&lt;-</span> <span class="fu">which</span>(hourtemps<span class="sc">$</span>Year <span class="sc">==</span> endYear <span class="sc">&amp;</span></span>
<span id="cb194-279"><a href="#cb194-279" aria-hidden="true" tabindex="-1"></a>                  hourtemps<span class="sc">$</span>Month <span class="sc">==</span> endMonth <span class="sc">&amp;</span></span>
<span id="cb194-280"><a href="#cb194-280" aria-hidden="true" tabindex="-1"></a>                  hourtemps<span class="sc">$</span>Day <span class="sc">==</span> endDay <span class="sc">&amp;</span></span>
<span id="cb194-281"><a href="#cb194-281" aria-hidden="true" tabindex="-1"></a>                  hourtemps<span class="sc">$</span>Hour <span class="sc">==</span> endHour)</span>
<span id="cb194-282"><a href="#cb194-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-283"><a href="#cb194-283" aria-hidden="true" tabindex="-1"></a>WHs <span class="ot">&lt;-</span> <span class="fu">sum</span>(hourtemps<span class="sc">$</span>Warm_Hour[Start_Date<span class="sc">:</span>End_Date])</span>
<span id="cb194-284"><a href="#cb194-284" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(WHs)</span>
<span id="cb194-285"><a href="#cb194-285" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-286"><a href="#cb194-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-287"><a href="#cb194-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-288"><a href="#cb194-288" aria-hidden="true" tabindex="-1"></a>#Example</span>
<span id="cb194-289"><a href="#cb194-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-292"><a href="#cb194-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-293"><a href="#cb194-293" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_WH</span>(Winters_hours_gaps, <span class="at">startYEARMODAHO =</span> <span class="dv">2008070100</span>, </span>
<span id="cb194-294"><a href="#cb194-294" aria-hidden="true" tabindex="-1"></a>                           <span class="at">endYEARMODAHO =</span> <span class="dv">2008073123</span>)</span>
<span id="cb194-295"><a href="#cb194-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-296"><a href="#cb194-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-297"><a href="#cb194-297" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-298"><a href="#cb194-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-299"><a href="#cb194-299" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 7: Winter Chill Projections</span></span>
<span id="cb194-300"><a href="#cb194-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-301"><a href="#cb194-301" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises Chill Models***</span></span>
<span id="cb194-302"><a href="#cb194-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-303"><a href="#cb194-303" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Run the chilling() function on the Winters_hours_gap dataset</span>
<span id="cb194-304"><a href="#cb194-304" aria-hidden="true" tabindex="-1"></a>    #chilling function</span>
<span id="cb194-305"><a href="#cb194-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-308"><a href="#cb194-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-309"><a href="#cb194-309" aria-hidden="true" tabindex="-1"></a>july <span class="ot">&lt;-</span> <span class="fu">chilling</span>(<span class="fu">make_JDay</span>(Winters_hours_gaps),</span>
<span id="cb194-310"><a href="#cb194-310" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Start_JDay =</span> <span class="dv">183</span>, </span>
<span id="cb194-311"><a href="#cb194-311" aria-hidden="true" tabindex="-1"></a>                   <span class="at">End_JDay =</span> <span class="dv">213</span>)</span>
<span id="cb194-312"><a href="#cb194-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-313"><a href="#cb194-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-314"><a href="#cb194-314" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Create your own temperature-weighting chill model using the</span>
<span id="cb194-315"><a href="#cb194-315" aria-hidden="true" tabindex="-1"></a>    step_model() function #step model</span>
<span id="cb194-316"><a href="#cb194-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-319"><a href="#cb194-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-320"><a href="#cb194-320" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb194-321"><a href="#cb194-321" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="dv">0</span>,  <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>,   <span class="dv">10</span>),  </span>
<span id="cb194-322"><a href="#cb194-322" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">c</span>(    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">1000</span>), </span>
<span id="cb194-323"><a href="#cb194-323" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(   <span class="dv">0</span>, <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">2</span>,  <span class="dv">1</span>,    <span class="dv">0</span>))</span>
<span id="cb194-324"><a href="#cb194-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-325"><a href="#cb194-325" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb194-326"><a href="#cb194-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">position =</span> <span class="st">"left"</span>, <span class="at">font_size =</span> <span class="dv">12</span>)</span>
<span id="cb194-327"><a href="#cb194-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-328"><a href="#cb194-328" aria-hidden="true" tabindex="-1"></a>custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">step_model</span>(x, df)</span>
<span id="cb194-329"><a href="#cb194-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-330"><a href="#cb194-330" aria-hidden="true" tabindex="-1"></a><span class="fu">custom</span>(Winters_hours_gaps<span class="sc">$</span>Temp)[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span>
<span id="cb194-331"><a href="#cb194-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-332"><a href="#cb194-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-333"><a href="#cb194-333" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Run this model on the Winters_hours_gaps dataset using the</span>
<span id="cb194-334"><a href="#cb194-334" aria-hidden="true" tabindex="-1"></a>    tempResponse() function.</span>
<span id="cb194-335"><a href="#cb194-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-338"><a href="#cb194-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-339"><a href="#cb194-339" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">tempResponse</span>(<span class="fu">make_JDay</span>(Winters_hours_gaps),</span>
<span id="cb194-340"><a href="#cb194-340" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Start_JDay =</span> <span class="dv">183</span>,</span>
<span id="cb194-341"><a href="#cb194-341" aria-hidden="true" tabindex="-1"></a>                       <span class="at">End_JDay =</span> <span class="dv">213</span>,</span>
<span id="cb194-342"><a href="#cb194-342" aria-hidden="true" tabindex="-1"></a>                       <span class="at">models =</span> <span class="fu">list</span>(<span class="at">Chill_Portions =</span> Dynamic_Model, </span>
<span id="cb194-343"><a href="#cb194-343" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">GDH =</span> GDH))</span>
<span id="cb194-344"><a href="#cb194-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-345"><a href="#cb194-345" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(output) <span class="sc">%&gt;%</span></span>
<span id="cb194-346"><a href="#cb194-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, </span>
<span id="cb194-347"><a href="#cb194-347" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="st">"left"</span>,</span>
<span id="cb194-348"><a href="#cb194-348" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">12</span>)</span>
<span id="cb194-349"><a href="#cb194-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-350"><a href="#cb194-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-351"><a href="#cb194-351" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-352"><a href="#cb194-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-353"><a href="#cb194-353" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 8: Making Hourly Temperatures</span></span>
<span id="cb194-354"><a href="#cb194-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-355"><a href="#cb194-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on hourly*** </span></span>
<span id="cb194-356"><a href="#cb194-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-357"><a href="#cb194-357" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Choose a location of interest, find out its latitude and produce</span>
<span id="cb194-358"><a href="#cb194-358" aria-hidden="true" tabindex="-1"></a>    plots of daily sunrise, sunset and daylength</span>
<span id="cb194-359"><a href="#cb194-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-362"><a href="#cb194-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-363"><a href="#cb194-363" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(chillR)</span>
<span id="cb194-364"><a href="#cb194-364" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb194-365"><a href="#cb194-365" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb194-366"><a href="#cb194-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-367"><a href="#cb194-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-368"><a href="#cb194-368" aria-hidden="true" tabindex="-1"></a><span class="fu"># sunset time and daylength at Rochester (Latitude: 43.15Â°N) over the</span></span>
<span id="cb194-369"><a href="#cb194-369" aria-hidden="true" tabindex="-1"></a>course of the year.</span>
<span id="cb194-370"><a href="#cb194-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-373"><a href="#cb194-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-374"><a href="#cb194-374" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">daylength</span>(<span class="at">latitude =</span> <span class="dv">43</span>,</span>
<span id="cb194-375"><a href="#cb194-375" aria-hidden="true" tabindex="-1"></a>                  <span class="at">JDay =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>)</span>
<span id="cb194-376"><a href="#cb194-376" aria-hidden="true" tabindex="-1"></a>Days_df <span class="ot">&lt;-</span></span>
<span id="cb194-377"><a href="#cb194-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb194-378"><a href="#cb194-378" aria-hidden="true" tabindex="-1"></a>    <span class="at">JDay =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>,</span>
<span id="cb194-379"><a href="#cb194-379" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sunrise =</span> Days<span class="sc">$</span>Sunrise,</span>
<span id="cb194-380"><a href="#cb194-380" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sunset =</span> Days<span class="sc">$</span>Sunset,</span>
<span id="cb194-381"><a href="#cb194-381" aria-hidden="true" tabindex="-1"></a>    <span class="at">Daylength =</span> Days<span class="sc">$</span>Daylength</span>
<span id="cb194-382"><a href="#cb194-382" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb194-383"><a href="#cb194-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-384"><a href="#cb194-384" aria-hidden="true" tabindex="-1"></a>Days_df <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(Days_df, <span class="at">cols=</span><span class="fu">c</span>(Sunrise<span class="sc">:</span>Daylength))</span>
<span id="cb194-385"><a href="#cb194-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-386"><a href="#cb194-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-387"><a href="#cb194-387" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Days_df, <span class="fu">aes</span>(JDay, value)) <span class="sc">+</span></span>
<span id="cb194-388"><a href="#cb194-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb194-389"><a href="#cb194-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(name)) <span class="sc">+</span></span>
<span id="cb194-390"><a href="#cb194-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Time of Day / Daylength (Hours)"</span>) <span class="sc">+</span></span>
<span id="cb194-391"><a href="#cb194-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span>
<span id="cb194-392"><a href="#cb194-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-393"><a href="#cb194-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-394"><a href="#cb194-394" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Produce an hourly dataset, based on idealized daily curves, for the</span>
<span id="cb194-395"><a href="#cb194-395" aria-hidden="true" tabindex="-1"></a>    KA_weather dataset (included in chillR)</span>
<span id="cb194-396"><a href="#cb194-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-399"><a href="#cb194-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-400"><a href="#cb194-400" aria-hidden="true" tabindex="-1"></a><span class="fu">stack_hourly_temps</span>(KA_weather, <span class="at">latitude =</span> <span class="dv">43</span>) [[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb194-401"><a href="#cb194-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-402"><a href="#cb194-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-403"><a href="#cb194-403" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Produce empirical temperature curve parameters for the Winters_hours_gaps dataset, and use them to predict hourly values from daily temperatures (this is very similar to the example above,but please make sure you understand whatâs going on).</span>
<span id="cb194-404"><a href="#cb194-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-407"><a href="#cb194-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-408"><a href="#cb194-408" aria-hidden="true" tabindex="-1"></a>empi_curve <span class="ot">&lt;-</span> <span class="fu">Empirical_daily_temperature_curve</span>(Winters_hours_gaps)</span>
<span id="cb194-409"><a href="#cb194-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-410"><a href="#cb194-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-413"><a href="#cb194-413" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-414"><a href="#cb194-414" aria-hidden="true" tabindex="-1"></a>Winters_daily <span class="ot">&lt;-</span> <span class="fu">make_all_day_table</span>(Winters_hours_gaps, <span class="at">input_timestep =</span> <span class="st">"hour"</span>)</span>
<span id="cb194-415"><a href="#cb194-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-416"><a href="#cb194-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-417"><a href="#cb194-417" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-418"><a href="#cb194-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-419"><a href="#cb194-419" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 9: Some Useful tools in R</span></span>
<span id="cb194-420"><a href="#cb194-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-421"><a href="#cb194-421" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on useful R tools*** </span></span>
<span id="cb194-422"><a href="#cb194-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-423"><a href="#cb194-423" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Based on the Winters_hours_gaps dataset, use magrittr pipes and</span>
<span id="cb194-424"><a href="#cb194-424" aria-hidden="true" tabindex="-1"></a>    functions of the tidyverse to accomplish the following:</span>
<span id="cb194-425"><a href="#cb194-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-426"><a href="#cb194-426" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the dataset into a tibble</span>
<span id="cb194-427"><a href="#cb194-427" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Select only the top 10 rows of the dataset</span>
<span id="cb194-428"><a href="#cb194-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-431"><a href="#cb194-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-432"><a href="#cb194-432" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(chillR)</span>
<span id="cb194-433"><a href="#cb194-433" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb194-434"><a href="#cb194-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-435"><a href="#cb194-435" aria-hidden="true" tabindex="-1"></a>WHG <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Winters_hours_gaps[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ])</span>
<span id="cb194-436"><a href="#cb194-436" aria-hidden="true" tabindex="-1"></a>WHG</span>
<span id="cb194-437"><a href="#cb194-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-438"><a href="#cb194-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-439"><a href="#cb194-439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the tibble to a long format, with separate rows for</span>
<span id="cb194-440"><a href="#cb194-440" aria-hidden="true" tabindex="-1"></a>    Temp_gaps and Temp</span>
<span id="cb194-441"><a href="#cb194-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-444"><a href="#cb194-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-445"><a href="#cb194-445" aria-hidden="true" tabindex="-1"></a>WHGlong <span class="ot">&lt;-</span> WHG <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Temp_gaps<span class="sc">:</span>Temp)</span>
<span id="cb194-446"><a href="#cb194-446" aria-hidden="true" tabindex="-1"></a>WHGlong</span>
<span id="cb194-447"><a href="#cb194-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-448"><a href="#cb194-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-449"><a href="#cb194-449" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use ggplot2 to plot Temp_gaps and Temp as facets (point or line</span>
<span id="cb194-450"><a href="#cb194-450" aria-hidden="true" tabindex="-1"></a>    plot)</span>
<span id="cb194-453"><a href="#cb194-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-454"><a href="#cb194-454" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(WHGlong, <span class="fu">aes</span>(Hour, value)) <span class="sc">+</span></span>
<span id="cb194-455"><a href="#cb194-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span><span class="fl">0.2</span>), <span class="at">size=</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb194-456"><a href="#cb194-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>,<span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb194-457"><a href="#cb194-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Temperature (Â°C)"</span>) <span class="sc">+</span></span>
<span id="cb194-458"><a href="#cb194-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb194-459"><a href="#cb194-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-460"><a href="#cb194-460" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-461"><a href="#cb194-461" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the dataset back to the wide format</span>
<span id="cb194-462"><a href="#cb194-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-465"><a href="#cb194-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-466"><a href="#cb194-466" aria-hidden="true" tabindex="-1"></a>WHGwide <span class="ot">&lt;-</span> WHGlong <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name)</span>
<span id="cb194-467"><a href="#cb194-467" aria-hidden="true" tabindex="-1"></a>WHGwide</span>
<span id="cb194-468"><a href="#cb194-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-469"><a href="#cb194-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-470"><a href="#cb194-470" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Select only the following columns: Year, Month, Day and Temp</span>
<span id="cb194-471"><a href="#cb194-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-474"><a href="#cb194-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-475"><a href="#cb194-475" aria-hidden="true" tabindex="-1"></a>WHG <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Year, Month, Day, Temp))</span>
<span id="cb194-476"><a href="#cb194-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-477"><a href="#cb194-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-478"><a href="#cb194-478" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sort the dataset by the Temp column, in descending order</span>
<span id="cb194-479"><a href="#cb194-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-482"><a href="#cb194-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-483"><a href="#cb194-483" aria-hidden="true" tabindex="-1"></a>WHG <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Temp))</span>
<span id="cb194-484"><a href="#cb194-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-485"><a href="#cb194-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-486"><a href="#cb194-486" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>For the Winter_hours_gaps dataset, write a for loop to convert all</span>
<span id="cb194-487"><a href="#cb194-487" aria-hidden="true" tabindex="-1"></a>    temperatures (Temp column) to degrees Fahrenheit</span>
<span id="cb194-490"><a href="#cb194-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-491"><a href="#cb194-491" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Winters_hours_gaps<span class="sc">$</span>Temp[<span class="dv">183</span><span class="sc">:</span><span class="dv">213</span>] <span class="co"># JDay for July</span></span>
<span id="cb194-492"><a href="#cb194-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-493"><a href="#cb194-493" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> Temp)</span>
<span id="cb194-494"><a href="#cb194-494" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb194-495"><a href="#cb194-495" aria-hidden="true" tabindex="-1"></a>  Fahrenheit <span class="ot">&lt;-</span> i <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span> </span>
<span id="cb194-496"><a href="#cb194-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(Fahrenheit) </span>
<span id="cb194-497"><a href="#cb194-497" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-498"><a href="#cb194-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-499"><a href="#cb194-499" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-500"><a href="#cb194-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-501"><a href="#cb194-501" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Execute the same operation with a function from the apply family</span>
<span id="cb194-502"><a href="#cb194-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-505"><a href="#cb194-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-506"><a href="#cb194-506" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Winters_hours_gaps<span class="sc">$</span>Temp[<span class="dv">183</span><span class="sc">:</span><span class="dv">213</span>]</span>
<span id="cb194-507"><a href="#cb194-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-508"><a href="#cb194-508" aria-hidden="true" tabindex="-1"></a>fahrenheit <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb194-509"><a href="#cb194-509" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span></span>
<span id="cb194-510"><a href="#cb194-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-511"><a href="#cb194-511" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x, fahrenheit)</span>
<span id="cb194-512"><a href="#cb194-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-513"><a href="#cb194-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-514"><a href="#cb194-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-515"><a href="#cb194-515" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Now use the tidyverse function mutate to achieve the same outcome</span>
<span id="cb194-518"><a href="#cb194-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-519"><a href="#cb194-519" aria-hidden="true" tabindex="-1"></a>WHG_F <span class="ot">&lt;-</span> WHG <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Temp_F =</span> Temp <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span>)</span>
<span id="cb194-520"><a href="#cb194-520" aria-hidden="true" tabindex="-1"></a>WHG_F</span>
<span id="cb194-521"><a href="#cb194-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-522"><a href="#cb194-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-523"><a href="#cb194-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-524"><a href="#cb194-524" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-525"><a href="#cb194-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-526"><a href="#cb194-526" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 10: Getting temperature data</span></span>
<span id="cb194-527"><a href="#cb194-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-528"><a href="#cb194-528" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on getting temperature data*** </span></span>
<span id="cb194-529"><a href="#cb194-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-530"><a href="#cb194-530" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Choose a location of interest and find the 25 closest weather</span>
<span id="cb194-531"><a href="#cb194-531" aria-hidden="true" tabindex="-1"></a>    stations using the handle_gsod function</span>
<span id="cb194-532"><a href="#cb194-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-535"><a href="#cb194-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-536"><a href="#cb194-536" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb194-537"><a href="#cb194-537" aria-hidden="true" tabindex="-1"></a>station_list_Rochester <span class="ot">&lt;-</span><span class="fu">handle_gsod</span>(<span class="at">action=</span><span class="st">"list_stations"</span>,</span>
<span id="cb194-538"><a href="#cb194-538" aria-hidden="true" tabindex="-1"></a>                          <span class="at">location=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span>),</span>
<span id="cb194-539"><a href="#cb194-539" aria-hidden="true" tabindex="-1"></a>                          <span class="at">time_interval=</span><span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2020</span>))</span>
<span id="cb194-540"><a href="#cb194-540" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb194-541"><a href="#cb194-541" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(kableExtra)</span>
<span id="cb194-542"><a href="#cb194-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-543"><a href="#cb194-543" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(station_list_Rochester) <span class="sc">%&gt;%</span></span>
<span id="cb194-544"><a href="#cb194-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">position =</span> <span class="st">"left"</span>, <span class="at">font_size =</span> <span class="dv">8</span>)</span>
<span id="cb194-545"><a href="#cb194-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-546"><a href="#cb194-546" aria-hidden="true" tabindex="-1"></a>station_list_Rochester</span>
<span id="cb194-547"><a href="#cb194-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-548"><a href="#cb194-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-549"><a href="#cb194-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-550"><a href="#cb194-550" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Download weather data for the most promising station on the list</span>
<span id="cb194-551"><a href="#cb194-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-554"><a href="#cb194-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-555"><a href="#cb194-555" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">"download_weather"</span>,</span>
<span id="cb194-556"><a href="#cb194-556" aria-hidden="true" tabindex="-1"></a>                       <span class="at">location =</span> station_list_Rochester<span class="sc">$</span>chillR_code[<span class="dv">1</span>],</span>
<span id="cb194-557"><a href="#cb194-557" aria-hidden="true" tabindex="-1"></a>                       <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">2020</span>))</span>
<span id="cb194-558"><a href="#cb194-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-559"><a href="#cb194-559" aria-hidden="true" tabindex="-1"></a>weather[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb194-560"><a href="#cb194-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-561"><a href="#cb194-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-562"><a href="#cb194-562" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Convert the weather data into chillR format</span>
<span id="cb194-563"><a href="#cb194-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-566"><a href="#cb194-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-567"><a href="#cb194-567" aria-hidden="true" tabindex="-1"></a>cleaned_weather <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(weather)</span>
<span id="cb194-568"><a href="#cb194-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-569"><a href="#cb194-569" aria-hidden="true" tabindex="-1"></a>cleaned_weather[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb194-570"><a href="#cb194-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-571"><a href="#cb194-571" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"data_New_York"</span>)</span>
<span id="cb194-572"><a href="#cb194-572" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(station_list_Rochester,</span>
<span id="cb194-573"><a href="#cb194-573" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/station_list_Rochester.csv"</span>,</span>
<span id="cb194-574"><a href="#cb194-574" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb194-575"><a href="#cb194-575" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(weather[[<span class="dv">1</span>]],</span>
<span id="cb194-576"><a href="#cb194-576" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/Rochester_weather.csv"</span>,</span>
<span id="cb194-577"><a href="#cb194-577" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb194-578"><a href="#cb194-578" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(cleaned_weather[[<span class="dv">1</span>]],</span>
<span id="cb194-579"><a href="#cb194-579" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/Rochester_chillR_weather.csv"</span>,</span>
<span id="cb194-580"><a href="#cb194-580" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb194-581"><a href="#cb194-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-582"><a href="#cb194-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-583"><a href="#cb194-583" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-584"><a href="#cb194-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-585"><a href="#cb194-585" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 11: Getting temperature data</span></span>
<span id="cb194-586"><a href="#cb194-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-587"><a href="#cb194-587" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on getting temperature data*** </span></span>
<span id="cb194-588"><a href="#cb194-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-589"><a href="#cb194-589" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Use chillR functions to find out how many gaps you have in this</span>
<span id="cb194-590"><a href="#cb194-590" aria-hidden="true" tabindex="-1"></a>    dataset (even if you have none, please still follow all further</span>
<span id="cb194-591"><a href="#cb194-591" aria-hidden="true" tabindex="-1"></a>    steps)</span>
<span id="cb194-592"><a href="#cb194-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-595"><a href="#cb194-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-596"><a href="#cb194-596" aria-hidden="true" tabindex="-1"></a>Rochester <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data_New_York/Rochester_chillR_weather.csv"</span>)</span>
<span id="cb194-597"><a href="#cb194-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-598"><a href="#cb194-598" aria-hidden="true" tabindex="-1"></a>Rochester_QC <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(Rochester)<span class="sc">$</span>QC</span>
<span id="cb194-599"><a href="#cb194-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-600"><a href="#cb194-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-601"><a href="#cb194-601" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Create a list of the 25 closest weather stations using the</span>
<span id="cb194-602"><a href="#cb194-602" aria-hidden="true" tabindex="-1"></a>    handle_gsod function</span>
<span id="cb194-603"><a href="#cb194-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-606"><a href="#cb194-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-607"><a href="#cb194-607" aria-hidden="true" tabindex="-1"></a>station_list <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action=</span><span class="st">"list_stations"</span>,</span>
<span id="cb194-608"><a href="#cb194-608" aria-hidden="true" tabindex="-1"></a>                            <span class="at">location=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span>),</span>
<span id="cb194-609"><a href="#cb194-609" aria-hidden="true" tabindex="-1"></a>                              <span class="at">time_interval=</span><span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2020</span>))</span>
<span id="cb194-610"><a href="#cb194-610" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb194-611"><a href="#cb194-611" aria-hidden="true" tabindex="-1"></a>station_list</span>
<span id="cb194-612"><a href="#cb194-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-613"><a href="#cb194-613" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(station_list, <span class="at">n =</span> <span class="dv">26</span>)</span>
<span id="cb194-614"><a href="#cb194-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-615"><a href="#cb194-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-616"><a href="#cb194-616" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Identify suitable weather stations for patching gaps</span>
<span id="cb194-617"><a href="#cb194-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-618"><a href="#cb194-618" aria-hidden="true" tabindex="-1"></a>#download stations number 4, 5, and 10 these will be used to patch</span>
<span id="cb194-619"><a href="#cb194-619" aria-hidden="true" tabindex="-1"></a>the gaps</span>
<span id="cb194-620"><a href="#cb194-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-621"><a href="#cb194-621" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Download weather data for promising stations, convert them to chillR</span>
<span id="cb194-622"><a href="#cb194-622" aria-hidden="true" tabindex="-1"></a>    format and compile them in a list</span>
<span id="cb194-623"><a href="#cb194-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-626"><a href="#cb194-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-627"><a href="#cb194-627" aria-hidden="true" tabindex="-1"></a>patch_weather<span class="ot">&lt;-</span></span>
<span id="cb194-628"><a href="#cb194-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">"download_weather"</span>,</span>
<span id="cb194-629"><a href="#cb194-629" aria-hidden="true" tabindex="-1"></a>              <span class="at">location =</span> <span class="fu">as.character</span>(station_list<span class="sc">$</span>chillR_code[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">10</span>)]),</span>
<span id="cb194-630"><a href="#cb194-630" aria-hidden="true" tabindex="-1"></a>              <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2020</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb194-631"><a href="#cb194-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">handle_gsod</span>()</span>
<span id="cb194-632"><a href="#cb194-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-633"><a href="#cb194-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-634"><a href="#cb194-634" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Use the patch_daily_temperatures function to fill gaps</span>
<span id="cb194-635"><a href="#cb194-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-638"><a href="#cb194-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-639"><a href="#cb194-639" aria-hidden="true" tabindex="-1"></a>patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(<span class="at">weather =</span> Rochester,</span>
<span id="cb194-640"><a href="#cb194-640" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">patch_weather =</span> patch_weather)</span>
<span id="cb194-641"><a href="#cb194-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-642"><a href="#cb194-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-643"><a href="#cb194-643" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">1</span>]]</span>
<span id="cb194-644"><a href="#cb194-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-645"><a href="#cb194-645" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">2</span>]]</span>
<span id="cb194-646"><a href="#cb194-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-647"><a href="#cb194-647" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">3</span>]]</span>
<span id="cb194-648"><a href="#cb194-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-649"><a href="#cb194-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-650"><a href="#cb194-650" aria-hidden="true" tabindex="-1"></a>#set minimum quality criteria</span>
<span id="cb194-651"><a href="#cb194-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-654"><a href="#cb194-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-655"><a href="#cb194-655" aria-hidden="true" tabindex="-1"></a>patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(<span class="at">weather =</span> Rochester,</span>
<span id="cb194-656"><a href="#cb194-656" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb194-657"><a href="#cb194-657" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb194-658"><a href="#cb194-658" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">max_stdev_bias =</span> <span class="dv">2</span>)</span>
<span id="cb194-659"><a href="#cb194-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-660"><a href="#cb194-660" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">1</span>]]</span>
<span id="cb194-661"><a href="#cb194-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-662"><a href="#cb194-662" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">2</span>]]</span>
<span id="cb194-663"><a href="#cb194-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-664"><a href="#cb194-664" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">3</span>]]</span>
<span id="cb194-665"><a href="#cb194-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-666"><a href="#cb194-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-667"><a href="#cb194-667" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Investigate the results - have all gaps been filled?</span>
<span id="cb194-668"><a href="#cb194-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-671"><a href="#cb194-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-672"><a href="#cb194-672" aria-hidden="true" tabindex="-1"></a>post_patch_stats <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(patched)<span class="sc">$</span>QC</span>
<span id="cb194-673"><a href="#cb194-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-674"><a href="#cb194-674" aria-hidden="true" tabindex="-1"></a>post_patch_stats</span>
<span id="cb194-675"><a href="#cb194-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-676"><a href="#cb194-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-677"><a href="#cb194-677" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>If necessary, repeat until you have a dataset you can work with in</span>
<span id="cb194-678"><a href="#cb194-678" aria-hidden="true" tabindex="-1"></a>    further analyses</span>
<span id="cb194-679"><a href="#cb194-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-682"><a href="#cb194-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-683"><a href="#cb194-683" aria-hidden="true" tabindex="-1"></a>Rochester_weather<span class="ot">&lt;-</span><span class="fu">fix_weather</span>(patched)</span>
<span id="cb194-684"><a href="#cb194-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-685"><a href="#cb194-685" aria-hidden="true" tabindex="-1"></a>patched_monthly <span class="ot">&lt;-</span> <span class="fu">patch_daily_temps</span>(<span class="at">weather =</span> Rochester,</span>
<span id="cb194-686"><a href="#cb194-686" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb194-687"><a href="#cb194-687" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb194-688"><a href="#cb194-688" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">max_stdev_bias =</span> <span class="dv">2</span>,</span>
<span id="cb194-689"><a href="#cb194-689" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">time_interval =</span> <span class="st">"month"</span>)</span>
<span id="cb194-690"><a href="#cb194-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-691"><a href="#cb194-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-692"><a href="#cb194-692" aria-hidden="true" tabindex="-1"></a>#saving the data for later</span>
<span id="cb194-693"><a href="#cb194-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-696"><a href="#cb194-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-697"><a href="#cb194-697" aria-hidden="true" tabindex="-1"></a>monthly_bias_fixed <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(patched_monthly)</span>
<span id="cb194-698"><a href="#cb194-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-699"><a href="#cb194-699" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(monthly_bias_fixed<span class="sc">$</span>weather,</span>
<span id="cb194-700"><a href="#cb194-700" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/Rochester_weather.csv"</span>)</span>
<span id="cb194-701"><a href="#cb194-701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-702"><a href="#cb194-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-703"><a href="#cb194-703" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-704"><a href="#cb194-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-705"><a href="#cb194-705" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 12: Generating temperature scenarios</span></span>
<span id="cb194-706"><a href="#cb194-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-707"><a href="#cb194-707" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on getting temperature data*** </span></span>
<span id="cb194-708"><a href="#cb194-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-709"><a href="#cb194-709" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>For the location you chose for your earlier analyses, use chillRâs</span>
<span id="cb194-710"><a href="#cb194-710" aria-hidden="true" tabindex="-1"></a>    weather generator to produce 100 years of synthetic temperature</span>
<span id="cb194-711"><a href="#cb194-711" aria-hidden="true" tabindex="-1"></a>    data.</span>
<span id="cb194-714"><a href="#cb194-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-715"><a href="#cb194-715" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb194-716"><a href="#cb194-716" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb194-717"><a href="#cb194-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-718"><a href="#cb194-718" aria-hidden="true" tabindex="-1"></a>Rochester <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data_New_York/Rochester_weather.csv'</span>)</span>
<span id="cb194-719"><a href="#cb194-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-720"><a href="#cb194-720" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Rochester <span class="sc">%&gt;%</span></span>
<span id="cb194-721"><a href="#cb194-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">temperature_generation</span>(<span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2009</span>),</span>
<span id="cb194-722"><a href="#cb194-722" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">2100</span>))</span>
<span id="cb194-723"><a href="#cb194-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-724"><a href="#cb194-724" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb194-725"><a href="#cb194-725" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb194-726"><a href="#cb194-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-727"><a href="#cb194-727" aria-hidden="true" tabindex="-1"></a>Temperatures <span class="ot">&lt;-</span> Rochester <span class="sc">%&gt;%</span> </span>
<span id="cb194-728"><a href="#cb194-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, Day, Tmin, Tmax) <span class="sc">%&gt;%</span> </span>
<span id="cb194-729"><a href="#cb194-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="dv">1998</span><span class="sc">:</span><span class="dv">2009</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-730"><a href="#cb194-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">"observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-731"><a href="#cb194-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb194-732"><a href="#cb194-732" aria-hidden="true" tabindex="-1"></a>    Temp[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Year,</span>
<span id="cb194-733"><a href="#cb194-733" aria-hidden="true" tabindex="-1"></a>                           Month,</span>
<span id="cb194-734"><a href="#cb194-734" aria-hidden="true" tabindex="-1"></a>                           Day,</span>
<span id="cb194-735"><a href="#cb194-735" aria-hidden="true" tabindex="-1"></a>                           Tmin,</span>
<span id="cb194-736"><a href="#cb194-736" aria-hidden="true" tabindex="-1"></a>                           Tmax)) <span class="sc">%&gt;%</span></span>
<span id="cb194-737"><a href="#cb194-737" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">"simulated"</span>)</span>
<span id="cb194-738"><a href="#cb194-738" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb194-739"><a href="#cb194-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">ISOdate</span>(<span class="dv">2000</span>,</span>
<span id="cb194-740"><a href="#cb194-740" aria-hidden="true" tabindex="-1"></a>                                Month,</span>
<span id="cb194-741"><a href="#cb194-741" aria-hidden="true" tabindex="-1"></a>                                Day)))</span>
<span id="cb194-742"><a href="#cb194-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-743"><a href="#cb194-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-744"><a href="#cb194-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-747"><a href="#cb194-747" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-748"><a href="#cb194-748" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Temperatures,</span>
<span id="cb194-749"><a href="#cb194-749" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(Date,</span>
<span id="cb194-750"><a href="#cb194-750" aria-hidden="true" tabindex="-1"></a>           Tmin)) <span class="sc">+</span></span>
<span id="cb194-751"><a href="#cb194-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb194-752"><a href="#cb194-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Data_source)) <span class="sc">+</span></span>
<span id="cb194-753"><a href="#cb194-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb194-754"><a href="#cb194-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb194-755"><a href="#cb194-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b"</span>)</span>
<span id="cb194-756"><a href="#cb194-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-757"><a href="#cb194-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-758"><a href="#cb194-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-761"><a href="#cb194-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-762"><a href="#cb194-762" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Temperatures,</span>
<span id="cb194-763"><a href="#cb194-763" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(Date,</span>
<span id="cb194-764"><a href="#cb194-764" aria-hidden="true" tabindex="-1"></a>           Tmax)) <span class="sc">+</span></span>
<span id="cb194-765"><a href="#cb194-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb194-766"><a href="#cb194-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Data_source)) <span class="sc">+</span></span>
<span id="cb194-767"><a href="#cb194-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb194-768"><a href="#cb194-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb194-769"><a href="#cb194-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b"</span>)</span>
<span id="cb194-770"><a href="#cb194-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-771"><a href="#cb194-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-772"><a href="#cb194-772" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Calculate winter chill (in Chill Portions) for your synthetic</span>
<span id="cb194-773"><a href="#cb194-773" aria-hidden="true" tabindex="-1"></a>    weather, and illustrate your results as histograms and cumulative</span>
<span id="cb194-774"><a href="#cb194-774" aria-hidden="true" tabindex="-1"></a>    distributions.</span>
<span id="cb194-777"><a href="#cb194-777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-778"><a href="#cb194-778" aria-hidden="true" tabindex="-1"></a>chill_observed <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb194-779"><a href="#cb194-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">"observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-780"><a href="#cb194-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">43.15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-781"><a href="#cb194-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chilling</span>(<span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb194-782"><a href="#cb194-782" aria-hidden="true" tabindex="-1"></a>           <span class="at">End_JDay =</span> <span class="dv">59</span>)</span>
<span id="cb194-783"><a href="#cb194-783" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-784"><a href="#cb194-784" aria-hidden="true" tabindex="-1"></a>chill_simulated <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb194-785"><a href="#cb194-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">"simulated"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-786"><a href="#cb194-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">43.15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-787"><a href="#cb194-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chilling</span>(<span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb194-788"><a href="#cb194-788" aria-hidden="true" tabindex="-1"></a>           <span class="at">End_JDay =</span> <span class="dv">59</span>)</span>
<span id="cb194-789"><a href="#cb194-789" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-790"><a href="#cb194-790" aria-hidden="true" tabindex="-1"></a>chill_comparison <span class="ot">&lt;-</span></span>
<span id="cb194-791"><a href="#cb194-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(chill_observed,</span>
<span id="cb194-792"><a href="#cb194-792" aria-hidden="true" tabindex="-1"></a>        <span class="at">Data_source =</span> <span class="st">"observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-793"><a href="#cb194-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">cbind</span>(chill_simulated,</span>
<span id="cb194-794"><a href="#cb194-794" aria-hidden="true" tabindex="-1"></a>              <span class="at">Data_source =</span> <span class="st">"simulated"</span>))</span>
<span id="cb194-795"><a href="#cb194-795" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-796"><a href="#cb194-796" aria-hidden="true" tabindex="-1"></a>chill_comparison_full_seasons <span class="ot">&lt;-</span> </span>
<span id="cb194-797"><a href="#cb194-797" aria-hidden="true" tabindex="-1"></a>  chill_comparison <span class="sc">%&gt;%</span></span>
<span id="cb194-798"><a href="#cb194-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb194-799"><a href="#cb194-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-800"><a href="#cb194-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-803"><a href="#cb194-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-804"><a href="#cb194-804" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chill_comparison_full_seasons,</span>
<span id="cb194-805"><a href="#cb194-805" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Chill_portions)) <span class="sc">+</span> </span>
<span id="cb194-806"><a href="#cb194-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb194-807"><a href="#cb194-807" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Data_source))) <span class="sc">+</span></span>
<span id="cb194-808"><a href="#cb194-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb194-809"><a href="#cb194-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Data source"</span>) <span class="sc">+</span></span>
<span id="cb194-810"><a href="#cb194-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Chill accumulation (Chill Portions)"</span>) <span class="sc">+</span></span>
<span id="cb194-811"><a href="#cb194-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>)</span>
<span id="cb194-812"><a href="#cb194-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-813"><a href="#cb194-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-816"><a href="#cb194-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-817"><a href="#cb194-817" aria-hidden="true" tabindex="-1"></a>chill_simulations <span class="ot">&lt;-</span></span>
<span id="cb194-818"><a href="#cb194-818" aria-hidden="true" tabindex="-1"></a>  chill_comparison_full_seasons <span class="sc">%&gt;%</span></span>
<span id="cb194-819"><a href="#cb194-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">"simulated"</span>)</span>
<span id="cb194-820"><a href="#cb194-820" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-821"><a href="#cb194-821" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chill_simulations,</span>
<span id="cb194-822"><a href="#cb194-822" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Chill_portions)) <span class="sc">+</span></span>
<span id="cb194-823"><a href="#cb194-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">"step"</span>,</span>
<span id="cb194-824"><a href="#cb194-824" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb194-825"><a href="#cb194-825" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb194-826"><a href="#cb194-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative probability"</span>) <span class="sc">+</span></span>
<span id="cb194-827"><a href="#cb194-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Chill accumulation (in Chill Portions)"</span>) <span class="sc">+</span></span>
<span id="cb194-828"><a href="#cb194-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span>
<span id="cb194-829"><a href="#cb194-829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-830"><a href="#cb194-830" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Produce similar plots for the number of freezing hours (<span class="sc">\&lt;</span>0Â°C) in</span>
<span id="cb194-831"><a href="#cb194-831" aria-hidden="true" tabindex="-1"></a>    April (or October, if your site is in the Southern Hemisphere) for</span>
<span id="cb194-832"><a href="#cb194-832" aria-hidden="true" tabindex="-1"></a>    your location of interest.</span>
<span id="cb194-833"><a href="#cb194-833" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-836"><a href="#cb194-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-837"><a href="#cb194-837" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb194-838"><a href="#cb194-838" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span>  <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>,    <span class="dv">0</span>),</span>
<span id="cb194-839"><a href="#cb194-839" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span>  <span class="fu">c</span>(    <span class="dv">0</span>, <span class="dv">1000</span>),</span>
<span id="cb194-840"><a href="#cb194-840" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(    <span class="dv">1</span>,    <span class="dv">0</span>))</span>
<span id="cb194-841"><a href="#cb194-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-842"><a href="#cb194-842" aria-hidden="true" tabindex="-1"></a>freezing_hours <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">step_model</span>(x,df)</span>
<span id="cb194-843"><a href="#cb194-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-844"><a href="#cb194-844" aria-hidden="true" tabindex="-1"></a>chill_observed <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb194-845"><a href="#cb194-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">"observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-846"><a href="#cb194-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">43.15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-847"><a href="#cb194-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tempResponse</span>(<span class="at">Start_JDay =</span> <span class="dv">91</span>,</span>
<span id="cb194-848"><a href="#cb194-848" aria-hidden="true" tabindex="-1"></a>               <span class="at">End_JDay =</span> <span class="dv">120</span>,</span>
<span id="cb194-849"><a href="#cb194-849" aria-hidden="true" tabindex="-1"></a>               <span class="at">models =</span> <span class="fu">list</span>(<span class="at">Frost =</span> freezing_hours,</span>
<span id="cb194-850"><a href="#cb194-850" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Chill_portions =</span> Dynamic_Model,</span>
<span id="cb194-851"><a href="#cb194-851" aria-hidden="true" tabindex="-1"></a>                             <span class="at">GDH =</span> GDH))</span>
<span id="cb194-852"><a href="#cb194-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-853"><a href="#cb194-853" aria-hidden="true" tabindex="-1"></a>chill_simulated <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb194-854"><a href="#cb194-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">"simulated"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-855"><a href="#cb194-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">43.15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-856"><a href="#cb194-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tempResponse</span>(<span class="at">Start_JDay =</span> <span class="dv">91</span>,</span>
<span id="cb194-857"><a href="#cb194-857" aria-hidden="true" tabindex="-1"></a>               <span class="at">End_JDay =</span> <span class="dv">120</span>,</span>
<span id="cb194-858"><a href="#cb194-858" aria-hidden="true" tabindex="-1"></a>               <span class="at">models=</span><span class="fu">list</span>(<span class="at">Frost =</span> freezing_hours,</span>
<span id="cb194-859"><a href="#cb194-859" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Chill_portions =</span> Dynamic_Model,</span>
<span id="cb194-860"><a href="#cb194-860" aria-hidden="true" tabindex="-1"></a>                           <span class="at">GDH =</span> GDH))</span>
<span id="cb194-861"><a href="#cb194-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-862"><a href="#cb194-862" aria-hidden="true" tabindex="-1"></a>chill_comparison <span class="ot">&lt;-</span></span>
<span id="cb194-863"><a href="#cb194-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(chill_observed,</span>
<span id="cb194-864"><a href="#cb194-864" aria-hidden="true" tabindex="-1"></a>        <span class="at">Data_source =</span> <span class="st">"observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-865"><a href="#cb194-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">cbind</span>(chill_simulated,</span>
<span id="cb194-866"><a href="#cb194-866" aria-hidden="true" tabindex="-1"></a>              <span class="at">Data_source =</span> <span class="st">"simulated"</span>))</span>
<span id="cb194-867"><a href="#cb194-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-868"><a href="#cb194-868" aria-hidden="true" tabindex="-1"></a>chill_comparison_full_seasons <span class="ot">&lt;-</span></span>
<span id="cb194-869"><a href="#cb194-869" aria-hidden="true" tabindex="-1"></a>  chill_comparison <span class="sc">%&gt;%</span></span>
<span id="cb194-870"><a href="#cb194-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb194-871"><a href="#cb194-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-872"><a href="#cb194-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-875"><a href="#cb194-875" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-876"><a href="#cb194-876" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chill_comparison_full_seasons,</span>
<span id="cb194-877"><a href="#cb194-877" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Frost)) <span class="sc">+</span> </span>
<span id="cb194-878"><a href="#cb194-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">25</span>,</span>
<span id="cb194-879"><a href="#cb194-879" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Data_source))) <span class="sc">+</span></span>
<span id="cb194-880"><a href="#cb194-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-881"><a href="#cb194-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Data source"</span>) <span class="sc">+</span></span>
<span id="cb194-882"><a href="#cb194-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Frost incidence during April (hours)"</span>) <span class="sc">+</span></span>
<span id="cb194-883"><a href="#cb194-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>)</span>
<span id="cb194-884"><a href="#cb194-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-887"><a href="#cb194-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-888"><a href="#cb194-888" aria-hidden="true" tabindex="-1"></a>chill_simulations <span class="ot">&lt;-</span></span>
<span id="cb194-889"><a href="#cb194-889" aria-hidden="true" tabindex="-1"></a>  chill_comparison_full_seasons <span class="sc">%&gt;%</span></span>
<span id="cb194-890"><a href="#cb194-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">"simulated"</span>)</span>
<span id="cb194-891"><a href="#cb194-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-892"><a href="#cb194-892" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chill_simulations,</span>
<span id="cb194-893"><a href="#cb194-893" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Frost)) <span class="sc">+</span></span>
<span id="cb194-894"><a href="#cb194-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">"step"</span>,</span>
<span id="cb194-895"><a href="#cb194-895" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb194-896"><a href="#cb194-896" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb194-897"><a href="#cb194-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative probability"</span>) <span class="sc">+</span></span>
<span id="cb194-898"><a href="#cb194-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Frost incidence during April (hours)"</span>) <span class="sc">+</span></span>
<span id="cb194-899"><a href="#cb194-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span>
<span id="cb194-900"><a href="#cb194-900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-901"><a href="#cb194-901" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-902"><a href="#cb194-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-903"><a href="#cb194-903" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 14: Generating historic temperature scenarios</span></span>
<span id="cb194-904"><a href="#cb194-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-905"><a href="#cb194-905" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on historic temperature scenarios*** </span></span>
<span id="cb194-906"><a href="#cb194-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-907"><a href="#cb194-907" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>For the location you chose for previous exercises, produce historic temperature scenarios representing several years of the historic record (your choice).</span>
<span id="cb194-908"><a href="#cb194-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-911"><a href="#cb194-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-912"><a href="#cb194-912" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb194-913"><a href="#cb194-913" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb194-914"><a href="#cb194-914" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(kableExtra)</span>
<span id="cb194-915"><a href="#cb194-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-916"><a href="#cb194-916" aria-hidden="true" tabindex="-1"></a><span class="co"># downloading weather station list for the vicinity of Rochester</span></span>
<span id="cb194-917"><a href="#cb194-917" aria-hidden="true" tabindex="-1"></a>station_list <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">"list_stations"</span>,</span>
<span id="cb194-918"><a href="#cb194-918" aria-hidden="true" tabindex="-1"></a>                            <span class="at">location=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span>))</span>
<span id="cb194-919"><a href="#cb194-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-920"><a href="#cb194-920" aria-hidden="true" tabindex="-1"></a><span class="co"># downloading weather data for Greater Rochester International AP and convert it to chillR format</span></span>
<span id="cb194-921"><a href="#cb194-921" aria-hidden="true" tabindex="-1"></a>Rochester_weather <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">"download_weather"</span>,</span>
<span id="cb194-922"><a href="#cb194-922" aria-hidden="true" tabindex="-1"></a>                            <span class="at">location =</span> station_list<span class="sc">$</span>chillR_code[<span class="dv">1</span>],</span>
<span id="cb194-923"><a href="#cb194-923" aria-hidden="true" tabindex="-1"></a>                            <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1973</span>,<span class="dv">2019</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb194-924"><a href="#cb194-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">handle_gsod</span>()</span>
<span id="cb194-925"><a href="#cb194-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-926"><a href="#cb194-926" aria-hidden="true" tabindex="-1"></a><span class="co"># check record for missing data</span></span>
<span id="cb194-927"><a href="#cb194-927" aria-hidden="true" tabindex="-1"></a><span class="fu">fix_weather</span>(Rochester_weather<span class="sc">$</span><span class="st">'GREATER ROCHESTER INTERNATIONAL AP'</span>)<span class="sc">$</span>QC</span>
<span id="cb194-928"><a href="#cb194-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-929"><a href="#cb194-929" aria-hidden="true" tabindex="-1"></a>Rochester_patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(</span>
<span id="cb194-930"><a href="#cb194-930" aria-hidden="true" tabindex="-1"></a>  <span class="at">weather =</span> Rochester_weather<span class="sc">$</span><span class="st">'GREATER ROCHESTER INTERNATIONAL AP'</span>,</span>
<span id="cb194-931"><a href="#cb194-931" aria-hidden="true" tabindex="-1"></a>  <span class="at">patch_weather =</span> <span class="fu">list</span>(KA_weather))</span>
<span id="cb194-932"><a href="#cb194-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-933"><a href="#cb194-933" aria-hidden="true" tabindex="-1"></a><span class="fu">fix_weather</span>(Rochester_patched)<span class="sc">$</span>QC</span>
<span id="cb194-934"><a href="#cb194-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-935"><a href="#cb194-935" aria-hidden="true" tabindex="-1"></a><span class="co"># interpolating these gaps now</span></span>
<span id="cb194-936"><a href="#cb194-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-937"><a href="#cb194-937" aria-hidden="true" tabindex="-1"></a>Rochester<span class="ot">&lt;-</span><span class="fu">fix_weather</span>(Rochester_patched)</span>
<span id="cb194-938"><a href="#cb194-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-939"><a href="#cb194-939" aria-hidden="true" tabindex="-1"></a>Rochester_temps<span class="ot">&lt;-</span>Rochester<span class="sc">$</span>weather</span>
<span id="cb194-940"><a href="#cb194-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-941"><a href="#cb194-941" aria-hidden="true" tabindex="-1"></a>scenario_1980 <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(<span class="at">weather =</span> Rochester_temps,</span>
<span id="cb194-942"><a href="#cb194-942" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">year =</span> <span class="dv">1980</span>)</span>
<span id="cb194-943"><a href="#cb194-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-944"><a href="#cb194-944" aria-hidden="true" tabindex="-1"></a>scenario_1980<span class="sc">$</span><span class="st">'1980'</span><span class="sc">$</span>data</span>
<span id="cb194-945"><a href="#cb194-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-946"><a href="#cb194-946" aria-hidden="true" tabindex="-1"></a><span class="co">#what could have happened in 1980 not what happpened</span></span>
<span id="cb194-947"><a href="#cb194-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-948"><a href="#cb194-948" aria-hidden="true" tabindex="-1"></a>temps_1980 <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(<span class="at">weather =</span> Rochester_temps,</span>
<span id="cb194-949"><a href="#cb194-949" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2019</span>),</span>
<span id="cb194-950"><a href="#cb194-950" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2100</span>),</span>
<span id="cb194-951"><a href="#cb194-951" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">temperature_scenario =</span> scenario_1980)</span>
<span id="cb194-952"><a href="#cb194-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-953"><a href="#cb194-953" aria-hidden="true" tabindex="-1"></a>scenario_1996 <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(<span class="at">weather =</span> Rochester_temps,</span>
<span id="cb194-954"><a href="#cb194-954" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">year =</span> <span class="dv">1996</span>)</span>
<span id="cb194-955"><a href="#cb194-955" aria-hidden="true" tabindex="-1"></a>scenario_1996<span class="sc">$</span><span class="st">'1996'</span><span class="sc">$</span>data</span>
<span id="cb194-956"><a href="#cb194-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-957"><a href="#cb194-957" aria-hidden="true" tabindex="-1"></a>relative_scenario <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_baseline_adjustment</span>(</span>
<span id="cb194-958"><a href="#cb194-958" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline =</span> scenario_1996,</span>
<span id="cb194-959"><a href="#cb194-959" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature_scenario =</span> scenario_1980)</span>
<span id="cb194-960"><a href="#cb194-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-961"><a href="#cb194-961" aria-hidden="true" tabindex="-1"></a><span class="co"># error message here</span></span>
<span id="cb194-962"><a href="#cb194-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-963"><a href="#cb194-963" aria-hidden="true" tabindex="-1"></a>temps_1980 <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(<span class="at">weather =</span> Rochester_temps,</span>
<span id="cb194-964"><a href="#cb194-964" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2019</span>),</span>
<span id="cb194-965"><a href="#cb194-965" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2100</span>),</span>
<span id="cb194-966"><a href="#cb194-966" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">temperature_scenario =</span> relative_scenario)</span>
<span id="cb194-967"><a href="#cb194-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-968"><a href="#cb194-968" aria-hidden="true" tabindex="-1"></a>all_past_scenarios <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(</span>
<span id="cb194-969"><a href="#cb194-969" aria-hidden="true" tabindex="-1"></a>  <span class="at">weather =</span> Rochester_temps,</span>
<span id="cb194-970"><a href="#cb194-970" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">1980</span>,</span>
<span id="cb194-971"><a href="#cb194-971" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1990</span>,</span>
<span id="cb194-972"><a href="#cb194-972" aria-hidden="true" tabindex="-1"></a>           <span class="dv">2000</span>,</span>
<span id="cb194-973"><a href="#cb194-973" aria-hidden="true" tabindex="-1"></a>           <span class="dv">2010</span>))</span>
<span id="cb194-974"><a href="#cb194-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-975"><a href="#cb194-975" aria-hidden="true" tabindex="-1"></a>adjusted_scenarios <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_baseline_adjustment</span>(</span>
<span id="cb194-976"><a href="#cb194-976" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline =</span> scenario_1996,</span>
<span id="cb194-977"><a href="#cb194-977" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature_scenario =</span> all_past_scenarios)</span>
<span id="cb194-978"><a href="#cb194-978" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-979"><a href="#cb194-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-980"><a href="#cb194-980" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb194-981"><a href="#cb194-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-982"><a href="#cb194-982" aria-hidden="true" tabindex="-1"></a><span class="in">all_past_scenario_temps &lt;- temperature_generation(</span></span>
<span id="cb194-983"><a href="#cb194-983" aria-hidden="true" tabindex="-1"></a><span class="in">  weather = Rochester_temps,</span></span>
<span id="cb194-984"><a href="#cb194-984" aria-hidden="true" tabindex="-1"></a><span class="in">  years = c(1973,2019),</span></span>
<span id="cb194-985"><a href="#cb194-985" aria-hidden="true" tabindex="-1"></a><span class="in">  sim_years = c(2001,2100),</span></span>
<span id="cb194-986"><a href="#cb194-986" aria-hidden="true" tabindex="-1"></a><span class="in">  temperature_scenario = adjusted_scenarios)</span></span>
<span id="cb194-987"><a href="#cb194-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-988"><a href="#cb194-988" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-989"><a href="#cb194-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-990"><a href="#cb194-990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE, echo=FALSE}</span></span>
<span id="cb194-991"><a href="#cb194-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-992"><a href="#cb194-992" aria-hidden="true" tabindex="-1"></a><span class="in">save_temperature_scenarios(all_past_scenario_temps,"data_New_York","all_past_temps")</span></span>
<span id="cb194-993"><a href="#cb194-993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-994"><a href="#cb194-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-995"><a href="#cb194-995" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb194-996"><a href="#cb194-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-997"><a href="#cb194-997" aria-hidden="true" tabindex="-1"></a><span class="in">all_past_scenario_temps &lt;- load_temperature_scenarios("data_New_York","all_past_temps")</span></span>
<span id="cb194-998"><a href="#cb194-998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb194-999"><a href="#cb194-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1002"><a href="#cb194-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-1003"><a href="#cb194-1003" aria-hidden="true" tabindex="-1"></a>frost_model <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb194-1004"><a href="#cb194-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_model</span>(x,</span>
<span id="cb194-1005"><a href="#cb194-1005" aria-hidden="true" tabindex="-1"></a>             <span class="fu">data.frame</span>(</span>
<span id="cb194-1006"><a href="#cb194-1006" aria-hidden="true" tabindex="-1"></a>               <span class="at">lower=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="dv">0</span>),</span>
<span id="cb194-1007"><a href="#cb194-1007" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>),</span>
<span id="cb194-1008"><a href="#cb194-1008" aria-hidden="true" tabindex="-1"></a>               <span class="at">weight=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb194-1009"><a href="#cb194-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1010"><a href="#cb194-1010" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Chill_Portions =</span> Dynamic_Model,</span>
<span id="cb194-1011"><a href="#cb194-1011" aria-hidden="true" tabindex="-1"></a>               <span class="at">GDH =</span> GDH,</span>
<span id="cb194-1012"><a href="#cb194-1012" aria-hidden="true" tabindex="-1"></a>               <span class="at">Frost_H =</span> frost_model)</span>
<span id="cb194-1013"><a href="#cb194-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1014"><a href="#cb194-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1015"><a href="#cb194-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1016"><a href="#cb194-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1017"><a href="#cb194-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1018"><a href="#cb194-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1019"><a href="#cb194-1019" aria-hidden="true" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">tempResponse_daily_list</span>(all_past_scenario_temps,</span>
<span id="cb194-1020"><a href="#cb194-1020" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">latitude =</span> <span class="fl">43.15</span>,</span>
<span id="cb194-1021"><a href="#cb194-1021" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb194-1022"><a href="#cb194-1022" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb194-1023"><a href="#cb194-1023" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">models =</span> models)</span>
<span id="cb194-1024"><a href="#cb194-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1025"><a href="#cb194-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1026"><a href="#cb194-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Produce chill distributions for these scenarios and plot them.</span>
<span id="cb194-1027"><a href="#cb194-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1030"><a href="#cb194-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-1031"><a href="#cb194-1031" aria-hidden="true" tabindex="-1"></a>scenarios <span class="ot">&lt;-</span> <span class="fu">names</span>(chill_hist_scenario_list)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb194-1032"><a href="#cb194-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1033"><a href="#cb194-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1034"><a href="#cb194-1034" aria-hidden="true" tabindex="-1"></a>all_scenarios <span class="ot">&lt;-</span> chill_hist_scenario_list[[scenarios[<span class="dv">1</span>]]] <span class="sc">%&gt;%</span></span>
<span id="cb194-1035"><a href="#cb194-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scenario =</span> <span class="fu">as.numeric</span>(scenarios[<span class="dv">1</span>]))</span>
<span id="cb194-1036"><a href="#cb194-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1037"><a href="#cb194-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1038"><a href="#cb194-1038" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sc <span class="cf">in</span> scenarios[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb194-1039"><a href="#cb194-1039" aria-hidden="true" tabindex="-1"></a> all_scenarios <span class="ot">&lt;-</span> all_scenarios <span class="sc">%&gt;%</span></span>
<span id="cb194-1040"><a href="#cb194-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(chill_hist_scenario_list[[sc]] <span class="sc">%&gt;%</span></span>
<span id="cb194-1041"><a href="#cb194-1041" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cbind</span>(</span>
<span id="cb194-1042"><a href="#cb194-1042" aria-hidden="true" tabindex="-1"></a>            <span class="at">scenario=</span><span class="fu">as.numeric</span>(sc))</span>
<span id="cb194-1043"><a href="#cb194-1043" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb194-1044"><a href="#cb194-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb194-1045"><a href="#cb194-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1046"><a href="#cb194-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's compute the actual 'observed' chill for comparison</span></span>
<span id="cb194-1047"><a href="#cb194-1047" aria-hidden="true" tabindex="-1"></a>actual_chill <span class="ot">&lt;-</span> <span class="fu">tempResponse_daily_list</span>(Rochester_temps,</span>
<span id="cb194-1048"><a href="#cb194-1048" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">latitude =</span> <span class="fl">43.15</span>,</span>
<span id="cb194-1049"><a href="#cb194-1049" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb194-1050"><a href="#cb194-1050" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb194-1051"><a href="#cb194-1051" aria-hidden="true" tabindex="-1"></a>                                        models)[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb194-1052"><a href="#cb194-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb194-1053"><a href="#cb194-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1054"><a href="#cb194-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> all_scenarios,</span>
<span id="cb194-1055"><a href="#cb194-1055" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(scenario,</span>
<span id="cb194-1056"><a href="#cb194-1056" aria-hidden="true" tabindex="-1"></a>           Chill_Portions,</span>
<span id="cb194-1057"><a href="#cb194-1057" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">factor</span>(scenario))) <span class="sc">+</span></span>
<span id="cb194-1058"><a href="#cb194-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb194-1059"><a href="#cb194-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Chill accumulation (Chill Portions)"</span>) <span class="sc">+</span></span>
<span id="cb194-1060"><a href="#cb194-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Scenario year"</span>) <span class="sc">+</span></span>
<span id="cb194-1061"><a href="#cb194-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-1062"><a href="#cb194-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb194-1063"><a href="#cb194-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> actual_chill,</span>
<span id="cb194-1064"><a href="#cb194-1064" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(End_year,</span>
<span id="cb194-1065"><a href="#cb194-1065" aria-hidden="true" tabindex="-1"></a>                 Chill_Portions,</span>
<span id="cb194-1066"><a href="#cb194-1066" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"blue"</span>),</span>
<span id="cb194-1067"><a href="#cb194-1067" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb194-1068"><a href="#cb194-1068" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb194-1069"><a href="#cb194-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">"Scenario"</span>,</span>
<span id="cb194-1070"><a href="#cb194-1070" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">unique</span>(all_scenarios<span class="sc">$</span>scenario)) </span>
<span id="cb194-1071"><a href="#cb194-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1072"><a href="#cb194-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1073"><a href="#cb194-1073" aria-hidden="true" tabindex="-1"></a>temperature_means <span class="ot">&lt;-</span> </span>
<span id="cb194-1074"><a href="#cb194-1074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Year =</span> <span class="fu">min</span>(Rochester_temps<span class="sc">$</span>Year)<span class="sc">:</span><span class="fu">max</span>(Rochester_temps<span class="sc">$</span>Year),</span>
<span id="cb194-1075"><a href="#cb194-1075" aria-hidden="true" tabindex="-1"></a>             <span class="at">Tmin =</span> <span class="fu">aggregate</span>(Rochester_temps<span class="sc">$</span>Tmin,</span>
<span id="cb194-1076"><a href="#cb194-1076" aria-hidden="true" tabindex="-1"></a>                              <span class="at">FUN =</span> <span class="st">"mean"</span>,</span>
<span id="cb194-1077"><a href="#cb194-1077" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="fu">list</span>(Rochester_temps<span class="sc">$</span>Year))[,<span class="dv">2</span>],</span>
<span id="cb194-1078"><a href="#cb194-1078" aria-hidden="true" tabindex="-1"></a>             <span class="at">Tmax=</span><span class="fu">aggregate</span>(Rochester_temps<span class="sc">$</span>Tmax,</span>
<span id="cb194-1079"><a href="#cb194-1079" aria-hidden="true" tabindex="-1"></a>                            <span class="at">FUN =</span> <span class="st">"mean"</span>,</span>
<span id="cb194-1080"><a href="#cb194-1080" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="fu">list</span>(Rochester_temps<span class="sc">$</span>Year))[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb194-1081"><a href="#cb194-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">runn_mean_Tmin =</span> <span class="fu">runn_mean</span>(Tmin,<span class="dv">15</span>),</span>
<span id="cb194-1082"><a href="#cb194-1082" aria-hidden="true" tabindex="-1"></a>         <span class="at">runn_mean_Tmax =</span> <span class="fu">runn_mean</span>(Tmax,<span class="dv">15</span>))</span>
<span id="cb194-1083"><a href="#cb194-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1084"><a href="#cb194-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1085"><a href="#cb194-1085" aria-hidden="true" tabindex="-1"></a>Tmin_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(Tmin <span class="sc">~</span> Year,</span>
<span id="cb194-1086"><a href="#cb194-1086" aria-hidden="true" tabindex="-1"></a>                      temperature_means)</span>
<span id="cb194-1087"><a href="#cb194-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1088"><a href="#cb194-1088" aria-hidden="true" tabindex="-1"></a>Tmax_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(Tmax <span class="sc">~</span> Year,</span>
<span id="cb194-1089"><a href="#cb194-1089" aria-hidden="true" tabindex="-1"></a>                      temperature_means)</span>
<span id="cb194-1090"><a href="#cb194-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1091"><a href="#cb194-1091" aria-hidden="true" tabindex="-1"></a>temperature_means <span class="ot">&lt;-</span> temperature_means <span class="sc">%&gt;%</span></span>
<span id="cb194-1092"><a href="#cb194-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">regression_Tmin =</span> Tmin_regression<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb194-1093"><a href="#cb194-1093" aria-hidden="true" tabindex="-1"></a>           Tmin_regression<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>temperature_means<span class="sc">$</span>Year,</span>
<span id="cb194-1094"><a href="#cb194-1094" aria-hidden="true" tabindex="-1"></a>         <span class="at">regression_Tmax =</span> Tmax_regression<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb194-1095"><a href="#cb194-1095" aria-hidden="true" tabindex="-1"></a>           Tmax_regression<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>temperature_means<span class="sc">$</span>Year</span>
<span id="cb194-1096"><a href="#cb194-1096" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb194-1097"><a href="#cb194-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1098"><a href="#cb194-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1099"><a href="#cb194-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(temperature_means,</span>
<span id="cb194-1100"><a href="#cb194-1100" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(Year,</span>
<span id="cb194-1101"><a href="#cb194-1101" aria-hidden="true" tabindex="-1"></a>           Tmin)) <span class="sc">+</span> </span>
<span id="cb194-1102"><a href="#cb194-1102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb194-1103"><a href="#cb194-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb194-1104"><a href="#cb194-1104" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb194-1105"><a href="#cb194-1105" aria-hidden="true" tabindex="-1"></a>                runn_mean_Tmin),</span>
<span id="cb194-1106"><a href="#cb194-1106" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb194-1107"><a href="#cb194-1107" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb194-1108"><a href="#cb194-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb194-1109"><a href="#cb194-1109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb194-1110"><a href="#cb194-1110" aria-hidden="true" tabindex="-1"></a>                regression_Tmin),</span>
<span id="cb194-1111"><a href="#cb194-1111" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb194-1112"><a href="#cb194-1112" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb194-1113"><a href="#cb194-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb194-1114"><a href="#cb194-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean monthly minimum temperature (Â°C)"</span>)</span>
<span id="cb194-1115"><a href="#cb194-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1116"><a href="#cb194-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(temperature_means,</span>
<span id="cb194-1117"><a href="#cb194-1117" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(Year,</span>
<span id="cb194-1118"><a href="#cb194-1118" aria-hidden="true" tabindex="-1"></a>           Tmax)) <span class="sc">+</span> </span>
<span id="cb194-1119"><a href="#cb194-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb194-1120"><a href="#cb194-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb194-1121"><a href="#cb194-1121" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb194-1122"><a href="#cb194-1122" aria-hidden="true" tabindex="-1"></a>                runn_mean_Tmax),</span>
<span id="cb194-1123"><a href="#cb194-1123" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb194-1124"><a href="#cb194-1124" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb194-1125"><a href="#cb194-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb194-1126"><a href="#cb194-1126" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(Year, </span>
<span id="cb194-1127"><a href="#cb194-1127" aria-hidden="true" tabindex="-1"></a>                regression_Tmax),</span>
<span id="cb194-1128"><a href="#cb194-1128" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb194-1129"><a href="#cb194-1129" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb194-1130"><a href="#cb194-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb194-1131"><a href="#cb194-1131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean monthly maximum temperature (Â°C)"</span>)</span>
<span id="cb194-1132"><a href="#cb194-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1133"><a href="#cb194-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1134"><a href="#cb194-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1135"><a href="#cb194-1135" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-1136"><a href="#cb194-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1137"><a href="#cb194-1137" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb194-1138"><a href="#cb194-1138" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 15: Future temperature scenarios</span></span>
<span id="cb194-1139"><a href="#cb194-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1140"><a href="#cb194-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on future temperature scenarios** </span></span>
<span id="cb194-1141"><a href="#cb194-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1142"><a href="#cb194-1142" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Briefly describe the differences between the RCPs and the SSPs.</span>
<span id="cb194-1143"><a href="#cb194-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1144"><a href="#cb194-1144" aria-hidden="true" tabindex="-1"></a>Representative Concentration Pathways (RCPs) are climate change scenarios to project future greenhouse gas concentrations.These pathways (or trajectories) describe future greenhouse gas concentrations (not emissions) and have been formally adopted by the IPCC. The pathways describe different climate change scenarios, all of which were considered possible depending on the amount of greenhouse gases (GHG) emitted in the years to come. </span>
<span id="cb194-1145"><a href="#cb194-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1146"><a href="#cb194-1146" aria-hidden="true" tabindex="-1"></a>Shared Socioeconomic Pathways (SSPs) are climate change scenarios of projected socioeconomic global changes up to 2100 as defined in the IPCC Sixth Assessment Report on climate change in 2021.The SRES scenarios are "baseline" (or "reference") scenarios, which means that they do not take into account any current or future measures to limit greenhouse gas (GHG) emissions.</span>
<span id="cb194-1147"><a href="#cb194-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1148"><a href="#cb194-1148" aria-hidden="true" tabindex="-1"></a>A major difference between both models is that RCPs focus on Emissions and Radiative Forcing while SSPs emphasize Socioeconomic Pathways.In phenology SSPs integrate societal drivers, allowing phenologists to link temperature scenarios with land use changes, habitat fragmentation, or conservation efforts.</span>
<span id="cb194-1149"><a href="#cb194-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1150"><a href="#cb194-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1151"><a href="#cb194-1151" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 16: Generating CMIP6 temperature scenarios</span></span>
<span id="cb194-1152"><a href="#cb194-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1153"><a href="#cb194-1153" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on generating CMIP6 temperature scenarios*** </span></span>
<span id="cb194-1154"><a href="#cb194-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1155"><a href="#cb194-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Analyze the historic and future impact of climate change on two agroclimatic metrics of your choice, for the location youâve chosen for your earlier analyses.</span>
<span id="cb194-1156"><a href="#cb194-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1159"><a href="#cb194-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-1160"><a href="#cb194-1160" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(chillR)</span>
<span id="cb194-1161"><a href="#cb194-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb194-1162"><a href="#cb194-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecmwfr)</span>
<span id="cb194-1163"><a href="#cb194-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb194-1164"><a href="#cb194-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1165"><a href="#cb194-1165" aria-hidden="true" tabindex="-1"></a><span class="co">#read Rochester_temps</span></span>
<span id="cb194-1166"><a href="#cb194-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1167"><a href="#cb194-1167" aria-hidden="true" tabindex="-1"></a>Rochester_temps <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_temps.csv"</span>)</span>
<span id="cb194-1168"><a href="#cb194-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1169"><a href="#cb194-1169" aria-hidden="true" tabindex="-1"></a>location<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span>) <span class="co">#Rochester</span></span>
<span id="cb194-1170"><a href="#cb194-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1171"><a href="#cb194-1171" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="sc">-</span><span class="dv">79</span>, <span class="dv">40</span>, <span class="sc">-</span><span class="dv">71</span>)</span>
<span id="cb194-1172"><a href="#cb194-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1173"><a href="#cb194-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1174"><a href="#cb194-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">download_cmip6_ecmwfr</span>(</span>
<span id="cb194-1175"><a href="#cb194-1175" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenarios =</span> <span class="fu">c</span>(<span class="st">"ssp126"</span>, <span class="st">"ssp245"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span>),</span>
<span id="cb194-1176"><a href="#cb194-1176" aria-hidden="true" tabindex="-1"></a>  <span class="at">area =</span> area,</span>
<span id="cb194-1177"><a href="#cb194-1177" aria-hidden="true" tabindex="-1"></a>  <span class="at">key =</span> <span class="st">'e1bd6995-c569-4df1-bbe8-3549cb586e4a'</span>,</span>
<span id="cb194-1178"><a href="#cb194-1178" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">'default'</span>,</span>
<span id="cb194-1179"><a href="#cb194-1179" aria-hidden="true" tabindex="-1"></a>  <span class="at">frequency =</span> <span class="st">'monthly'</span>,</span>
<span id="cb194-1180"><a href="#cb194-1180" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">'Tmin'</span>,  <span class="st">'Tmax'</span>),</span>
<span id="cb194-1181"><a href="#cb194-1181" aria-hidden="true" tabindex="-1"></a>  <span class="at">year_start =</span> <span class="dv">2015</span>,</span>
<span id="cb194-1182"><a href="#cb194-1182" aria-hidden="true" tabindex="-1"></a>  <span class="at">year_end =</span> <span class="dv">2100</span>)</span>
<span id="cb194-1183"><a href="#cb194-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1184"><a href="#cb194-1184" aria-hidden="true" tabindex="-1"></a><span class="fu">download_baseline_cmip6_ecmwfr</span>(</span>
<span id="cb194-1185"><a href="#cb194-1185" aria-hidden="true" tabindex="-1"></a>  <span class="at">area =</span> area,</span>
<span id="cb194-1186"><a href="#cb194-1186" aria-hidden="true" tabindex="-1"></a>  <span class="at">key =</span> <span class="st">'e1bd6995-c569-4df1-bbe8-3549cb586e4a'</span>,</span>
<span id="cb194-1187"><a href="#cb194-1187" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">'match_downloaded'</span>,</span>
<span id="cb194-1188"><a href="#cb194-1188" aria-hidden="true" tabindex="-1"></a>  <span class="at">frequency =</span> <span class="st">'monthly'</span>,</span>
<span id="cb194-1189"><a href="#cb194-1189" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">'Tmin'</span>, <span class="st">'Tmax'</span>),</span>
<span id="cb194-1190"><a href="#cb194-1190" aria-hidden="true" tabindex="-1"></a>  <span class="at">year_start =</span> <span class="dv">1986</span>, </span>
<span id="cb194-1191"><a href="#cb194-1191" aria-hidden="true" tabindex="-1"></a>  <span class="at">year_end =</span> <span class="dv">2014</span>, </span>
<span id="cb194-1192"><a href="#cb194-1192" aria-hidden="true" tabindex="-1"></a>  <span class="at">month =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb194-1193"><a href="#cb194-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1194"><a href="#cb194-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">download_baseline_cmip6_ecmwfr</span>(</span>
<span id="cb194-1195"><a href="#cb194-1195" aria-hidden="true" tabindex="-1"></a>  <span class="at">area =</span> area,</span>
<span id="cb194-1196"><a href="#cb194-1196" aria-hidden="true" tabindex="-1"></a>  <span class="at">key =</span> <span class="st">'e1bd6995-c569-4df1-bbe8-3549cb586e4a'</span>,</span>
<span id="cb194-1197"><a href="#cb194-1197" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">'match_downloaded'</span>,</span>
<span id="cb194-1198"><a href="#cb194-1198" aria-hidden="true" tabindex="-1"></a>  <span class="at">frequency =</span> <span class="st">'monthly'</span>,</span>
<span id="cb194-1199"><a href="#cb194-1199" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">'Tmin'</span>, <span class="st">'Tmax'</span>),</span>
<span id="cb194-1200"><a href="#cb194-1200" aria-hidden="true" tabindex="-1"></a>  <span class="at">year_start =</span> <span class="dv">1986</span>,</span>
<span id="cb194-1201"><a href="#cb194-1201" aria-hidden="true" tabindex="-1"></a>  <span class="at">year_end =</span> <span class="dv">2014</span>,</span>
<span id="cb194-1202"><a href="#cb194-1202" aria-hidden="true" tabindex="-1"></a>  <span class="at">month =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb194-1203"><a href="#cb194-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1204"><a href="#cb194-1204" aria-hidden="true" tabindex="-1"></a>station <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb194-1205"><a href="#cb194-1205" aria-hidden="true" tabindex="-1"></a>  <span class="at">station_name =</span> <span class="fu">c</span>(<span class="st">"Rochester"</span>),</span>
<span id="cb194-1206"><a href="#cb194-1206" aria-hidden="true" tabindex="-1"></a>  <span class="at">longitude =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.60</span>),</span>
<span id="cb194-1207"><a href="#cb194-1207" aria-hidden="true" tabindex="-1"></a>  <span class="at">latitude =</span> <span class="fu">c</span>(<span class="fl">43.15</span>))</span>
<span id="cb194-1208"><a href="#cb194-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1209"><a href="#cb194-1209" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ncdf4)</span>
<span id="cb194-1210"><a href="#cb194-1210" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PCICt)</span>
<span id="cb194-1211"><a href="#cb194-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1212"><a href="#cb194-1212" aria-hidden="true" tabindex="-1"></a>extracted <span class="ot">&lt;-</span> <span class="fu">extract_cmip6_data</span>(<span class="at">stations =</span> station)</span>
<span id="cb194-1213"><a href="#cb194-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1214"><a href="#cb194-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(extracted<span class="sc">$</span><span class="st">`</span><span class="at">ssp126_AWI-CM-1-1-MR</span><span class="st">`</span>)</span>
<span id="cb194-1215"><a href="#cb194-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1216"><a href="#cb194-1216" aria-hidden="true" tabindex="-1"></a>change_scenarios <span class="ot">&lt;-</span> </span>
<span id="cb194-1217"><a href="#cb194-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_rel_change_scenario</span>(extracted,</span>
<span id="cb194-1218"><a href="#cb194-1218" aria-hidden="true" tabindex="-1"></a>                          <span class="at">scenarios =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>),</span>
<span id="cb194-1219"><a href="#cb194-1219" aria-hidden="true" tabindex="-1"></a>                          <span class="at">reference_period =</span> <span class="fu">c</span>(<span class="dv">1986</span><span class="sc">:</span><span class="dv">2014</span>),</span>
<span id="cb194-1220"><a href="#cb194-1220" aria-hidden="true" tabindex="-1"></a>                          <span class="at">future_window_width =</span> <span class="dv">30</span>)</span>
<span id="cb194-1221"><a href="#cb194-1221" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(change_scenarios)</span>
<span id="cb194-1222"><a href="#cb194-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1223"><a href="#cb194-1223" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(change_scenarios, <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/all_change_scenarios.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb194-1224"><a href="#cb194-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1225"><a href="#cb194-1225" aria-hidden="true" tabindex="-1"></a>change_scenarios <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/all_change_scenarios.csv"</span>)</span>
<span id="cb194-1226"><a href="#cb194-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1227"><a href="#cb194-1227" aria-hidden="true" tabindex="-1"></a>scen_list <span class="ot">&lt;-</span> <span class="fu">convert_scen_information</span>(change_scenarios)</span>
<span id="cb194-1228"><a href="#cb194-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1229"><a href="#cb194-1229" aria-hidden="true" tabindex="-1"></a>scen_frame <span class="ot">&lt;-</span> <span class="fu">convert_scen_information</span>(scen_list)</span>
<span id="cb194-1230"><a href="#cb194-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1231"><a href="#cb194-1231" aria-hidden="true" tabindex="-1"></a>scen_list<span class="sc">$</span>Rochester<span class="sc">$</span>ssp126<span class="sc">$</span><span class="st">`</span><span class="at">ACCESS-CM2</span><span class="st">`</span><span class="sc">$</span><span class="st">'2050'</span></span>
<span id="cb194-1232"><a href="#cb194-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1233"><a href="#cb194-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1234"><a href="#cb194-1234" aria-hidden="true" tabindex="-1"></a>temps_1996 <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(Rochester_temps,</span>
<span id="cb194-1235"><a href="#cb194-1235" aria-hidden="true" tabindex="-1"></a>                                                <span class="dv">1996</span>)</span>
<span id="cb194-1236"><a href="#cb194-1236" aria-hidden="true" tabindex="-1"></a>temps_2000 <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(Rochester_temps,</span>
<span id="cb194-1237"><a href="#cb194-1237" aria-hidden="true" tabindex="-1"></a>                                                <span class="dv">2000</span>)</span>
<span id="cb194-1238"><a href="#cb194-1238" aria-hidden="true" tabindex="-1"></a>temps_1996</span>
<span id="cb194-1239"><a href="#cb194-1239" aria-hidden="true" tabindex="-1"></a>temps_2000</span>
<span id="cb194-1240"><a href="#cb194-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1241"><a href="#cb194-1241" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_baseline_adjustment</span>(temps_1996,</span>
<span id="cb194-1242"><a href="#cb194-1242" aria-hidden="true" tabindex="-1"></a>                                                 temps_2000)</span>
<span id="cb194-1243"><a href="#cb194-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1244"><a href="#cb194-1244" aria-hidden="true" tabindex="-1"></a>base</span>
<span id="cb194-1245"><a href="#cb194-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1246"><a href="#cb194-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1247"><a href="#cb194-1247" aria-hidden="true" tabindex="-1"></a>scen_list <span class="ot">&lt;-</span> <span class="fu">convert_scen_information</span>(change_scenarios,</span>
<span id="cb194-1248"><a href="#cb194-1248" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">give_structure =</span> <span class="cn">FALSE</span>)</span>
<span id="cb194-1249"><a href="#cb194-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1250"><a href="#cb194-1250" aria-hidden="true" tabindex="-1"></a>adjusted_list <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_baseline_adjustment</span>(base,</span>
<span id="cb194-1251"><a href="#cb194-1251" aria-hidden="true" tabindex="-1"></a>                                                          scen_list,</span>
<span id="cb194-1252"><a href="#cb194-1252" aria-hidden="true" tabindex="-1"></a>                   <span class="at">temperature_check_args =</span> </span>
<span id="cb194-1253"><a href="#cb194-1253" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">list</span>(<span class="at">scenario_check_thresholds =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">15</span>)))</span>
<span id="cb194-1254"><a href="#cb194-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1255"><a href="#cb194-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1256"><a href="#cb194-1256" aria-hidden="true" tabindex="-1"></a><span class="co"># temps &lt;- temperature_generation(Rochester_temps,</span></span>
<span id="cb194-1257"><a href="#cb194-1257" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 years = c(1973, 2019),</span></span>
<span id="cb194-1258"><a href="#cb194-1258" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 sim_years = c(2001, 2100),</span></span>
<span id="cb194-1259"><a href="#cb194-1259" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 adjusted_list,  </span></span>
<span id="cb194-1260"><a href="#cb194-1260" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 temperature_check_args = </span></span>
<span id="cb194-1261"><a href="#cb194-1261" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   list( scenario_check_thresholds = c(-5, 15)))</span></span>
<span id="cb194-1262"><a href="#cb194-1262" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb194-1263"><a href="#cb194-1263" aria-hidden="true" tabindex="-1"></a><span class="co"># save_temperature_scenarios(temps,</span></span>
<span id="cb194-1264"><a href="#cb194-1264" aria-hidden="true" tabindex="-1"></a><span class="co">#                            "data_New_York/future_climate","Rochester_future")</span></span>
<span id="cb194-1265"><a href="#cb194-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1266"><a href="#cb194-1266" aria-hidden="true" tabindex="-1"></a><span class="co"># temps &lt;- load_temperature_scenarios("data_New_Year/future_climate","Rochester_future_")</span></span>
<span id="cb194-1267"><a href="#cb194-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1268"><a href="#cb194-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1269"><a href="#cb194-1269" aria-hidden="true" tabindex="-1"></a><span class="co"># now we have temperature scenarios</span></span>
<span id="cb194-1270"><a href="#cb194-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1271"><a href="#cb194-1271" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(scen <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(adjusted_list))</span>
<span id="cb194-1272"><a href="#cb194-1272" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb194-1273"><a href="#cb194-1273" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">paste0</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate/Rochester_future_"</span>,</span>
<span id="cb194-1274"><a href="#cb194-1274" aria-hidden="true" tabindex="-1"></a>                       scen,<span class="st">"_"</span>,</span>
<span id="cb194-1275"><a href="#cb194-1275" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">names</span>(adjusted_list)[scen],<span class="st">".csv"</span>)) )</span>
<span id="cb194-1276"><a href="#cb194-1276" aria-hidden="true" tabindex="-1"></a>  {temp_temp <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(Rochester_temps,</span>
<span id="cb194-1277"><a href="#cb194-1277" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2019</span>),</span>
<span id="cb194-1278"><a href="#cb194-1278" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2100</span>),</span>
<span id="cb194-1279"><a href="#cb194-1279" aria-hidden="true" tabindex="-1"></a>                                   adjusted_list[scen],  </span>
<span id="cb194-1280"><a href="#cb194-1280" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">temperature_check_args =</span> </span>
<span id="cb194-1281"><a href="#cb194-1281" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">list</span>( <span class="at">scenario_check_thresholds =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">15</span>)))</span>
<span id="cb194-1282"><a href="#cb194-1282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(temp_temp[[<span class="dv">1</span>]],<span class="fu">paste0</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate/Rochester_future_"</span>,scen,<span class="st">"_"</span>,<span class="fu">names</span>(adjusted_list)[scen],<span class="st">".csv"</span>),</span>
<span id="cb194-1283"><a href="#cb194-1283" aria-hidden="true" tabindex="-1"></a>                             <span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb194-1284"><a href="#cb194-1284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Processed object"</span>,scen,<span class="st">"of"</span>, <span class="fu">length</span>(adjusted_list)))</span>
<span id="cb194-1285"><a href="#cb194-1285" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-1286"><a href="#cb194-1286" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-1287"><a href="#cb194-1287" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb194-1288"><a href="#cb194-1288" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-1289"><a href="#cb194-1289" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-1290"><a href="#cb194-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1291"><a href="#cb194-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1292"><a href="#cb194-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1293"><a href="#cb194-1293" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,<span class="st">"Rochester_future_"</span>)</span>
<span id="cb194-1294"><a href="#cb194-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1295"><a href="#cb194-1295" aria-hidden="true" tabindex="-1"></a>frost_model <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb194-1296"><a href="#cb194-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_model</span>(x,</span>
<span id="cb194-1297"><a href="#cb194-1297" aria-hidden="true" tabindex="-1"></a>             <span class="fu">data.frame</span>(</span>
<span id="cb194-1298"><a href="#cb194-1298" aria-hidden="true" tabindex="-1"></a>               <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="dv">0</span>),</span>
<span id="cb194-1299"><a href="#cb194-1299" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>),</span>
<span id="cb194-1300"><a href="#cb194-1300" aria-hidden="true" tabindex="-1"></a>               <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb194-1301"><a href="#cb194-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1302"><a href="#cb194-1302" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Chill_Portions =</span> Dynamic_Model,</span>
<span id="cb194-1303"><a href="#cb194-1303" aria-hidden="true" tabindex="-1"></a>               <span class="at">GDH =</span> GDH,</span>
<span id="cb194-1304"><a href="#cb194-1304" aria-hidden="true" tabindex="-1"></a>               <span class="at">Frost_H =</span> frost_model)</span>
<span id="cb194-1305"><a href="#cb194-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1306"><a href="#cb194-1306" aria-hidden="true" tabindex="-1"></a>chill_future_scenario_list <span class="ot">&lt;-</span> </span>
<span id="cb194-1307"><a href="#cb194-1307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tempResponse_daily_list</span>(temps,</span>
<span id="cb194-1308"><a href="#cb194-1308" aria-hidden="true" tabindex="-1"></a>                          <span class="at">latitude =</span> <span class="fl">43.15</span>,</span>
<span id="cb194-1309"><a href="#cb194-1309" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb194-1310"><a href="#cb194-1310" aria-hidden="true" tabindex="-1"></a>                          <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb194-1311"><a href="#cb194-1311" aria-hidden="true" tabindex="-1"></a>                          <span class="at">models =</span> models)</span>
<span id="cb194-1312"><a href="#cb194-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1313"><a href="#cb194-1313" aria-hidden="true" tabindex="-1"></a>chill_future_scenario_list <span class="ot">&lt;-</span> </span>
<span id="cb194-1314"><a href="#cb194-1314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(chill_future_scenario_list,</span>
<span id="cb194-1315"><a href="#cb194-1315" aria-hidden="true" tabindex="-1"></a>         <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span></span>
<span id="cb194-1316"><a href="#cb194-1316" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>))</span>
<span id="cb194-1317"><a href="#cb194-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1318"><a href="#cb194-1318" aria-hidden="true" tabindex="-1"></a><span class="fu">save_temperature_scenarios</span>(chill_future_scenario_list,</span>
<span id="cb194-1319"><a href="#cb194-1319" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,</span>
<span id="cb194-1320"><a href="#cb194-1320" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Rochester_futurechill"</span>)</span>
<span id="cb194-1321"><a href="#cb194-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1322"><a href="#cb194-1322" aria-hidden="true" tabindex="-1"></a><span class="co"># this would be for spring frost, but we're not running this</span></span>
<span id="cb194-1323"><a href="#cb194-1323" aria-hidden="true" tabindex="-1"></a>chill_future_scenario_list_frost <span class="ot">&lt;-</span> </span>
<span id="cb194-1324"><a href="#cb194-1324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tempResponse_daily_list</span>(temps,</span>
<span id="cb194-1325"><a href="#cb194-1325" aria-hidden="true" tabindex="-1"></a>                          <span class="at">latitude =</span> <span class="fl">43.15</span>,</span>
<span id="cb194-1326"><a href="#cb194-1326" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Start_JDay =</span> <span class="dv">75</span>,</span>
<span id="cb194-1327"><a href="#cb194-1327" aria-hidden="true" tabindex="-1"></a>                          <span class="at">End_JDay =</span> <span class="dv">120</span>,</span>
<span id="cb194-1328"><a href="#cb194-1328" aria-hidden="true" tabindex="-1"></a>                          <span class="at">models =</span> <span class="fu">list</span>(<span class="at">GDH =</span> GDH,</span>
<span id="cb194-1329"><a href="#cb194-1329" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">Frost_H =</span> frost_model))</span>
<span id="cb194-1330"><a href="#cb194-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1331"><a href="#cb194-1331" aria-hidden="true" tabindex="-1"></a>chill_future_scenario_list_frost <span class="ot">&lt;-</span> </span>
<span id="cb194-1332"><a href="#cb194-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(chill_future_scenario_list_frost,</span>
<span id="cb194-1333"><a href="#cb194-1333" aria-hidden="true" tabindex="-1"></a>         <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span></span>
<span id="cb194-1334"><a href="#cb194-1334" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>))</span>
<span id="cb194-1335"><a href="#cb194-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1336"><a href="#cb194-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1337"><a href="#cb194-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">save_temperature_scenarios</span>(chill_future_scenario_list_frost,</span>
<span id="cb194-1338"><a href="#cb194-1338" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,</span>
<span id="cb194-1339"><a href="#cb194-1339" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Rochester_futurefrost"</span>)</span>
<span id="cb194-1340"><a href="#cb194-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1341"><a href="#cb194-1341" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate for the observed record</span></span>
<span id="cb194-1342"><a href="#cb194-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1343"><a href="#cb194-1343" aria-hidden="true" tabindex="-1"></a>Rochester_temps <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_temps.csv"</span>)</span>
<span id="cb194-1344"><a href="#cb194-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1345"><a href="#cb194-1345" aria-hidden="true" tabindex="-1"></a>observed_chill <span class="ot">&lt;-</span> <span class="fu">tempResponse_daily_list</span>(Rochester_temps,</span>
<span id="cb194-1346"><a href="#cb194-1346" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">latitude =</span> <span class="fl">43.15</span>,</span>
<span id="cb194-1347"><a href="#cb194-1347" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb194-1348"><a href="#cb194-1348" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb194-1349"><a href="#cb194-1349" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">models =</span> models)</span>
<span id="cb194-1350"><a href="#cb194-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1351"><a href="#cb194-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(observed_chill, <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_observed_chill_305_59.csv"</span>)</span>
<span id="cb194-1352"><a href="#cb194-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1353"><a href="#cb194-1353" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate chill for historic scenarios</span></span>
<span id="cb194-1354"><a href="#cb194-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1355"><a href="#cb194-1355" aria-hidden="true" tabindex="-1"></a>hist_temps <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York"</span>,<span class="st">"all_past_temps"</span>)</span>
<span id="cb194-1356"><a href="#cb194-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1357"><a href="#cb194-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1358"><a href="#cb194-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1359"><a href="#cb194-1359" aria-hidden="true" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">tempResponse_daily_list</span>(hist_temps,</span>
<span id="cb194-1360"><a href="#cb194-1360" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">latitude =</span> <span class="fl">43.15</span>,</span>
<span id="cb194-1361"><a href="#cb194-1361" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb194-1362"><a href="#cb194-1362" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb194-1363"><a href="#cb194-1363" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">models =</span> models)</span>
<span id="cb194-1364"><a href="#cb194-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1365"><a href="#cb194-1365" aria-hidden="true" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chill_hist_scenario_list,</span>
<span id="cb194-1366"><a href="#cb194-1366" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span></span>
<span id="cb194-1367"><a href="#cb194-1367" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>))</span>
<span id="cb194-1368"><a href="#cb194-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1369"><a href="#cb194-1369" aria-hidden="true" tabindex="-1"></a><span class="fu">save_temperature_scenarios</span>(chill_hist_scenario_list,</span>
<span id="cb194-1370"><a href="#cb194-1370" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,</span>
<span id="cb194-1371"><a href="#cb194-1371" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Rochester_hist_chill_305_59"</span>)</span>
<span id="cb194-1372"><a href="#cb194-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1373"><a href="#cb194-1373" aria-hidden="true" tabindex="-1"></a>chill_future_scenario_list <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,<span class="st">"Rochester_futurechill"</span>)</span>
<span id="cb194-1374"><a href="#cb194-1374" aria-hidden="true" tabindex="-1"></a>chill_hist_scenario_list<span class="ot">&lt;-</span><span class="fu">load_temperature_scenarios</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York"</span>,<span class="st">"Rochester_hist_chill_305_59"</span>)</span>
<span id="cb194-1375"><a href="#cb194-1375" aria-hidden="true" tabindex="-1"></a>observed_chill <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_observed_chill_305_59.csv"</span>)</span>
<span id="cb194-1376"><a href="#cb194-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1377"><a href="#cb194-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1378"><a href="#cb194-1378" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare for plotting</span></span>
<span id="cb194-1379"><a href="#cb194-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1380"><a href="#cb194-1380" aria-hidden="true" tabindex="-1"></a>chills <span class="ot">&lt;-</span> <span class="fu">make_climate_scenario</span>(</span>
<span id="cb194-1381"><a href="#cb194-1381" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric_summary =</span> chill_hist_scenario_list,</span>
<span id="cb194-1382"><a href="#cb194-1382" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Historical"</span>,</span>
<span id="cb194-1383"><a href="#cb194-1383" aria-hidden="true" tabindex="-1"></a>  <span class="at">historic_data =</span> observed_chill,</span>
<span id="cb194-1384"><a href="#cb194-1384" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_series =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-1385"><a href="#cb194-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1386"><a href="#cb194-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_climate_scenarios</span>(</span>
<span id="cb194-1387"><a href="#cb194-1387" aria-hidden="true" tabindex="-1"></a>  <span class="at">climate_scenario_list =</span> chills,</span>
<span id="cb194-1388"><a href="#cb194-1388" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"Chill_Portions"</span>,</span>
<span id="cb194-1389"><a href="#cb194-1389" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric_label =</span> <span class="st">"Chill (Chill Portions)"</span>)</span>
<span id="cb194-1390"><a href="#cb194-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1391"><a href="#cb194-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1392"><a href="#cb194-1392" aria-hidden="true" tabindex="-1"></a>list_ssp <span class="ot">&lt;-</span> </span>
<span id="cb194-1393"><a href="#cb194-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list),</span>
<span id="cb194-1394"><a href="#cb194-1394" aria-hidden="true" tabindex="-1"></a>           <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1395"><a href="#cb194-1395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1396"><a href="#cb194-1396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-1397"><a href="#cb194-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1398"><a href="#cb194-1398" aria-hidden="true" tabindex="-1"></a>list_gcm <span class="ot">&lt;-</span></span>
<span id="cb194-1399"><a href="#cb194-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1400"><a href="#cb194-1400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1401"><a href="#cb194-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-1402"><a href="#cb194-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1403"><a href="#cb194-1403" aria-hidden="true" tabindex="-1"></a>list_time <span class="ot">&lt;-</span></span>
<span id="cb194-1404"><a href="#cb194-1404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1405"><a href="#cb194-1405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1406"><a href="#cb194-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-1407"><a href="#cb194-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1408"><a href="#cb194-1408" aria-hidden="true" tabindex="-1"></a>SSPs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssp126"</span>, <span class="st">"ssp245"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span>)</span>
<span id="cb194-1409"><a href="#cb194-1409" aria-hidden="true" tabindex="-1"></a>Times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>)</span>
<span id="cb194-1410"><a href="#cb194-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1411"><a href="#cb194-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1412"><a href="#cb194-1412" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(SSP <span class="cf">in</span> SSPs)</span>
<span id="cb194-1413"><a href="#cb194-1413" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(Time <span class="cf">in</span> Times)</span>
<span id="cb194-1414"><a href="#cb194-1414" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb194-1415"><a href="#cb194-1415" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-1416"><a href="#cb194-1416" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find all scenarios for the ssp and time</span></span>
<span id="cb194-1417"><a href="#cb194-1417" aria-hidden="true" tabindex="-1"></a>    chill <span class="ot">&lt;-</span> chill_future_scenario_list[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span></span>
<span id="cb194-1418"><a href="#cb194-1418" aria-hidden="true" tabindex="-1"></a>                                          list_time <span class="sc">==</span> Time]</span>
<span id="cb194-1419"><a href="#cb194-1419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(chill) <span class="ot">&lt;-</span> list_gcm[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span></span>
<span id="cb194-1420"><a href="#cb194-1420" aria-hidden="true" tabindex="-1"></a>                               list_time <span class="sc">==</span> Time]</span>
<span id="cb194-1421"><a href="#cb194-1421" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp126"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP1"</span></span>
<span id="cb194-1422"><a href="#cb194-1422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp245"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP2"</span></span>
<span id="cb194-1423"><a href="#cb194-1423" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp370"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP3"</span></span>
<span id="cb194-1424"><a href="#cb194-1424" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp585"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP5"</span>    </span>
<span id="cb194-1425"><a href="#cb194-1425" aria-hidden="true" tabindex="-1"></a>    chills <span class="ot">&lt;-</span> chill <span class="sc">%&gt;%</span> </span>
<span id="cb194-1426"><a href="#cb194-1426" aria-hidden="true" tabindex="-1"></a>      <span class="fu">make_climate_scenario</span>(</span>
<span id="cb194-1427"><a href="#cb194-1427" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="fu">c</span>(SSPcaption,</span>
<span id="cb194-1428"><a href="#cb194-1428" aria-hidden="true" tabindex="-1"></a>                    Time),</span>
<span id="cb194-1429"><a href="#cb194-1429" aria-hidden="true" tabindex="-1"></a>        <span class="at">add_to =</span> chills)</span>
<span id="cb194-1430"><a href="#cb194-1430" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb194-1431"><a href="#cb194-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1432"><a href="#cb194-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1433"><a href="#cb194-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1434"><a href="#cb194-1434" aria-hidden="true" tabindex="-1"></a>info_chill <span class="ot">&lt;-</span></span>
<span id="cb194-1435"><a href="#cb194-1435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_climate_scenarios</span>(</span>
<span id="cb194-1436"><a href="#cb194-1436" aria-hidden="true" tabindex="-1"></a>    <span class="at">climate_scenario_list =</span> chills,</span>
<span id="cb194-1437"><a href="#cb194-1437" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"Chill_Portions"</span>,</span>
<span id="cb194-1438"><a href="#cb194-1438" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric_label =</span> <span class="st">"Chill (Chill Portions)"</span>,</span>
<span id="cb194-1439"><a href="#cb194-1439" aria-hidden="true" tabindex="-1"></a>    <span class="at">texcex =</span> <span class="dv">1</span>)</span>
<span id="cb194-1440"><a href="#cb194-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1441"><a href="#cb194-1441" aria-hidden="true" tabindex="-1"></a>info_heat <span class="ot">&lt;-</span></span>
<span id="cb194-1442"><a href="#cb194-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_climate_scenarios</span>(</span>
<span id="cb194-1443"><a href="#cb194-1443" aria-hidden="true" tabindex="-1"></a>    <span class="at">climate_scenario_list =</span> chills,</span>
<span id="cb194-1444"><a href="#cb194-1444" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"GDH"</span>,</span>
<span id="cb194-1445"><a href="#cb194-1445" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric_label =</span> <span class="st">"Heat (Growing Degree Hours)"</span>,</span>
<span id="cb194-1446"><a href="#cb194-1446" aria-hidden="true" tabindex="-1"></a>    <span class="at">texcex =</span> <span class="dv">1</span>)</span>
<span id="cb194-1447"><a href="#cb194-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1448"><a href="#cb194-1448" aria-hidden="true" tabindex="-1"></a>info_frost <span class="ot">&lt;-</span> </span>
<span id="cb194-1449"><a href="#cb194-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_climate_scenarios</span>(  </span>
<span id="cb194-1450"><a href="#cb194-1450" aria-hidden="true" tabindex="-1"></a>    <span class="at">climate_scenario_list=</span>chills,</span>
<span id="cb194-1451"><a href="#cb194-1451" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric=</span><span class="st">"Frost_H"</span>,</span>
<span id="cb194-1452"><a href="#cb194-1452" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric_label=</span><span class="st">"Frost incidence (hours)"</span>,</span>
<span id="cb194-1453"><a href="#cb194-1453" aria-hidden="true" tabindex="-1"></a>    <span class="at">texcex=</span><span class="dv">1</span>)</span>
<span id="cb194-1454"><a href="#cb194-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1455"><a href="#cb194-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1456"><a href="#cb194-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1457"><a href="#cb194-1457" aria-hidden="true" tabindex="-1"></a>info_chill[[<span class="dv">2</span>]]</span>
<span id="cb194-1458"><a href="#cb194-1458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1459"><a href="#cb194-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1460"><a href="#cb194-1460" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-1461"><a href="#cb194-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1462"><a href="#cb194-1462" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 18: Plotting Climate Scenarios</span></span>
<span id="cb194-1463"><a href="#cb194-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1464"><a href="#cb194-1464" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on plotting future projections*** </span></span>
<span id="cb194-1465"><a href="#cb194-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1466"><a href="#cb194-1466" aria-hidden="true" tabindex="-1"></a>1.Produce similar plots for the weather station you selected for earlier exercises.</span>
<span id="cb194-1467"><a href="#cb194-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1470"><a href="#cb194-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-1471"><a href="#cb194-1471" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb194-1472"><a href="#cb194-1472" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb194-1473"><a href="#cb194-1473" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggpmisc)</span></span>
<span id="cb194-1474"><a href="#cb194-1474" aria-hidden="true" tabindex="-1"></a><span class="co">#library(patchwork)</span></span>
<span id="cb194-1475"><a href="#cb194-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1476"><a href="#cb194-1476" aria-hidden="true" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York"</span>,</span>
<span id="cb194-1477"><a href="#cb194-1477" aria-hidden="true" tabindex="-1"></a>                                                       <span class="st">"Rochester_hist_chill_305_59"</span>)</span>
<span id="cb194-1478"><a href="#cb194-1478" aria-hidden="true" tabindex="-1"></a>actual_chill <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_observed_chill_305_59.csv"</span>)</span>
<span id="cb194-1479"><a href="#cb194-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1480"><a href="#cb194-1480" aria-hidden="true" tabindex="-1"></a>chill_future_scenario_list <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/future_climate"</span>,</span>
<span id="cb194-1481"><a href="#cb194-1481" aria-hidden="true" tabindex="-1"></a>                                                         <span class="st">"Rochester_futurechill"</span>)</span>
<span id="cb194-1482"><a href="#cb194-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1483"><a href="#cb194-1483" aria-hidden="true" tabindex="-1"></a>chills <span class="ot">&lt;-</span> <span class="fu">make_climate_scenario</span>(</span>
<span id="cb194-1484"><a href="#cb194-1484" aria-hidden="true" tabindex="-1"></a>  chill_hist_scenario_list,</span>
<span id="cb194-1485"><a href="#cb194-1485" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Historic"</span>,</span>
<span id="cb194-1486"><a href="#cb194-1486" aria-hidden="true" tabindex="-1"></a>  <span class="at">historic_data =</span> actual_chill,</span>
<span id="cb194-1487"><a href="#cb194-1487" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_series =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-1488"><a href="#cb194-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1489"><a href="#cb194-1489" aria-hidden="true" tabindex="-1"></a>SSPs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssp126"</span>, <span class="st">"ssp245"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span>)</span>
<span id="cb194-1490"><a href="#cb194-1490" aria-hidden="true" tabindex="-1"></a>Times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>)</span>
<span id="cb194-1491"><a href="#cb194-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1492"><a href="#cb194-1492" aria-hidden="true" tabindex="-1"></a>list_ssp <span class="ot">&lt;-</span> </span>
<span id="cb194-1493"><a href="#cb194-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1494"><a href="#cb194-1494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1495"><a href="#cb194-1495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-1496"><a href="#cb194-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1497"><a href="#cb194-1497" aria-hidden="true" tabindex="-1"></a>list_gcm <span class="ot">&lt;-</span></span>
<span id="cb194-1498"><a href="#cb194-1498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1499"><a href="#cb194-1499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1500"><a href="#cb194-1500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-1501"><a href="#cb194-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1502"><a href="#cb194-1502" aria-hidden="true" tabindex="-1"></a>list_time <span class="ot">&lt;-</span></span>
<span id="cb194-1503"><a href="#cb194-1503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1504"><a href="#cb194-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-1505"><a href="#cb194-1505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-1506"><a href="#cb194-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1507"><a href="#cb194-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1508"><a href="#cb194-1508" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(SSP <span class="cf">in</span> SSPs)</span>
<span id="cb194-1509"><a href="#cb194-1509" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(Time <span class="cf">in</span> Times)</span>
<span id="cb194-1510"><a href="#cb194-1510" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb194-1511"><a href="#cb194-1511" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-1512"><a href="#cb194-1512" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find all scenarios for the ssp and time</span></span>
<span id="cb194-1513"><a href="#cb194-1513" aria-hidden="true" tabindex="-1"></a>    chill <span class="ot">&lt;-</span> chill_future_scenario_list[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span> list_time <span class="sc">==</span> Time]</span>
<span id="cb194-1514"><a href="#cb194-1514" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(chill) <span class="ot">&lt;-</span> list_gcm[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span> list_time <span class="sc">==</span> Time]</span>
<span id="cb194-1515"><a href="#cb194-1515" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp126"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP1"</span></span>
<span id="cb194-1516"><a href="#cb194-1516" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp245"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP2"</span></span>
<span id="cb194-1517"><a href="#cb194-1517" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp370"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP3"</span></span>
<span id="cb194-1518"><a href="#cb194-1518" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp585"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP5"</span>    </span>
<span id="cb194-1519"><a href="#cb194-1519" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Time <span class="sc">==</span> <span class="st">"2050"</span>) Time_caption <span class="ot">&lt;-</span> <span class="st">"2050"</span></span>
<span id="cb194-1520"><a href="#cb194-1520" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Time <span class="sc">==</span> <span class="st">"2085"</span>) Time_caption <span class="ot">&lt;-</span> <span class="st">"2085"</span></span>
<span id="cb194-1521"><a href="#cb194-1521" aria-hidden="true" tabindex="-1"></a>    chills <span class="ot">&lt;-</span> chill <span class="sc">%&gt;%</span> </span>
<span id="cb194-1522"><a href="#cb194-1522" aria-hidden="true" tabindex="-1"></a>      <span class="fu">make_climate_scenario</span>(</span>
<span id="cb194-1523"><a href="#cb194-1523" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="fu">c</span>(SSPcaption,</span>
<span id="cb194-1524"><a href="#cb194-1524" aria-hidden="true" tabindex="-1"></a>                    Time_caption),</span>
<span id="cb194-1525"><a href="#cb194-1525" aria-hidden="true" tabindex="-1"></a>        <span class="at">add_to =</span> chills)</span>
<span id="cb194-1526"><a href="#cb194-1526" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-1527"><a href="#cb194-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1528"><a href="#cb194-1528" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_climate_scenarios</span>(</span>
<span id="cb194-1529"><a href="#cb194-1529" aria-hidden="true" tabindex="-1"></a>  <span class="at">climate_scenario_list =</span> chills,</span>
<span id="cb194-1530"><a href="#cb194-1530" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"Chill_Portions"</span>,</span>
<span id="cb194-1531"><a href="#cb194-1531" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric_label =</span> <span class="st">"Chill (Chill Portions)"</span>,</span>
<span id="cb194-1532"><a href="#cb194-1532" aria-hidden="true" tabindex="-1"></a>  <span class="at">texcex =</span> <span class="dv">1</span>)</span>
<span id="cb194-1533"><a href="#cb194-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1534"><a href="#cb194-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1535"><a href="#cb194-1535" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll first process the past scenarios (element 1 of the chills list).</span></span>
<span id="cb194-1536"><a href="#cb194-1536" aria-hidden="true" tabindex="-1"></a><span class="co"># Within the data element, we have a list of multiple data.frames for</span></span>
<span id="cb194-1537"><a href="#cb194-1537" aria-hidden="true" tabindex="-1"></a><span class="co"># the various past scenarios.</span></span>
<span id="cb194-1538"><a href="#cb194-1538" aria-hidden="true" tabindex="-1"></a><span class="co"># Using a 'for' loop, we cycle through all these data.frames.</span></span>
<span id="cb194-1539"><a href="#cb194-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1540"><a href="#cb194-1540" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">names</span>(chills[[<span class="dv">1</span>]]<span class="sc">$</span>data))</span>
<span id="cb194-1541"><a href="#cb194-1541" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb194-1542"><a href="#cb194-1542" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Extract the data frame.</span></span>
<span id="cb194-1543"><a href="#cb194-1543" aria-hidden="true" tabindex="-1"></a>   ch <span class="ot">&lt;-</span> chills[[<span class="dv">1</span>]]<span class="sc">$</span>data[[nam]]</span>
<span id="cb194-1544"><a href="#cb194-1544" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Add columns for the new information we have to add and fill them.</span></span>
<span id="cb194-1545"><a href="#cb194-1545" aria-hidden="true" tabindex="-1"></a>   ch[,<span class="st">"GCM"</span>] <span class="ot">&lt;-</span> <span class="st">"none"</span></span>
<span id="cb194-1546"><a href="#cb194-1546" aria-hidden="true" tabindex="-1"></a>   ch[,<span class="st">"SSP"</span>] <span class="ot">&lt;-</span> <span class="st">"none"</span></span>
<span id="cb194-1547"><a href="#cb194-1547" aria-hidden="true" tabindex="-1"></a>   ch[,<span class="st">"Year"</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(nam)</span>
<span id="cb194-1548"><a href="#cb194-1548" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb194-1549"><a href="#cb194-1549" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Now check if this is the first time we've gone through this loop.</span></span>
<span id="cb194-1550"><a href="#cb194-1550" aria-hidden="true" tabindex="-1"></a>   <span class="co"># If this is the first time, the ch data.frame becomes the output</span></span>
<span id="cb194-1551"><a href="#cb194-1551" aria-hidden="true" tabindex="-1"></a>   <span class="co"># object (past_simulated).</span></span>
<span id="cb194-1552"><a href="#cb194-1552" aria-hidden="true" tabindex="-1"></a>   <span class="co"># If it is not the first time ('else'), we add the current data.frame</span></span>
<span id="cb194-1553"><a href="#cb194-1553" aria-hidden="true" tabindex="-1"></a>   <span class="co"># to the 'past_simulated' object</span></span>
<span id="cb194-1554"><a href="#cb194-1554" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(nam <span class="sc">==</span> <span class="fu">names</span>(chills[[<span class="dv">1</span>]]<span class="sc">$</span>data)[<span class="dv">1</span>])</span>
<span id="cb194-1555"><a href="#cb194-1555" aria-hidden="true" tabindex="-1"></a>    past_simulated <span class="ot">&lt;-</span> ch <span class="cf">else</span></span>
<span id="cb194-1556"><a href="#cb194-1556" aria-hidden="true" tabindex="-1"></a>      past_simulated <span class="ot">&lt;-</span> <span class="fu">rbind</span>(past_simulated,</span>
<span id="cb194-1557"><a href="#cb194-1557" aria-hidden="true" tabindex="-1"></a>                              ch)</span>
<span id="cb194-1558"><a href="#cb194-1558" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb194-1559"><a href="#cb194-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1560"><a href="#cb194-1560" aria-hidden="true" tabindex="-1"></a><span class="co"># We add another column called 'Scenario' and label all rows as 'Historical' </span></span>
<span id="cb194-1561"><a href="#cb194-1561" aria-hidden="true" tabindex="-1"></a>past_simulated[<span class="st">"Scenario"</span>] <span class="ot">&lt;-</span> <span class="st">"Historical"</span></span>
<span id="cb194-1562"><a href="#cb194-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1563"><a href="#cb194-1563" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(past_simulated)</span>
<span id="cb194-1564"><a href="#cb194-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1565"><a href="#cb194-1565" aria-hidden="true" tabindex="-1"></a>past_simulated <span class="ot">&lt;-</span> past_simulated <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb194-1566"><a href="#cb194-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1567"><a href="#cb194-1567" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll want to add the historic observation too, so let's simplify the</span></span>
<span id="cb194-1568"><a href="#cb194-1568" aria-hidden="true" tabindex="-1"></a><span class="co"># pointer to this information for easier use later</span></span>
<span id="cb194-1569"><a href="#cb194-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1570"><a href="#cb194-1570" aria-hidden="true" tabindex="-1"></a>past_observed <span class="ot">&lt;-</span> chills[[<span class="dv">1</span>]][[<span class="st">"historic_data"</span>]]</span>
<span id="cb194-1571"><a href="#cb194-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1572"><a href="#cb194-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1573"><a href="#cb194-1573" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(past_observed)</span>
<span id="cb194-1574"><a href="#cb194-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1575"><a href="#cb194-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1576"><a href="#cb194-1576" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract future data</span></span>
<span id="cb194-1577"><a href="#cb194-1577" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(chills))</span>
<span id="cb194-1578"><a href="#cb194-1578" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">names</span>(chills[[i]]<span class="sc">$</span>data))</span>
<span id="cb194-1579"><a href="#cb194-1579" aria-hidden="true" tabindex="-1"></a>    {ch <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>data[[nam]]</span>
<span id="cb194-1580"><a href="#cb194-1580" aria-hidden="true" tabindex="-1"></a>     ch[,<span class="st">"GCM"</span>] <span class="ot">&lt;-</span> nam</span>
<span id="cb194-1581"><a href="#cb194-1581" aria-hidden="true" tabindex="-1"></a>     ch[,<span class="st">"SSP"</span>] <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>caption[<span class="dv">1</span>]</span>
<span id="cb194-1582"><a href="#cb194-1582" aria-hidden="true" tabindex="-1"></a>     ch[,<span class="st">"Year"</span>] <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>caption[<span class="dv">2</span>]</span>
<span id="cb194-1583"><a href="#cb194-1583" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> nam <span class="sc">==</span> <span class="fu">names</span>(chills[[i]]<span class="sc">$</span>data)[<span class="dv">1</span>])</span>
<span id="cb194-1584"><a href="#cb194-1584" aria-hidden="true" tabindex="-1"></a>       future_data <span class="ot">&lt;-</span> ch <span class="cf">else</span></span>
<span id="cb194-1585"><a href="#cb194-1585" aria-hidden="true" tabindex="-1"></a>         future_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(future_data,ch)</span>
<span id="cb194-1586"><a href="#cb194-1586" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb194-1587"><a href="#cb194-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1588"><a href="#cb194-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1589"><a href="#cb194-1589" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(future_data)</span>
<span id="cb194-1590"><a href="#cb194-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1591"><a href="#cb194-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1592"><a href="#cb194-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1593"><a href="#cb194-1593" aria-hidden="true" tabindex="-1"></a>metric <span class="ot">&lt;-</span> <span class="st">"GDH"</span></span>
<span id="cb194-1594"><a href="#cb194-1594" aria-hidden="true" tabindex="-1"></a>axis_label <span class="ot">&lt;-</span> <span class="st">"Heat (in GDH)"</span></span>
<span id="cb194-1595"><a href="#cb194-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1596"><a href="#cb194-1596" aria-hidden="true" tabindex="-1"></a><span class="co"># get extreme values for the axis scale</span></span>
<span id="cb194-1597"><a href="#cb194-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1598"><a href="#cb194-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1599"><a href="#cb194-1599" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(past_observed[[metric]],</span>
<span id="cb194-1600"><a href="#cb194-1600" aria-hidden="true" tabindex="-1"></a>             past_simulated[[metric]],</span>
<span id="cb194-1601"><a href="#cb194-1601" aria-hidden="true" tabindex="-1"></a>             future_data[[metric]])  </span>
<span id="cb194-1602"><a href="#cb194-1602" aria-hidden="true" tabindex="-1"></a>rng</span>
<span id="cb194-1603"><a href="#cb194-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1604"><a href="#cb194-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1605"><a href="#cb194-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1606"><a href="#cb194-1606" aria-hidden="true" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb194-1607"><a href="#cb194-1607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data =</span> past_simulated,</span>
<span id="cb194-1608"><a href="#cb194-1608" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes_string</span>(<span class="st">"as.numeric(Year)"</span>,</span>
<span id="cb194-1609"><a href="#cb194-1609" aria-hidden="true" tabindex="-1"></a>                          metric,</span>
<span id="cb194-1610"><a href="#cb194-1610" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> <span class="st">"Year"</span>),</span>
<span id="cb194-1611"><a href="#cb194-1611" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb194-1612"><a href="#cb194-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1613"><a href="#cb194-1613" aria-hidden="true" tabindex="-1"></a>past_plot</span>
<span id="cb194-1614"><a href="#cb194-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1615"><a href="#cb194-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1616"><a href="#cb194-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1617"><a href="#cb194-1617" aria-hidden="true" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> past_plot <span class="sc">+</span></span>
<span id="cb194-1618"><a href="#cb194-1618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb194-1619"><a href="#cb194-1619" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb194-1620"><a href="#cb194-1620" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(rng[<span class="dv">2</span>] <span class="sc">+</span> rng[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb194-1621"><a href="#cb194-1621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, </span>
<span id="cb194-1622"><a href="#cb194-1622" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> axis_label)</span>
<span id="cb194-1623"><a href="#cb194-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1624"><a href="#cb194-1624" aria-hidden="true" tabindex="-1"></a>past_plot</span>
<span id="cb194-1625"><a href="#cb194-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1626"><a href="#cb194-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1627"><a href="#cb194-1627" aria-hidden="true" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> past_plot <span class="sc">+</span></span>
<span id="cb194-1628"><a href="#cb194-1628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Scenario) <span class="sc">+</span></span>
<span id="cb194-1629"><a href="#cb194-1629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) </span>
<span id="cb194-1630"><a href="#cb194-1630" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-1631"><a href="#cb194-1631" aria-hidden="true" tabindex="-1"></a>past_plot</span>
<span id="cb194-1632"><a href="#cb194-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1633"><a href="#cb194-1633" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-1634"><a href="#cb194-1634" aria-hidden="true" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> past_plot <span class="sc">+</span>  </span>
<span id="cb194-1635"><a href="#cb194-1635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1636"><a href="#cb194-1636" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1637"><a href="#cb194-1637" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb194-1638"><a href="#cb194-1638" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="dv">1</span>)) </span>
<span id="cb194-1639"><a href="#cb194-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1640"><a href="#cb194-1640" aria-hidden="true" tabindex="-1"></a>past_plot</span>
<span id="cb194-1641"><a href="#cb194-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1642"><a href="#cb194-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1643"><a href="#cb194-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1644"><a href="#cb194-1644" aria-hidden="true" tabindex="-1"></a><span class="co"># add historic data</span></span>
<span id="cb194-1645"><a href="#cb194-1645" aria-hidden="true" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> past_plot <span class="sc">+</span></span>
<span id="cb194-1646"><a href="#cb194-1646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> past_observed,</span>
<span id="cb194-1647"><a href="#cb194-1647" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes_string</span>(<span class="st">"End_year"</span>,</span>
<span id="cb194-1648"><a href="#cb194-1648" aria-hidden="true" tabindex="-1"></a>                        metric),</span>
<span id="cb194-1649"><a href="#cb194-1649" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb194-1650"><a href="#cb194-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1651"><a href="#cb194-1651" aria-hidden="true" tabindex="-1"></a>past_plot</span>
<span id="cb194-1652"><a href="#cb194-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1653"><a href="#cb194-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1654"><a href="#cb194-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1655"><a href="#cb194-1655" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2050</span></span>
<span id="cb194-1656"><a href="#cb194-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1657"><a href="#cb194-1657" aria-hidden="true" tabindex="-1"></a>future_2050 <span class="ot">&lt;-</span></span>
<span id="cb194-1658"><a href="#cb194-1658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> future_data[future_data<span class="sc">$</span>Year <span class="sc">==</span> y,]) <span class="sc">+</span></span>
<span id="cb194-1659"><a href="#cb194-1659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes_string</span>(<span class="st">"GCM"</span>, </span>
<span id="cb194-1660"><a href="#cb194-1660" aria-hidden="true" tabindex="-1"></a>                          metric, </span>
<span id="cb194-1661"><a href="#cb194-1661" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill =</span> <span class="st">"GCM"</span>))</span>
<span id="cb194-1662"><a href="#cb194-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1663"><a href="#cb194-1663" aria-hidden="true" tabindex="-1"></a>future_2050</span>
<span id="cb194-1664"><a href="#cb194-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1665"><a href="#cb194-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1666"><a href="#cb194-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1667"><a href="#cb194-1667" aria-hidden="true" tabindex="-1"></a>future_2050 <span class="ot">&lt;-</span> future_2050 <span class="sc">+</span></span>
<span id="cb194-1668"><a href="#cb194-1668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(SSP), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-1669"><a href="#cb194-1669" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb194-1670"><a href="#cb194-1670" aria-hidden="true" tabindex="-1"></a>                    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">1</span>)) </span>
<span id="cb194-1671"><a href="#cb194-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1672"><a href="#cb194-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1673"><a href="#cb194-1673" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb194-1674"><a href="#cb194-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1675"><a href="#cb194-1675" aria-hidden="true" tabindex="-1"></a>future_2050 <span class="ot">&lt;-</span> future_2050 <span class="sc">+</span></span>
<span id="cb194-1676"><a href="#cb194-1676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb194-1677"><a href="#cb194-1677" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb194-1678"><a href="#cb194-1678" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_npc</span>(<span class="fu">aes</span>(<span class="at">npcx =</span> <span class="st">"center"</span>, </span>
<span id="cb194-1679"><a href="#cb194-1679" aria-hidden="true" tabindex="-1"></a>                      <span class="at">npcy =</span> <span class="st">"top"</span>,</span>
<span id="cb194-1680"><a href="#cb194-1680" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> Year),</span>
<span id="cb194-1681"><a href="#cb194-1681" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb194-1682"><a href="#cb194-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1683"><a href="#cb194-1683" aria-hidden="true" tabindex="-1"></a>future_2050</span>
<span id="cb194-1684"><a href="#cb194-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1685"><a href="#cb194-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1686"><a href="#cb194-1686" aria-hidden="true" tabindex="-1"></a>future_2050 <span class="ot">&lt;-</span> future_2050 <span class="sc">+</span></span>
<span id="cb194-1687"><a href="#cb194-1687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb194-1688"><a href="#cb194-1688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1689"><a href="#cb194-1689" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1690"><a href="#cb194-1690" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1691"><a href="#cb194-1691" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-1692"><a href="#cb194-1692" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,</span>
<span id="cb194-1693"><a href="#cb194-1693" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>,</span>
<span id="cb194-1694"><a href="#cb194-1694" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>,</span>
<span id="cb194-1695"><a href="#cb194-1695" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>,</span>
<span id="cb194-1696"><a href="#cb194-1696" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cm"</span>),</span>
<span id="cb194-1697"><a href="#cb194-1697" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb194-1698"><a href="#cb194-1698" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1699"><a href="#cb194-1699" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1700"><a href="#cb194-1700" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb194-1701"><a href="#cb194-1701" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb194-1702"><a href="#cb194-1702" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb194-1703"><a href="#cb194-1703" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb194-1704"><a href="#cb194-1704" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face =</span> <span class="st">"bold"</span>)) </span>
<span id="cb194-1705"><a href="#cb194-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1706"><a href="#cb194-1706" aria-hidden="true" tabindex="-1"></a>future_2050</span>
<span id="cb194-1707"><a href="#cb194-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1708"><a href="#cb194-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1709"><a href="#cb194-1709" aria-hidden="true" tabindex="-1"></a>future_plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb194-1710"><a href="#cb194-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1711"><a href="#cb194-1711" aria-hidden="true" tabindex="-1"></a>time_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>)</span>
<span id="cb194-1712"><a href="#cb194-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1713"><a href="#cb194-1713" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(y <span class="cf">in</span> time_points)</span>
<span id="cb194-1714"><a href="#cb194-1714" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb194-1715"><a href="#cb194-1715" aria-hidden="true" tabindex="-1"></a>  future_plot_list[[<span class="fu">which</span>(y <span class="sc">==</span> time_points)]] <span class="ot">&lt;-</span></span>
<span id="cb194-1716"><a href="#cb194-1716" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data =</span> future_data[<span class="fu">which</span>(future_data<span class="sc">$</span>Year<span class="sc">==</span>y),]) <span class="sc">+</span></span>
<span id="cb194-1717"><a href="#cb194-1717" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes_string</span>(<span class="st">"GCM"</span>,</span>
<span id="cb194-1718"><a href="#cb194-1718" aria-hidden="true" tabindex="-1"></a>                            metric,</span>
<span id="cb194-1719"><a href="#cb194-1719" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill=</span><span class="st">"GCM"</span>)) <span class="sc">+</span></span>
<span id="cb194-1720"><a href="#cb194-1720" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(SSP), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-1721"><a href="#cb194-1721" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb194-1722"><a href="#cb194-1722" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-1723"><a href="#cb194-1723" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb194-1724"><a href="#cb194-1724" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb194-1725"><a href="#cb194-1725" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_npc</span>(<span class="fu">aes</span>(<span class="at">npcx =</span> <span class="st">"center"</span>,</span>
<span id="cb194-1726"><a href="#cb194-1726" aria-hidden="true" tabindex="-1"></a>                      <span class="at">npcy =</span> <span class="st">"top"</span>, </span>
<span id="cb194-1727"><a href="#cb194-1727" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> Year),</span>
<span id="cb194-1728"><a href="#cb194-1728" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb194-1729"><a href="#cb194-1729" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb194-1730"><a href="#cb194-1730" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1731"><a href="#cb194-1731" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1732"><a href="#cb194-1732" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1733"><a href="#cb194-1733" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-1734"><a href="#cb194-1734" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, </span>
<span id="cb194-1735"><a href="#cb194-1735" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">0</span>, </span>
<span id="cb194-1736"><a href="#cb194-1736" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">0</span>, </span>
<span id="cb194-1737"><a href="#cb194-1737" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">0</span>, </span>
<span id="cb194-1738"><a href="#cb194-1738" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"cm"</span>),</span>
<span id="cb194-1739"><a href="#cb194-1739" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb194-1740"><a href="#cb194-1740" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1741"><a href="#cb194-1741" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1742"><a href="#cb194-1742" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb194-1743"><a href="#cb194-1743" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(</span>
<span id="cb194-1744"><a href="#cb194-1744" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb194-1745"><a href="#cb194-1745" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb194-1746"><a href="#cb194-1746" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb194-1747"><a href="#cb194-1747" aria-hidden="true" tabindex="-1"></a>            <span class="at">face =</span> <span class="st">"bold"</span>)) </span>
<span id="cb194-1748"><a href="#cb194-1748" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-1749"><a href="#cb194-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1750"><a href="#cb194-1750" aria-hidden="true" tabindex="-1"></a>future_plot_list</span>
<span id="cb194-1751"><a href="#cb194-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1752"><a href="#cb194-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1753"><a href="#cb194-1753" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb194-1754"><a href="#cb194-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1755"><a href="#cb194-1755" aria-hidden="true" tabindex="-1"></a>both_plots <span class="ot">&lt;-</span> past_plot <span class="sc">+</span> future_plot_list</span>
<span id="cb194-1756"><a href="#cb194-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1757"><a href="#cb194-1757" aria-hidden="true" tabindex="-1"></a>both_plots</span>
<span id="cb194-1758"><a href="#cb194-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1759"><a href="#cb194-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1760"><a href="#cb194-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1761"><a href="#cb194-1761" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> both_plots <span class="sc">+</span></span>
<span id="cb194-1762"><a href="#cb194-1762" aria-hidden="true" tabindex="-1"></a>           <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>,</span>
<span id="cb194-1763"><a href="#cb194-1763" aria-hidden="true" tabindex="-1"></a>                       <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,</span>
<span id="cb194-1764"><a href="#cb194-1764" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">rep</span>(<span class="fl">1.8</span>,</span>
<span id="cb194-1765"><a href="#cb194-1765" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">length</span>(future_plot_list))))</span>
<span id="cb194-1766"><a href="#cb194-1766" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb194-1767"><a href="#cb194-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1768"><a href="#cb194-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1769"><a href="#cb194-1769" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-1770"><a href="#cb194-1770" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb194-1771"><a href="#cb194-1771" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb194-1772"><a href="#cb194-1772" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb194-1773"><a href="#cb194-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1774"><a href="#cb194-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1775"><a href="#cb194-1775" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb194-1776"><a href="#cb194-1776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1777"><a href="#cb194-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1778"><a href="#cb194-1778" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb194-1779"><a href="#cb194-1779" aria-hidden="true" tabindex="-1"></a>metric <span class="ot">&lt;-</span> <span class="st">"Chill_Portions"</span></span>
<span id="cb194-1780"><a href="#cb194-1780" aria-hidden="true" tabindex="-1"></a>axis_label <span class="ot">&lt;-</span> <span class="st">"Chill (in CP)"</span></span>
<span id="cb194-1781"><a href="#cb194-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1782"><a href="#cb194-1782" aria-hidden="true" tabindex="-1"></a><span class="co"># get extreme values for the axis scale</span></span>
<span id="cb194-1783"><a href="#cb194-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1784"><a href="#cb194-1784" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(past_observed[[metric]],</span>
<span id="cb194-1785"><a href="#cb194-1785" aria-hidden="true" tabindex="-1"></a>             past_simulated[[metric]],</span>
<span id="cb194-1786"><a href="#cb194-1786" aria-hidden="true" tabindex="-1"></a>             future_data[[metric]])  </span>
<span id="cb194-1787"><a href="#cb194-1787" aria-hidden="true" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb194-1788"><a href="#cb194-1788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data =</span> past_simulated,</span>
<span id="cb194-1789"><a href="#cb194-1789" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes_string</span>(<span class="st">"as.numeric(Year)"</span>,</span>
<span id="cb194-1790"><a href="#cb194-1790" aria-hidden="true" tabindex="-1"></a>                          metric,<span class="at">group=</span><span class="st">"Year"</span>),</span>
<span id="cb194-1791"><a href="#cb194-1791" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb194-1792"><a href="#cb194-1792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb194-1793"><a href="#cb194-1793" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb194-1794"><a href="#cb194-1794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> axis_label) <span class="sc">+</span></span>
<span id="cb194-1795"><a href="#cb194-1795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Scenario) <span class="sc">+</span></span>
<span id="cb194-1796"><a href="#cb194-1796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span>  </span>
<span id="cb194-1797"><a href="#cb194-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1798"><a href="#cb194-1798" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1799"><a href="#cb194-1799" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-1800"><a href="#cb194-1800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> past_observed,</span>
<span id="cb194-1801"><a href="#cb194-1801" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes_string</span>(<span class="st">"End_year"</span>,</span>
<span id="cb194-1802"><a href="#cb194-1802" aria-hidden="true" tabindex="-1"></a>                        metric),</span>
<span id="cb194-1803"><a href="#cb194-1803" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb194-1804"><a href="#cb194-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1805"><a href="#cb194-1805" aria-hidden="true" tabindex="-1"></a>future_plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb194-1806"><a href="#cb194-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1807"><a href="#cb194-1807" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(y <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2050</span>,</span>
<span id="cb194-1808"><a href="#cb194-1808" aria-hidden="true" tabindex="-1"></a>           <span class="dv">2085</span>))</span>
<span id="cb194-1809"><a href="#cb194-1809" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb194-1810"><a href="#cb194-1810" aria-hidden="true" tabindex="-1"></a>  future_plot_list[[<span class="fu">which</span>(y <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2050</span>,<span class="dv">2085</span>))]] <span class="ot">&lt;-</span></span>
<span id="cb194-1811"><a href="#cb194-1811" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data =</span> future_data[<span class="fu">which</span>(future_data<span class="sc">$</span>Year<span class="sc">==</span>y),]) <span class="sc">+</span></span>
<span id="cb194-1812"><a href="#cb194-1812" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes_string</span>(<span class="st">"GCM"</span>, </span>
<span id="cb194-1813"><a href="#cb194-1813" aria-hidden="true" tabindex="-1"></a>                            metric, </span>
<span id="cb194-1814"><a href="#cb194-1814" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill=</span><span class="st">"GCM"</span>)) <span class="sc">+</span></span>
<span id="cb194-1815"><a href="#cb194-1815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(SSP), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-1816"><a href="#cb194-1816" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb194-1817"><a href="#cb194-1817" aria-hidden="true" tabindex="-1"></a>                    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-1818"><a href="#cb194-1818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb194-1819"><a href="#cb194-1819" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb194-1820"><a href="#cb194-1820" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_npc</span>(<span class="fu">aes</span>(<span class="at">npcx =</span> <span class="st">"center"</span>, </span>
<span id="cb194-1821"><a href="#cb194-1821" aria-hidden="true" tabindex="-1"></a>                      <span class="at">npcy =</span> <span class="st">"top"</span>, </span>
<span id="cb194-1822"><a href="#cb194-1822" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> Year),</span>
<span id="cb194-1823"><a href="#cb194-1823" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb194-1824"><a href="#cb194-1824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb194-1825"><a href="#cb194-1825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1826"><a href="#cb194-1826" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1827"><a href="#cb194-1827" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1828"><a href="#cb194-1828" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-1829"><a href="#cb194-1829" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,</span>
<span id="cb194-1830"><a href="#cb194-1830" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>, </span>
<span id="cb194-1831"><a href="#cb194-1831" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>,</span>
<span id="cb194-1832"><a href="#cb194-1832" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>, </span>
<span id="cb194-1833"><a href="#cb194-1833" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cm"</span>),</span>
<span id="cb194-1834"><a href="#cb194-1834" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb194-1835"><a href="#cb194-1835" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1836"><a href="#cb194-1836" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1837"><a href="#cb194-1837" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb194-1838"><a href="#cb194-1838" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb194-1839"><a href="#cb194-1839" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb194-1840"><a href="#cb194-1840" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb194-1841"><a href="#cb194-1841" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face =</span> <span class="st">"bold"</span>)) </span>
<span id="cb194-1842"><a href="#cb194-1842" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-1843"><a href="#cb194-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1844"><a href="#cb194-1844" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> (past_plot <span class="sc">+</span></span>
<span id="cb194-1845"><a href="#cb194-1845" aria-hidden="true" tabindex="-1"></a>           future_plot_list <span class="sc">+</span></span>
<span id="cb194-1846"><a href="#cb194-1846" aria-hidden="true" tabindex="-1"></a>           <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>,</span>
<span id="cb194-1847"><a href="#cb194-1847" aria-hidden="true" tabindex="-1"></a>                       <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="fl">1.8</span>,<span class="fu">length</span>(future_plot_list))))</span>
<span id="cb194-1848"><a href="#cb194-1848" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-1849"><a href="#cb194-1849" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb194-1850"><a href="#cb194-1850" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb194-1851"><a href="#cb194-1851" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.title.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb194-1852"><a href="#cb194-1852" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb194-1853"><a href="#cb194-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1854"><a href="#cb194-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1855"><a href="#cb194-1855" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb194-1856"><a href="#cb194-1856" aria-hidden="true" tabindex="-1"></a>metric <span class="ot">&lt;-</span> <span class="st">"Frost_H"</span></span>
<span id="cb194-1857"><a href="#cb194-1857" aria-hidden="true" tabindex="-1"></a>axis_label <span class="ot">&lt;-</span> <span class="st">"Frost duration (in hours)"</span></span>
<span id="cb194-1858"><a href="#cb194-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1859"><a href="#cb194-1859" aria-hidden="true" tabindex="-1"></a><span class="co"># get extreme values for the axis scale</span></span>
<span id="cb194-1860"><a href="#cb194-1860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1861"><a href="#cb194-1861" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(past_observed[[metric]],</span>
<span id="cb194-1862"><a href="#cb194-1862" aria-hidden="true" tabindex="-1"></a>             past_simulated[[metric]],</span>
<span id="cb194-1863"><a href="#cb194-1863" aria-hidden="true" tabindex="-1"></a>             future_data[[metric]])  </span>
<span id="cb194-1864"><a href="#cb194-1864" aria-hidden="true" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb194-1865"><a href="#cb194-1865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data =</span> past_simulated,</span>
<span id="cb194-1866"><a href="#cb194-1866" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes_string</span>(<span class="st">"as.numeric(Year)"</span>,</span>
<span id="cb194-1867"><a href="#cb194-1867" aria-hidden="true" tabindex="-1"></a>                          metric,<span class="at">group=</span><span class="st">"Year"</span>),</span>
<span id="cb194-1868"><a href="#cb194-1868" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb194-1869"><a href="#cb194-1869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb194-1870"><a href="#cb194-1870" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb194-1871"><a href="#cb194-1871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> axis_label) <span class="sc">+</span></span>
<span id="cb194-1872"><a href="#cb194-1872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Scenario) <span class="sc">+</span></span>
<span id="cb194-1873"><a href="#cb194-1873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span>  </span>
<span id="cb194-1874"><a href="#cb194-1874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1875"><a href="#cb194-1875" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1876"><a href="#cb194-1876" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-1877"><a href="#cb194-1877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> past_observed,</span>
<span id="cb194-1878"><a href="#cb194-1878" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes_string</span>(<span class="st">"End_year"</span>,</span>
<span id="cb194-1879"><a href="#cb194-1879" aria-hidden="true" tabindex="-1"></a>                        metric),</span>
<span id="cb194-1880"><a href="#cb194-1880" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb194-1881"><a href="#cb194-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1882"><a href="#cb194-1882" aria-hidden="true" tabindex="-1"></a>future_plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb194-1883"><a href="#cb194-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1884"><a href="#cb194-1884" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(y <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2050</span>,</span>
<span id="cb194-1885"><a href="#cb194-1885" aria-hidden="true" tabindex="-1"></a>           <span class="dv">2085</span>))</span>
<span id="cb194-1886"><a href="#cb194-1886" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb194-1887"><a href="#cb194-1887" aria-hidden="true" tabindex="-1"></a>  future_plot_list[[<span class="fu">which</span>(y <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2050</span>,<span class="dv">2085</span>))]] <span class="ot">&lt;-</span></span>
<span id="cb194-1888"><a href="#cb194-1888" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data =</span> future_data[<span class="fu">which</span>(future_data<span class="sc">$</span>Year<span class="sc">==</span>y),]) <span class="sc">+</span></span>
<span id="cb194-1889"><a href="#cb194-1889" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes_string</span>(<span class="st">"GCM"</span>, </span>
<span id="cb194-1890"><a href="#cb194-1890" aria-hidden="true" tabindex="-1"></a>                            metric, </span>
<span id="cb194-1891"><a href="#cb194-1891" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill=</span><span class="st">"GCM"</span>)) <span class="sc">+</span></span>
<span id="cb194-1892"><a href="#cb194-1892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(SSP), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-1893"><a href="#cb194-1893" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb194-1894"><a href="#cb194-1894" aria-hidden="true" tabindex="-1"></a>                    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-1895"><a href="#cb194-1895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb194-1896"><a href="#cb194-1896" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb194-1897"><a href="#cb194-1897" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_npc</span>(<span class="fu">aes</span>(<span class="at">npcx =</span> <span class="st">"center"</span>, </span>
<span id="cb194-1898"><a href="#cb194-1898" aria-hidden="true" tabindex="-1"></a>                      <span class="at">npcy =</span> <span class="st">"top"</span>, </span>
<span id="cb194-1899"><a href="#cb194-1899" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> Year),</span>
<span id="cb194-1900"><a href="#cb194-1900" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb194-1901"><a href="#cb194-1901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb194-1902"><a href="#cb194-1902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1903"><a href="#cb194-1903" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1904"><a href="#cb194-1904" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1905"><a href="#cb194-1905" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-1906"><a href="#cb194-1906" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,</span>
<span id="cb194-1907"><a href="#cb194-1907" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>, </span>
<span id="cb194-1908"><a href="#cb194-1908" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>,</span>
<span id="cb194-1909"><a href="#cb194-1909" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>, </span>
<span id="cb194-1910"><a href="#cb194-1910" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cm"</span>),</span>
<span id="cb194-1911"><a href="#cb194-1911" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb194-1912"><a href="#cb194-1912" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1913"><a href="#cb194-1913" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1914"><a href="#cb194-1914" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb194-1915"><a href="#cb194-1915" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb194-1916"><a href="#cb194-1916" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb194-1917"><a href="#cb194-1917" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb194-1918"><a href="#cb194-1918" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face =</span> <span class="st">"bold"</span>)) </span>
<span id="cb194-1919"><a href="#cb194-1919" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-1920"><a href="#cb194-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1921"><a href="#cb194-1921" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> (past_plot <span class="sc">+</span></span>
<span id="cb194-1922"><a href="#cb194-1922" aria-hidden="true" tabindex="-1"></a>           future_plot_list <span class="sc">+</span></span>
<span id="cb194-1923"><a href="#cb194-1923" aria-hidden="true" tabindex="-1"></a>           <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>,</span>
<span id="cb194-1924"><a href="#cb194-1924" aria-hidden="true" tabindex="-1"></a>                       <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="fl">1.8</span>,<span class="fu">length</span>(future_plot_list))))</span>
<span id="cb194-1925"><a href="#cb194-1925" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-1926"><a href="#cb194-1926" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb194-1927"><a href="#cb194-1927" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb194-1928"><a href="#cb194-1928" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.title.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb194-1929"><a href="#cb194-1929" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb194-1930"><a href="#cb194-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1931"><a href="#cb194-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1932"><a href="#cb194-1932" aria-hidden="true" tabindex="-1"></a>plot_scenarios_gg <span class="ot">&lt;-</span> <span class="cf">function</span>(past_observed,</span>
<span id="cb194-1933"><a href="#cb194-1933" aria-hidden="true" tabindex="-1"></a>                              past_simulated,</span>
<span id="cb194-1934"><a href="#cb194-1934" aria-hidden="true" tabindex="-1"></a>                              future_data,</span>
<span id="cb194-1935"><a href="#cb194-1935" aria-hidden="true" tabindex="-1"></a>                              metric,</span>
<span id="cb194-1936"><a href="#cb194-1936" aria-hidden="true" tabindex="-1"></a>                              axis_label,</span>
<span id="cb194-1937"><a href="#cb194-1937" aria-hidden="true" tabindex="-1"></a>                              time_points)</span>
<span id="cb194-1938"><a href="#cb194-1938" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb194-1939"><a href="#cb194-1939" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(past_observed[[metric]],</span>
<span id="cb194-1940"><a href="#cb194-1940" aria-hidden="true" tabindex="-1"></a>               past_simulated[[metric]],</span>
<span id="cb194-1941"><a href="#cb194-1941" aria-hidden="true" tabindex="-1"></a>               future_data[[metric]])  </span>
<span id="cb194-1942"><a href="#cb194-1942" aria-hidden="true" tabindex="-1"></a>  past_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb194-1943"><a href="#cb194-1943" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">data =</span> past_simulated,</span>
<span id="cb194-1944"><a href="#cb194-1944" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes_string</span>(<span class="st">"as.numeric(Year)"</span>,</span>
<span id="cb194-1945"><a href="#cb194-1945" aria-hidden="true" tabindex="-1"></a>                            metric,</span>
<span id="cb194-1946"><a href="#cb194-1946" aria-hidden="true" tabindex="-1"></a>                            <span class="at">group=</span><span class="st">"Year"</span>),</span>
<span id="cb194-1947"><a href="#cb194-1947" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb194-1948"><a href="#cb194-1948" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb194-1949"><a href="#cb194-1949" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb194-1950"><a href="#cb194-1950" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> axis_label) <span class="sc">+</span></span>
<span id="cb194-1951"><a href="#cb194-1951" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span> Scenario) <span class="sc">+</span></span>
<span id="cb194-1952"><a href="#cb194-1952" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span>  </span>
<span id="cb194-1953"><a href="#cb194-1953" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1954"><a href="#cb194-1954" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1955"><a href="#cb194-1955" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>, </span>
<span id="cb194-1956"><a href="#cb194-1956" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-1957"><a href="#cb194-1957" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> past_observed,</span>
<span id="cb194-1958"><a href="#cb194-1958" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes_string</span>(<span class="st">"End_year"</span>,</span>
<span id="cb194-1959"><a href="#cb194-1959" aria-hidden="true" tabindex="-1"></a>                          metric),</span>
<span id="cb194-1960"><a href="#cb194-1960" aria-hidden="true" tabindex="-1"></a>               <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb194-1961"><a href="#cb194-1961" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-1962"><a href="#cb194-1962" aria-hidden="true" tabindex="-1"></a>  future_plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb194-1963"><a href="#cb194-1963" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-1964"><a href="#cb194-1964" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(y <span class="cf">in</span> time_points)</span>
<span id="cb194-1965"><a href="#cb194-1965" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb194-1966"><a href="#cb194-1966" aria-hidden="true" tabindex="-1"></a>    future_plot_list[[<span class="fu">which</span>(y <span class="sc">==</span> time_points)]] <span class="ot">&lt;-</span></span>
<span id="cb194-1967"><a href="#cb194-1967" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="at">data =</span> future_data[<span class="fu">which</span>(future_data<span class="sc">$</span>Year<span class="sc">==</span>y),]) <span class="sc">+</span></span>
<span id="cb194-1968"><a href="#cb194-1968" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_boxplot</span>(<span class="fu">aes_string</span>(<span class="st">"GCM"</span>, </span>
<span id="cb194-1969"><a href="#cb194-1969" aria-hidden="true" tabindex="-1"></a>                              metric, </span>
<span id="cb194-1970"><a href="#cb194-1970" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill=</span><span class="st">"GCM"</span>)) <span class="sc">+</span></span>
<span id="cb194-1971"><a href="#cb194-1971" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(SSP), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-1972"><a href="#cb194-1972" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb194-1973"><a href="#cb194-1973" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-1974"><a href="#cb194-1974" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb194-1975"><a href="#cb194-1975" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb194-1976"><a href="#cb194-1976" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_text_npc</span>(<span class="fu">aes</span>(<span class="at">npcx =</span> <span class="st">"center"</span>,</span>
<span id="cb194-1977"><a href="#cb194-1977" aria-hidden="true" tabindex="-1"></a>                        <span class="at">npcy =</span> <span class="st">"top"</span>,</span>
<span id="cb194-1978"><a href="#cb194-1978" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> Year),</span>
<span id="cb194-1979"><a href="#cb194-1979" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb194-1980"><a href="#cb194-1980" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb194-1981"><a href="#cb194-1981" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1982"><a href="#cb194-1982" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1983"><a href="#cb194-1983" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1984"><a href="#cb194-1984" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-1985"><a href="#cb194-1985" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,</span>
<span id="cb194-1986"><a href="#cb194-1986" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">0</span>, </span>
<span id="cb194-1987"><a href="#cb194-1987" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">0</span>, </span>
<span id="cb194-1988"><a href="#cb194-1988" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">0</span>, </span>
<span id="cb194-1989"><a href="#cb194-1989" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"cm"</span>),</span>
<span id="cb194-1990"><a href="#cb194-1990" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb194-1991"><a href="#cb194-1991" aria-hidden="true" tabindex="-1"></a>            <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-1992"><a href="#cb194-1992" aria-hidden="true" tabindex="-1"></a>            <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb194-1993"><a href="#cb194-1993" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb194-1994"><a href="#cb194-1994" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb194-1995"><a href="#cb194-1995" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb194-1996"><a href="#cb194-1996" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">size =</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb194-1997"><a href="#cb194-1997" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">face =</span> <span class="st">"bold"</span>)) </span>
<span id="cb194-1998"><a href="#cb194-1998" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb194-1999"><a href="#cb194-1999" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-2000"><a href="#cb194-2000" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> (past_plot <span class="sc">+</span></span>
<span id="cb194-2001"><a href="#cb194-2001" aria-hidden="true" tabindex="-1"></a>             future_plot_list <span class="sc">+</span></span>
<span id="cb194-2002"><a href="#cb194-2002" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>,</span>
<span id="cb194-2003"><a href="#cb194-2003" aria-hidden="true" tabindex="-1"></a>                         <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="fl">1.8</span>,<span class="fu">length</span>(future_plot_list))))</span>
<span id="cb194-2004"><a href="#cb194-2004" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb194-2005"><a href="#cb194-2005" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb194-2006"><a href="#cb194-2006" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb194-2007"><a href="#cb194-2007" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.title.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb194-2008"><a href="#cb194-2008" aria-hidden="true" tabindex="-1"></a>  plot</span>
<span id="cb194-2009"><a href="#cb194-2009" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-2010"><a href="#cb194-2010" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-2011"><a href="#cb194-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2012"><a href="#cb194-2012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2013"><a href="#cb194-2013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2014"><a href="#cb194-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2015"><a href="#cb194-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2016"><a href="#cb194-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2017"><a href="#cb194-2017" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb194-2018"><a href="#cb194-2018" aria-hidden="true" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb194-2019"><a href="#cb194-2019" aria-hidden="true" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb194-2020"><a href="#cb194-2020" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">"GDH"</span>,</span>
<span id="cb194-2021"><a href="#cb194-2021" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">"Heat (in Growing Degree Hours)"</span>,</span>
<span id="cb194-2022"><a href="#cb194-2022" aria-hidden="true" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span>
<span id="cb194-2023"><a href="#cb194-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2024"><a href="#cb194-2024" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb194-2025"><a href="#cb194-2025" aria-hidden="true" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb194-2026"><a href="#cb194-2026" aria-hidden="true" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb194-2027"><a href="#cb194-2027" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">"Chill_Portions"</span>,</span>
<span id="cb194-2028"><a href="#cb194-2028" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">"Chill (in Chill Portions)"</span>,</span>
<span id="cb194-2029"><a href="#cb194-2029" aria-hidden="true" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span>
<span id="cb194-2030"><a href="#cb194-2030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2031"><a href="#cb194-2031" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb194-2032"><a href="#cb194-2032" aria-hidden="true" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb194-2033"><a href="#cb194-2033" aria-hidden="true" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb194-2034"><a href="#cb194-2034" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">"Frost_H"</span>,</span>
<span id="cb194-2035"><a href="#cb194-2035" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">"Frost duration (in hours)"</span>,</span>
<span id="cb194-2036"><a href="#cb194-2036" aria-hidden="true" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span>
<span id="cb194-2037"><a href="#cb194-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2038"><a href="#cb194-2038" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"C:/Users/Home/Documents/R Files/Trial Bookdown/data_New_York/Rochester_frost_plot.png"</span>, </span>
<span id="cb194-2039"><a href="#cb194-2039" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>,</span>
<span id="cb194-2040"><a href="#cb194-2040" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb194-2041"><a href="#cb194-2041" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb194-2042"><a href="#cb194-2042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2043"><a href="#cb194-2043" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2044"><a href="#cb194-2044" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-2045"><a href="#cb194-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2046"><a href="#cb194-2046" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 19: Chill model comparison</span></span>
<span id="cb194-2047"><a href="#cb194-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2048"><a href="#cb194-2048" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on chill model comparison*** </span></span>
<span id="cb194-2049"><a href="#cb194-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2050"><a href="#cb194-2050" aria-hidden="true" tabindex="-1"></a>1.Produce similar plots for the weather station you selected for earlier exercises.</span>
<span id="cb194-2051"><a href="#cb194-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2054"><a href="#cb194-2054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-2055"><a href="#cb194-2055" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb194-2056"><a href="#cb194-2056" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dormancyR) <span class="co">#didn't install</span></span>
<span id="cb194-2057"><a href="#cb194-2057" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb194-2058"><a href="#cb194-2058" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorRamps)</span>
<span id="cb194-2059"><a href="#cb194-2059" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb194-2060"><a href="#cb194-2060" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb194-2061"><a href="#cb194-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2062"><a href="#cb194-2062" aria-hidden="true" tabindex="-1"></a>SSPs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssp126"</span>, <span class="st">"ssp245"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span>)</span>
<span id="cb194-2063"><a href="#cb194-2063" aria-hidden="true" tabindex="-1"></a>Times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>)</span>
<span id="cb194-2064"><a href="#cb194-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2065"><a href="#cb194-2065" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb194-2066"><a href="#cb194-2066" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb194-2067"><a href="#cb194-2067" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"EduardoFernandezC/dormancyR"</span>)</span>
<span id="cb194-2068"><a href="#cb194-2068" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dormancyR)</span>
<span id="cb194-2069"><a href="#cb194-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2070"><a href="#cb194-2070" aria-hidden="true" tabindex="-1"></a>hourly_models <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">Chilling_units =</span> chilling_units,</span>
<span id="cb194-2071"><a href="#cb194-2071" aria-hidden="true" tabindex="-1"></a>     <span class="at">Low_chill =</span> low_chill_model,</span>
<span id="cb194-2072"><a href="#cb194-2072" aria-hidden="true" tabindex="-1"></a>     <span class="at">Modified_Utah =</span> modified_utah_model,</span>
<span id="cb194-2073"><a href="#cb194-2073" aria-hidden="true" tabindex="-1"></a>     <span class="at">North_Carolina =</span> north_carolina_model,</span>
<span id="cb194-2074"><a href="#cb194-2074" aria-hidden="true" tabindex="-1"></a>     <span class="at">Positive_Utah =</span> positive_utah_model,</span>
<span id="cb194-2075"><a href="#cb194-2075" aria-hidden="true" tabindex="-1"></a>     <span class="at">Chilling_Hours =</span> Chilling_Hours,</span>
<span id="cb194-2076"><a href="#cb194-2076" aria-hidden="true" tabindex="-1"></a>     <span class="at">Utah_Chill_Units =</span> Utah_Model,</span>
<span id="cb194-2077"><a href="#cb194-2077" aria-hidden="true" tabindex="-1"></a>     <span class="at">Chill_Portions =</span> Dynamic_Model)</span>
<span id="cb194-2078"><a href="#cb194-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2079"><a href="#cb194-2079" aria-hidden="true" tabindex="-1"></a>daily_models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Rate_of_Chill =</span> rate_of_chill,</span>
<span id="cb194-2080"><a href="#cb194-2080" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Chill_Days =</span> chill_days,</span>
<span id="cb194-2081"><a href="#cb194-2081" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Exponential_Chill =</span> exponential_chill,</span>
<span id="cb194-2082"><a href="#cb194-2082" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Triangular_Chill_Haninnen =</span> triangular_chill_1,</span>
<span id="cb194-2083"><a href="#cb194-2083" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Triangular_Chill_Legave =</span> triangular_chill_2)</span>
<span id="cb194-2084"><a href="#cb194-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2085"><a href="#cb194-2085" aria-hidden="true" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">names</span>(daily_models),</span>
<span id="cb194-2086"><a href="#cb194-2086" aria-hidden="true" tabindex="-1"></a>             <span class="fu">names</span>(hourly_models))</span>
<span id="cb194-2087"><a href="#cb194-2087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2088"><a href="#cb194-2088" aria-hidden="true" tabindex="-1"></a>model_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Rate of Chill"</span>,</span>
<span id="cb194-2089"><a href="#cb194-2089" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Chill Days"</span>,</span>
<span id="cb194-2090"><a href="#cb194-2090" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Exponential Chill"</span>,</span>
<span id="cb194-2091"><a href="#cb194-2091" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Triangular Chill (HÃ¤ninnen)"</span>,</span>
<span id="cb194-2092"><a href="#cb194-2092" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Triangular Chill (Legave)"</span>,</span>
<span id="cb194-2093"><a href="#cb194-2093" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Chilling Units"</span>,</span>
<span id="cb194-2094"><a href="#cb194-2094" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Low-Chill Chill Units"</span>,</span>
<span id="cb194-2095"><a href="#cb194-2095" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Modified Utah Chill Units"</span>,</span>
<span id="cb194-2096"><a href="#cb194-2096" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"North Carolina Chill Units"</span>,</span>
<span id="cb194-2097"><a href="#cb194-2097" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Positive Utah Chill Units"</span>,</span>
<span id="cb194-2098"><a href="#cb194-2098" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Chilling Hours"</span>,</span>
<span id="cb194-2099"><a href="#cb194-2099" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Utah Chill Units"</span>,</span>
<span id="cb194-2100"><a href="#cb194-2100" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Chill Portions"</span>)</span>
<span id="cb194-2101"><a href="#cb194-2101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2102"><a href="#cb194-2102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2103"><a href="#cb194-2103" aria-hidden="true" tabindex="-1"></a><span class="do">## data.frame(Metric=model_labels,'Function name'=metrics)</span></span>
<span id="cb194-2104"><a href="#cb194-2104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2105"><a href="#cb194-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2106"><a href="#cb194-2106" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Metric=</span>model_labels,<span class="st">'Function name'</span><span class="ot">=</span>metrics)</span>
<span id="cb194-2107"><a href="#cb194-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2108"><a href="#cb194-2108" aria-hidden="true" tabindex="-1"></a>Rochester_temps <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">"data_New_York/Rochester_temps.csv"</span>)</span>
<span id="cb194-2109"><a href="#cb194-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2110"><a href="#cb194-2110" aria-hidden="true" tabindex="-1"></a>Temps <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">"data_New_York"</span>,</span>
<span id="cb194-2111"><a href="#cb194-2111" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"all_past_temps"</span>)</span>
<span id="cb194-2112"><a href="#cb194-2112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2113"><a href="#cb194-2113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2114"><a href="#cb194-2114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2115"><a href="#cb194-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2116"><a href="#cb194-2116" aria-hidden="true" tabindex="-1"></a>Start_JDay <span class="ot">&lt;-</span> <span class="dv">305</span></span>
<span id="cb194-2117"><a href="#cb194-2117" aria-hidden="true" tabindex="-1"></a>End_JDay <span class="ot">&lt;-</span> <span class="dv">59</span></span>
<span id="cb194-2118"><a href="#cb194-2118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2119"><a href="#cb194-2119" aria-hidden="true" tabindex="-1"></a>daily_models_past_scenarios <span class="ot">&lt;-</span></span>
<span id="cb194-2120"><a href="#cb194-2120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tempResponse_list_daily</span>(Temps,</span>
<span id="cb194-2121"><a href="#cb194-2121" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Start_JDay =</span> Start_JDay,</span>
<span id="cb194-2122"><a href="#cb194-2122" aria-hidden="true" tabindex="-1"></a>                          <span class="at">End_JDay =</span> End_JDay,</span>
<span id="cb194-2123"><a href="#cb194-2123" aria-hidden="true" tabindex="-1"></a>                          <span class="at">models =</span> daily_models) <span class="co"># list of daily temperatures function for min and max temps</span></span>
<span id="cb194-2124"><a href="#cb194-2124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2125"><a href="#cb194-2125" aria-hidden="true" tabindex="-1"></a>daily_models_past_scenarios <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb194-2126"><a href="#cb194-2126" aria-hidden="true" tabindex="-1"></a>  daily_models_past_scenarios,</span>
<span id="cb194-2127"><a href="#cb194-2127" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) x[<span class="fu">which</span>(x<span class="sc">$</span>Perc_complete<span class="sc">&gt;</span><span class="dv">90</span>),]) <span class="co"># allows us to apply models</span></span>
<span id="cb194-2128"><a href="#cb194-2128" aria-hidden="true" tabindex="-1"></a><span class="co"># total of 99 seasons</span></span>
<span id="cb194-2129"><a href="#cb194-2129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2130"><a href="#cb194-2130" aria-hidden="true" tabindex="-1"></a>hourly_models_past_scenarios <span class="ot">&lt;-</span></span>
<span id="cb194-2131"><a href="#cb194-2131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tempResponse_daily_list</span>(Temps,</span>
<span id="cb194-2132"><a href="#cb194-2132" aria-hidden="true" tabindex="-1"></a>                          <span class="at">latitude =</span> <span class="fl">43.156</span>,</span>
<span id="cb194-2133"><a href="#cb194-2133" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Start_JDay =</span> Start_JDay,</span>
<span id="cb194-2134"><a href="#cb194-2134" aria-hidden="true" tabindex="-1"></a>                          <span class="at">End_JDay =</span> End_JDay,</span>
<span id="cb194-2135"><a href="#cb194-2135" aria-hidden="true" tabindex="-1"></a>                          <span class="at">models =</span> hourly_models,</span>
<span id="cb194-2136"><a href="#cb194-2136" aria-hidden="true" tabindex="-1"></a>                          <span class="at">misstolerance =</span> <span class="dv">10</span>) </span>
<span id="cb194-2137"><a href="#cb194-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2138"><a href="#cb194-2138" aria-hidden="true" tabindex="-1"></a>past_scenarios <span class="ot">&lt;-</span> daily_models_past_scenarios <span class="co"># combine the two models</span></span>
<span id="cb194-2139"><a href="#cb194-2139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2140"><a href="#cb194-2140" aria-hidden="true" tabindex="-1"></a>past_scenarios <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb194-2141"><a href="#cb194-2141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(past_scenarios),</span>
<span id="cb194-2142"><a href="#cb194-2142" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x)</span>
<span id="cb194-2143"><a href="#cb194-2143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(past_scenarios[[x]],</span>
<span id="cb194-2144"><a href="#cb194-2144" aria-hidden="true" tabindex="-1"></a>          hourly_models_past_scenarios[[x]][,<span class="fu">names</span>(hourly_models)]))</span>
<span id="cb194-2145"><a href="#cb194-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2146"><a href="#cb194-2146" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(past_scenarios) <span class="ot">&lt;-</span> <span class="fu">names</span>(daily_models_past_scenarios)</span>
<span id="cb194-2147"><a href="#cb194-2147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2148"><a href="#cb194-2148" aria-hidden="true" tabindex="-1"></a>daily_models_observed <span class="ot">&lt;-</span></span>
<span id="cb194-2149"><a href="#cb194-2149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tempResponse_daily</span>(Rochester_temps,</span>
<span id="cb194-2150"><a href="#cb194-2150" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Start_JDay =</span> Start_JDay,</span>
<span id="cb194-2151"><a href="#cb194-2151" aria-hidden="true" tabindex="-1"></a>                     <span class="at">End_JDay =</span> End_JDay,</span>
<span id="cb194-2152"><a href="#cb194-2152" aria-hidden="true" tabindex="-1"></a>                     <span class="at">models =</span> daily_models)</span>
<span id="cb194-2153"><a href="#cb194-2153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2154"><a href="#cb194-2154" aria-hidden="true" tabindex="-1"></a>daily_models_observed <span class="ot">&lt;-</span></span>
<span id="cb194-2155"><a href="#cb194-2155" aria-hidden="true" tabindex="-1"></a>  daily_models_observed[<span class="fu">which</span>(daily_models_observed<span class="sc">$</span>Perc_complete<span class="sc">&gt;</span><span class="dv">90</span>),]</span>
<span id="cb194-2156"><a href="#cb194-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2157"><a href="#cb194-2157" aria-hidden="true" tabindex="-1"></a>hourly_models_observed <span class="ot">&lt;-</span></span>
<span id="cb194-2158"><a href="#cb194-2158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tempResponse_daily_list</span>(Rochester_temps,</span>
<span id="cb194-2159"><a href="#cb194-2159" aria-hidden="true" tabindex="-1"></a>                          <span class="at">latitude=</span> <span class="fl">43.156</span>,</span>
<span id="cb194-2160"><a href="#cb194-2160" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Start_JDay =</span> Start_JDay,</span>
<span id="cb194-2161"><a href="#cb194-2161" aria-hidden="true" tabindex="-1"></a>                          <span class="at">End_JDay =</span> End_JDay,</span>
<span id="cb194-2162"><a href="#cb194-2162" aria-hidden="true" tabindex="-1"></a>                          <span class="at">models =</span> hourly_models,</span>
<span id="cb194-2163"><a href="#cb194-2163" aria-hidden="true" tabindex="-1"></a>                          <span class="at">misstolerance =</span> <span class="dv">10</span>)</span>
<span id="cb194-2164"><a href="#cb194-2164" aria-hidden="true" tabindex="-1"></a><span class="co"># run from here later</span></span>
<span id="cb194-2165"><a href="#cb194-2165" aria-hidden="true" tabindex="-1"></a>past_observed <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb194-2166"><a href="#cb194-2166" aria-hidden="true" tabindex="-1"></a>  daily_models_observed,</span>
<span id="cb194-2167"><a href="#cb194-2167" aria-hidden="true" tabindex="-1"></a>  hourly_models_observed[[<span class="dv">1</span>]][,<span class="fu">names</span>(hourly_models)]) </span>
<span id="cb194-2168"><a href="#cb194-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2169"><a href="#cb194-2169" aria-hidden="true" tabindex="-1"></a><span class="fu">save_temperature_scenarios</span>(past_scenarios,</span>
<span id="cb194-2170"><a href="#cb194-2170" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"data_New_York/future_climate"</span>,</span>
<span id="cb194-2171"><a href="#cb194-2171" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Rochester_multichill_305_59_historic"</span>)</span>
<span id="cb194-2172"><a href="#cb194-2172" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(past_observed,</span>
<span id="cb194-2173"><a href="#cb194-2173" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/future_climate/Rochester_multichill_305_59_observed.csv"</span>,</span>
<span id="cb194-2174"><a href="#cb194-2174" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb194-2175"><a href="#cb194-2175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2176"><a href="#cb194-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2177"><a href="#cb194-2177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2178"><a href="#cb194-2178" aria-hidden="true" tabindex="-1"></a>future_temps <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">"data_New_York/future_climate"</span>,<span class="st">"Rochester_future_"</span>)</span>
<span id="cb194-2179"><a href="#cb194-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2180"><a href="#cb194-2180" aria-hidden="true" tabindex="-1"></a>SSPs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssp126"</span>, <span class="st">"ssp245"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span>)</span>
<span id="cb194-2181"><a href="#cb194-2181" aria-hidden="true" tabindex="-1"></a>Times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>)</span>
<span id="cb194-2182"><a href="#cb194-2182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2183"><a href="#cb194-2183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2184"><a href="#cb194-2184" aria-hidden="true" tabindex="-1"></a>list_ssp <span class="ot">&lt;-</span></span>
<span id="cb194-2185"><a href="#cb194-2185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(future_temps), <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-2186"><a href="#cb194-2186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-2187"><a href="#cb194-2187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-2188"><a href="#cb194-2188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2189"><a href="#cb194-2189" aria-hidden="true" tabindex="-1"></a>list_gcm <span class="ot">&lt;-</span></span>
<span id="cb194-2190"><a href="#cb194-2190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(future_temps), <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-2191"><a href="#cb194-2191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-2192"><a href="#cb194-2192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-2193"><a href="#cb194-2193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2194"><a href="#cb194-2194" aria-hidden="true" tabindex="-1"></a>list_time <span class="ot">&lt;-</span></span>
<span id="cb194-2195"><a href="#cb194-2195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(future_temps), <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-2196"><a href="#cb194-2196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-2197"><a href="#cb194-2197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb194-2198"><a href="#cb194-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2199"><a href="#cb194-2199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2200"><a href="#cb194-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2201"><a href="#cb194-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2202"><a href="#cb194-2202" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(SSP <span class="cf">in</span> SSPs)</span>
<span id="cb194-2203"><a href="#cb194-2203" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(Time <span class="cf">in</span> Times)</span>
<span id="cb194-2204"><a href="#cb194-2204" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb194-2205"><a href="#cb194-2205" aria-hidden="true" tabindex="-1"></a>    Temps <span class="ot">&lt;-</span> future_temps[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span> list_time <span class="sc">==</span> Time]</span>
<span id="cb194-2206"><a href="#cb194-2206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(Temps) <span class="ot">&lt;-</span> list_gcm[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span> list_time <span class="sc">==</span> Time]</span>
<span id="cb194-2207"><a href="#cb194-2207" aria-hidden="true" tabindex="-1"></a>    daily_models_future_scenarios <span class="ot">&lt;-</span> <span class="fu">tempResponse_list_daily</span>(</span>
<span id="cb194-2208"><a href="#cb194-2208" aria-hidden="true" tabindex="-1"></a>      Temps,</span>
<span id="cb194-2209"><a href="#cb194-2209" aria-hidden="true" tabindex="-1"></a>      <span class="at">Start_JDay =</span> Start_JDay,</span>
<span id="cb194-2210"><a href="#cb194-2210" aria-hidden="true" tabindex="-1"></a>      <span class="at">End_JDay =</span> End_JDay,</span>
<span id="cb194-2211"><a href="#cb194-2211" aria-hidden="true" tabindex="-1"></a>      <span class="at">models =</span> daily_models)</span>
<span id="cb194-2212"><a href="#cb194-2212" aria-hidden="true" tabindex="-1"></a>    daily_models_future_scenarios<span class="ot">&lt;-</span><span class="fu">lapply</span>(</span>
<span id="cb194-2213"><a href="#cb194-2213" aria-hidden="true" tabindex="-1"></a>      daily_models_future_scenarios,</span>
<span id="cb194-2214"><a href="#cb194-2214" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x) x[<span class="fu">which</span>(x<span class="sc">$</span>Perc_complete<span class="sc">&gt;</span><span class="dv">90</span>),])</span>
<span id="cb194-2215"><a href="#cb194-2215" aria-hidden="true" tabindex="-1"></a>    hourly_models_future_scenarios<span class="ot">&lt;-</span></span>
<span id="cb194-2216"><a href="#cb194-2216" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tempResponse_daily_list</span>(</span>
<span id="cb194-2217"><a href="#cb194-2217" aria-hidden="true" tabindex="-1"></a>        Temps,</span>
<span id="cb194-2218"><a href="#cb194-2218" aria-hidden="true" tabindex="-1"></a>        <span class="at">latitude =</span> <span class="fl">43.156</span>,</span>
<span id="cb194-2219"><a href="#cb194-2219" aria-hidden="true" tabindex="-1"></a>        <span class="at">Start_JDay =</span> Start_JDay,</span>
<span id="cb194-2220"><a href="#cb194-2220" aria-hidden="true" tabindex="-1"></a>        <span class="at">End_JDay =</span> End_JDay,</span>
<span id="cb194-2221"><a href="#cb194-2221" aria-hidden="true" tabindex="-1"></a>        <span class="at">models=</span>hourly_models,</span>
<span id="cb194-2222"><a href="#cb194-2222" aria-hidden="true" tabindex="-1"></a>        <span class="at">misstolerance =</span> <span class="dv">10</span>)</span>
<span id="cb194-2223"><a href="#cb194-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2224"><a href="#cb194-2224" aria-hidden="true" tabindex="-1"></a>    future_scenarios <span class="ot">&lt;-</span> daily_models_future_scenarios</span>
<span id="cb194-2225"><a href="#cb194-2225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2226"><a href="#cb194-2226" aria-hidden="true" tabindex="-1"></a>    future_scenarios <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb194-2227"><a href="#cb194-2227" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(future_scenarios),</span>
<span id="cb194-2228"><a href="#cb194-2228" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x)</span>
<span id="cb194-2229"><a href="#cb194-2229" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(future_scenarios[[x]],</span>
<span id="cb194-2230"><a href="#cb194-2230" aria-hidden="true" tabindex="-1"></a>              hourly_models_future_scenarios[[x]][,<span class="fu">names</span>(hourly_models)]))</span>
<span id="cb194-2231"><a href="#cb194-2231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(future_scenarios)<span class="ot">&lt;-</span><span class="fu">names</span>(daily_models_future_scenarios)</span>
<span id="cb194-2232"><a href="#cb194-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2233"><a href="#cb194-2233" aria-hidden="true" tabindex="-1"></a>    chill<span class="ot">&lt;-</span>future_scenarios</span>
<span id="cb194-2234"><a href="#cb194-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2235"><a href="#cb194-2235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save_temperature_scenarios</span>(</span>
<span id="cb194-2236"><a href="#cb194-2236" aria-hidden="true" tabindex="-1"></a>      chill,</span>
<span id="cb194-2237"><a href="#cb194-2237" aria-hidden="true" tabindex="-1"></a>      <span class="st">"data_New_York/future_climate"</span>,</span>
<span id="cb194-2238"><a href="#cb194-2238" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Rochester_multichill_305_59_"</span>,Time,<span class="st">"_"</span>,SSP))</span>
<span id="cb194-2239"><a href="#cb194-2239" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-2240"><a href="#cb194-2240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2241"><a href="#cb194-2241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2242"><a href="#cb194-2242" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Make a heat map illustrating past and future changes in Safe Winter Chill, relative to a past scenario, for the 13 chill models used here</span>
<span id="cb194-2243"><a href="#cb194-2243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2246"><a href="#cb194-2246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-2247"><a href="#cb194-2247" aria-hidden="true" tabindex="-1"></a>chill_past_scenarios <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(</span>
<span id="cb194-2248"><a href="#cb194-2248" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data_New_York/future_climate"</span>,</span>
<span id="cb194-2249"><a href="#cb194-2249" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Rochester_multichill_305_59_historic"</span>)</span>
<span id="cb194-2250"><a href="#cb194-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2251"><a href="#cb194-2251" aria-hidden="true" tabindex="-1"></a>chill_observed <span class="ot">&lt;-</span> </span>
<span id="cb194-2252"><a href="#cb194-2252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_tab</span>(<span class="st">"data_New_York/future_climate/Rochester_multichill_305_59_observed.csv"</span>)</span>
<span id="cb194-2253"><a href="#cb194-2253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2254"><a href="#cb194-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2255"><a href="#cb194-2255" aria-hidden="true" tabindex="-1"></a>chills <span class="ot">&lt;-</span> <span class="fu">make_climate_scenario</span>(chill_past_scenarios,</span>
<span id="cb194-2256"><a href="#cb194-2256" aria-hidden="true" tabindex="-1"></a>                                <span class="at">caption =</span> <span class="st">"Historic"</span>,</span>
<span id="cb194-2257"><a href="#cb194-2257" aria-hidden="true" tabindex="-1"></a>                                <span class="at">historic_data =</span> chill_observed,</span>
<span id="cb194-2258"><a href="#cb194-2258" aria-hidden="true" tabindex="-1"></a>                                <span class="at">time_series =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-2259"><a href="#cb194-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2260"><a href="#cb194-2260" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(SSP <span class="cf">in</span> SSPs)</span>
<span id="cb194-2261"><a href="#cb194-2261" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(Time <span class="cf">in</span> Times)</span>
<span id="cb194-2262"><a href="#cb194-2262" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb194-2263"><a href="#cb194-2263" aria-hidden="true" tabindex="-1"></a>    chill <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(</span>
<span id="cb194-2264"><a href="#cb194-2264" aria-hidden="true" tabindex="-1"></a>      <span class="st">"data_New_York/future_climate"</span>,</span>
<span id="cb194-2265"><a href="#cb194-2265" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Rochester_multichill_305_59_"</span>,Time,<span class="st">"_"</span>,SSP))</span>
<span id="cb194-2266"><a href="#cb194-2266" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp126"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP1"</span></span>
<span id="cb194-2267"><a href="#cb194-2267" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp245"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP2"</span></span>
<span id="cb194-2268"><a href="#cb194-2268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp370"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP3"</span>    </span>
<span id="cb194-2269"><a href="#cb194-2269" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">"ssp585"</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">"SSP5"</span>    </span>
<span id="cb194-2270"><a href="#cb194-2270" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Time <span class="sc">==</span> <span class="st">"2050"</span>) Time_caption <span class="ot">&lt;-</span> <span class="st">"2050"</span></span>
<span id="cb194-2271"><a href="#cb194-2271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Time <span class="sc">==</span> <span class="st">"2085"</span>) Time_caption <span class="ot">&lt;-</span> <span class="st">"2085"</span></span>
<span id="cb194-2272"><a href="#cb194-2272" aria-hidden="true" tabindex="-1"></a>    chills <span class="ot">&lt;-</span> <span class="fu">make_climate_scenario</span>(chill,</span>
<span id="cb194-2273"><a href="#cb194-2273" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">caption =</span> <span class="fu">c</span>(SSPcaption,</span>
<span id="cb194-2274"><a href="#cb194-2274" aria-hidden="true" tabindex="-1"></a>                                                Time_caption),</span>
<span id="cb194-2275"><a href="#cb194-2275" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">add_to =</span> chills) </span>
<span id="cb194-2276"><a href="#cb194-2276" aria-hidden="true" tabindex="-1"></a>} <span class="co"># 8 future scenarios</span></span>
<span id="cb194-2277"><a href="#cb194-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2278"><a href="#cb194-2278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2279"><a href="#cb194-2279" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_climate_scenarios</span>(chills,</span>
<span id="cb194-2280"><a href="#cb194-2280" aria-hidden="true" tabindex="-1"></a>                       <span class="at">metric=</span><span class="st">"Rate_of_Chill"</span>,</span>
<span id="cb194-2281"><a href="#cb194-2281" aria-hidden="true" tabindex="-1"></a>                       <span class="at">metric_label=</span><span class="st">"Rate of Chill"</span>,</span>
<span id="cb194-2282"><a href="#cb194-2282" aria-hidden="true" tabindex="-1"></a>                       <span class="at">year_name=</span><span class="st">"End_Year"</span>)</span>
<span id="cb194-2283"><a href="#cb194-2283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2284"><a href="#cb194-2284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2285"><a href="#cb194-2285" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(chills))</span>
<span id="cb194-2286"><a href="#cb194-2286" aria-hidden="true" tabindex="-1"></a>   {ch <span class="ot">&lt;-</span> chills[[i]]</span>
<span id="cb194-2287"><a href="#cb194-2287" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(ch<span class="sc">$</span>caption[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">"Historic"</span>)</span>
<span id="cb194-2288"><a href="#cb194-2288" aria-hidden="true" tabindex="-1"></a>     {GCMs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"none"</span>,<span class="fu">length</span>(<span class="fu">names</span>(ch<span class="sc">$</span>data)))</span>
<span id="cb194-2289"><a href="#cb194-2289" aria-hidden="true" tabindex="-1"></a>      SSPs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"none"</span>,<span class="fu">length</span>(<span class="fu">names</span>(ch<span class="sc">$</span>data)))</span>
<span id="cb194-2290"><a href="#cb194-2290" aria-hidden="true" tabindex="-1"></a>      Years <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ch<span class="sc">$</span>labels)</span>
<span id="cb194-2291"><a href="#cb194-2291" aria-hidden="true" tabindex="-1"></a>      Scenario <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Historic"</span>,</span>
<span id="cb194-2292"><a href="#cb194-2292" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">length</span>(<span class="fu">names</span>(ch<span class="sc">$</span>data)))} <span class="cf">else</span></span>
<span id="cb194-2293"><a href="#cb194-2293" aria-hidden="true" tabindex="-1"></a>                        {GCMs <span class="ot">&lt;-</span> <span class="fu">names</span>(ch<span class="sc">$</span>data)</span>
<span id="cb194-2294"><a href="#cb194-2294" aria-hidden="true" tabindex="-1"></a>                        SSPs <span class="ot">&lt;-</span> <span class="fu">rep</span>(ch<span class="sc">$</span>caption[<span class="dv">1</span>],</span>
<span id="cb194-2295"><a href="#cb194-2295" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">length</span>(<span class="fu">names</span>(ch<span class="sc">$</span>data)))</span>
<span id="cb194-2296"><a href="#cb194-2296" aria-hidden="true" tabindex="-1"></a>                        Years <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">as.numeric</span>(ch<span class="sc">$</span>caption[<span class="dv">2</span>]),</span>
<span id="cb194-2297"><a href="#cb194-2297" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">length</span>(<span class="fu">names</span>(ch<span class="sc">$</span>data)))</span>
<span id="cb194-2298"><a href="#cb194-2298" aria-hidden="true" tabindex="-1"></a>                        Scenario <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Future"</span>,</span>
<span id="cb194-2299"><a href="#cb194-2299" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">length</span>(<span class="fu">names</span>(ch<span class="sc">$</span>data)))}</span>
<span id="cb194-2300"><a href="#cb194-2300" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">names</span>(ch<span class="sc">$</span>data))</span>
<span id="cb194-2301"><a href="#cb194-2301" aria-hidden="true" tabindex="-1"></a>     {<span class="cf">for</span>(met <span class="cf">in</span> metrics)</span>
<span id="cb194-2302"><a href="#cb194-2302" aria-hidden="true" tabindex="-1"></a>       {temp_res <span class="ot">&lt;-</span></span>
<span id="cb194-2303"><a href="#cb194-2303" aria-hidden="true" tabindex="-1"></a>         <span class="fu">data.frame</span>(<span class="at">Metric =</span> met,</span>
<span id="cb194-2304"><a href="#cb194-2304" aria-hidden="true" tabindex="-1"></a>                    <span class="at">GCM =</span> GCMs[<span class="fu">which</span>(nam <span class="sc">==</span> <span class="fu">names</span>(ch<span class="sc">$</span>data))],</span>
<span id="cb194-2305"><a href="#cb194-2305" aria-hidden="true" tabindex="-1"></a>                    <span class="at">SSP =</span> SSPs[<span class="fu">which</span>(nam <span class="sc">==</span> <span class="fu">names</span>(ch<span class="sc">$</span>data))],</span>
<span id="cb194-2306"><a href="#cb194-2306" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Year =</span> Years[<span class="fu">which</span>(nam <span class="sc">==</span> <span class="fu">names</span>(ch<span class="sc">$</span>data))],</span>
<span id="cb194-2307"><a href="#cb194-2307" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Result =</span> <span class="fu">quantile</span>(ch<span class="sc">$</span>data[[nam]][,met],<span class="fl">0.1</span>), <span class="co"># 10% quantile</span></span>
<span id="cb194-2308"><a href="#cb194-2308" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Scenario =</span> Scenario[<span class="fu">which</span>(nam <span class="sc">==</span> <span class="fu">names</span>(ch<span class="sc">$</span>data))])</span>
<span id="cb194-2309"><a href="#cb194-2309" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> nam <span class="sc">==</span> <span class="fu">names</span>(ch<span class="sc">$</span>data)[<span class="dv">1</span>] <span class="sc">&amp;</span> met <span class="sc">==</span> metrics[<span class="dv">1</span>])</span>
<span id="cb194-2310"><a href="#cb194-2310" aria-hidden="true" tabindex="-1"></a>         results <span class="ot">&lt;-</span> temp_res <span class="cf">else</span></span>
<span id="cb194-2311"><a href="#cb194-2311" aria-hidden="true" tabindex="-1"></a>           results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results,</span>
<span id="cb194-2312"><a href="#cb194-2312" aria-hidden="true" tabindex="-1"></a>                            temp_res)</span>
<span id="cb194-2313"><a href="#cb194-2313" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb194-2314"><a href="#cb194-2314" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb194-2315"><a href="#cb194-2315" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb194-2316"><a href="#cb194-2316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2317"><a href="#cb194-2317" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(met <span class="cf">in</span> metrics)</span>
<span id="cb194-2318"><a href="#cb194-2318" aria-hidden="true" tabindex="-1"></a>  results[<span class="fu">which</span>(results<span class="sc">$</span>Metric <span class="sc">==</span> met),<span class="st">"SWC"</span>] <span class="ot">&lt;-</span></span>
<span id="cb194-2319"><a href="#cb194-2319" aria-hidden="true" tabindex="-1"></a>    results[<span class="fu">which</span>(results<span class="sc">$</span>Metric <span class="sc">==</span> met),<span class="st">"Result"</span>]<span class="sc">/</span></span>
<span id="cb194-2320"><a href="#cb194-2320" aria-hidden="true" tabindex="-1"></a>      results[<span class="fu">which</span>(results<span class="sc">$</span>Metric <span class="sc">==</span> met <span class="sc">&amp;</span> results<span class="sc">$</span>Year <span class="sc">==</span> <span class="dv">1980</span>),</span>
<span id="cb194-2321"><a href="#cb194-2321" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Result"</span>]<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb194-2322"><a href="#cb194-2322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2323"><a href="#cb194-2323" aria-hidden="true" tabindex="-1"></a><span class="do">### please process until here before Thursday</span></span>
<span id="cb194-2324"><a href="#cb194-2324" aria-hidden="true" tabindex="-1"></a>......</span>
<span id="cb194-2325"><a href="#cb194-2325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2326"><a href="#cb194-2326" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">=</span> <span class="fu">range</span>(results<span class="sc">$</span>SWC)</span>
<span id="cb194-2327"><a href="#cb194-2327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2328"><a href="#cb194-2328" aria-hidden="true" tabindex="-1"></a>p_future <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(results[<span class="fu">which</span>(<span class="sc">!</span>results<span class="sc">$</span>GCM <span class="sc">==</span> <span class="st">"none"</span>),],</span>
<span id="cb194-2329"><a href="#cb194-2329" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(GCM,</span>
<span id="cb194-2330"><a href="#cb194-2330" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">factor</span>(Metric,</span>
<span id="cb194-2331"><a href="#cb194-2331" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> metrics),</span>
<span id="cb194-2332"><a href="#cb194-2332" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> SWC)) <span class="sc">+</span></span>
<span id="cb194-2333"><a href="#cb194-2333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span>
<span id="cb194-2334"><a href="#cb194-2334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2335"><a href="#cb194-2335" aria-hidden="true" tabindex="-1"></a>p_future</span>
<span id="cb194-2336"><a href="#cb194-2336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2337"><a href="#cb194-2337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2338"><a href="#cb194-2338" aria-hidden="true" tabindex="-1"></a>p_future <span class="ot">&lt;-</span></span>
<span id="cb194-2339"><a href="#cb194-2339" aria-hidden="true" tabindex="-1"></a>  p_future <span class="sc">+</span></span>
<span id="cb194-2340"><a href="#cb194-2340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(SSP <span class="sc">~</span> Year) </span>
<span id="cb194-2341"><a href="#cb194-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2342"><a href="#cb194-2342" aria-hidden="true" tabindex="-1"></a>p_future</span>
<span id="cb194-2343"><a href="#cb194-2343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2344"><a href="#cb194-2344" aria-hidden="true" tabindex="-1"></a>p_future <span class="ot">&lt;-</span></span>
<span id="cb194-2345"><a href="#cb194-2345" aria-hidden="true" tabindex="-1"></a>  p_future <span class="sc">+</span></span>
<span id="cb194-2346"><a href="#cb194-2346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-2347"><a href="#cb194-2347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb194-2348"><a href="#cb194-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2349"><a href="#cb194-2349" aria-hidden="true" tabindex="-1"></a>p_future</span>
<span id="cb194-2350"><a href="#cb194-2350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2351"><a href="#cb194-2351" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorRamps)</span>
<span id="cb194-2352"><a href="#cb194-2352" aria-hidden="true" tabindex="-1"></a>p_future <span class="ot">&lt;-</span></span>
<span id="cb194-2353"><a href="#cb194-2353" aria-hidden="true" tabindex="-1"></a>  p_future <span class="sc">+</span></span>
<span id="cb194-2354"><a href="#cb194-2354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">matlab.like</span>(<span class="dv">15</span>)),</span>
<span id="cb194-2355"><a href="#cb194-2355" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> scales<span class="sc">::</span>percent,</span>
<span id="cb194-2356"><a href="#cb194-2356" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> rng)</span>
<span id="cb194-2357"><a href="#cb194-2357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2358"><a href="#cb194-2358" aria-hidden="true" tabindex="-1"></a>p_future</span>
<span id="cb194-2359"><a href="#cb194-2359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2360"><a href="#cb194-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2361"><a href="#cb194-2361" aria-hidden="true" tabindex="-1"></a>p_future <span class="ot">&lt;-</span></span>
<span id="cb194-2362"><a href="#cb194-2362" aria-hidden="true" tabindex="-1"></a>  p_future  <span class="sc">+</span></span>
<span id="cb194-2363"><a href="#cb194-2363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">75</span>, </span>
<span id="cb194-2364"><a href="#cb194-2364" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb194-2365"><a href="#cb194-2365" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-2366"><a href="#cb194-2366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Change in</span><span class="sc">\n</span><span class="st">Safe Winter Chill</span><span class="sc">\n</span><span class="st">since 1975"</span>) <span class="sc">+</span></span>
<span id="cb194-2367"><a href="#cb194-2367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> model_labels) <span class="sc">+</span></span>
<span id="cb194-2368"><a href="#cb194-2368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Chill metric"</span>)</span>
<span id="cb194-2369"><a href="#cb194-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2370"><a href="#cb194-2370" aria-hidden="true" tabindex="-1"></a>p_future</span>
<span id="cb194-2371"><a href="#cb194-2371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2372"><a href="#cb194-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2373"><a href="#cb194-2373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2374"><a href="#cb194-2374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2375"><a href="#cb194-2375" aria-hidden="true" tabindex="-1"></a>p_past<span class="ot">&lt;-</span></span>
<span id="cb194-2376"><a href="#cb194-2376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(results[<span class="fu">which</span>(results<span class="sc">$</span>GCM <span class="sc">==</span> <span class="st">"none"</span>),],</span>
<span id="cb194-2377"><a href="#cb194-2377" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(Year,</span>
<span id="cb194-2378"><a href="#cb194-2378" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">factor</span>(Metric, </span>
<span id="cb194-2379"><a href="#cb194-2379" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels=</span>metrics),</span>
<span id="cb194-2380"><a href="#cb194-2380" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SWC)) <span class="sc">+</span></span>
<span id="cb194-2381"><a href="#cb194-2381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span>
<span id="cb194-2382"><a href="#cb194-2382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2383"><a href="#cb194-2383" aria-hidden="true" tabindex="-1"></a>p_past<span class="ot">&lt;-</span></span>
<span id="cb194-2384"><a href="#cb194-2384" aria-hidden="true" tabindex="-1"></a>  p_past <span class="sc">+</span></span>
<span id="cb194-2385"><a href="#cb194-2385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-2386"><a href="#cb194-2386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb194-2387"><a href="#cb194-2387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2388"><a href="#cb194-2388" aria-hidden="true" tabindex="-1"></a>p_past<span class="ot">&lt;-</span></span>
<span id="cb194-2389"><a href="#cb194-2389" aria-hidden="true" tabindex="-1"></a>  p_past <span class="sc">+</span></span>
<span id="cb194-2390"><a href="#cb194-2390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">matlab.like</span>(<span class="dv">15</span>)),</span>
<span id="cb194-2391"><a href="#cb194-2391" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> scales<span class="sc">::</span>percent,</span>
<span id="cb194-2392"><a href="#cb194-2392" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> rng)</span>
<span id="cb194-2393"><a href="#cb194-2393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2394"><a href="#cb194-2394" aria-hidden="true" tabindex="-1"></a>p_past<span class="ot">&lt;-</span></span>
<span id="cb194-2395"><a href="#cb194-2395" aria-hidden="true" tabindex="-1"></a>  p_past <span class="sc">+</span></span>
<span id="cb194-2396"><a href="#cb194-2396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position =</span> <span class="st">"top"</span>)</span>
<span id="cb194-2397"><a href="#cb194-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2398"><a href="#cb194-2398" aria-hidden="true" tabindex="-1"></a>p_past<span class="ot">&lt;-</span></span>
<span id="cb194-2399"><a href="#cb194-2399" aria-hidden="true" tabindex="-1"></a>  p_past <span class="sc">+</span></span>
<span id="cb194-2400"><a href="#cb194-2400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Change in</span><span class="sc">\n</span><span class="st">Safe Winter Chill</span><span class="sc">\n</span><span class="st">since 1975"</span>) <span class="sc">+</span></span>
<span id="cb194-2401"><a href="#cb194-2401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> model_labels) <span class="sc">+</span></span>
<span id="cb194-2402"><a href="#cb194-2402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Chill metric"</span>)</span>
<span id="cb194-2403"><a href="#cb194-2403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2404"><a href="#cb194-2404" aria-hidden="true" tabindex="-1"></a>p_past</span>
<span id="cb194-2405"><a href="#cb194-2405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2406"><a href="#cb194-2406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2407"><a href="#cb194-2407" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb194-2408"><a href="#cb194-2408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2409"><a href="#cb194-2409" aria-hidden="true" tabindex="-1"></a>chill_comp_plot<span class="ot">&lt;-</span></span>
<span id="cb194-2410"><a href="#cb194-2410" aria-hidden="true" tabindex="-1"></a>  (p_past <span class="sc">+</span></span>
<span id="cb194-2411"><a href="#cb194-2411" aria-hidden="true" tabindex="-1"></a>     p_future <span class="sc">+</span></span>
<span id="cb194-2412"><a href="#cb194-2412" aria-hidden="true" tabindex="-1"></a>     <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>,</span>
<span id="cb194-2413"><a href="#cb194-2413" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb194-2414"><a href="#cb194-2414" aria-hidden="true" tabindex="-1"></a>                 <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))) <span class="sc">&amp;</span></span>
<span id="cb194-2415"><a href="#cb194-2415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb194-2416"><a href="#cb194-2416" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-2417"><a href="#cb194-2417" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb194-2418"><a href="#cb194-2418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2419"><a href="#cb194-2419" aria-hidden="true" tabindex="-1"></a>chill_comp_plot</span>
<span id="cb194-2420"><a href="#cb194-2420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2421"><a href="#cb194-2421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2422"><a href="#cb194-2422" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Produce an animated line plot of your results (summarizing Safe Winter Chill across all the GCMs).</span>
<span id="cb194-2423"><a href="#cb194-2423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2426"><a href="#cb194-2426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb194-2427"><a href="#cb194-2427" aria-hidden="true" tabindex="-1"></a>hist_results <span class="ot">&lt;-</span> results[<span class="fu">which</span>(results<span class="sc">$</span>GCM <span class="sc">==</span> <span class="st">"none"</span>),]</span>
<span id="cb194-2428"><a href="#cb194-2428" aria-hidden="true" tabindex="-1"></a>hist_results<span class="sc">$</span>SSP <span class="ot">&lt;-</span> <span class="st">"SSP1"</span></span>
<span id="cb194-2429"><a href="#cb194-2429" aria-hidden="true" tabindex="-1"></a>hist_results_2 <span class="ot">&lt;-</span> hist_results</span>
<span id="cb194-2430"><a href="#cb194-2430" aria-hidden="true" tabindex="-1"></a>hist_results_2<span class="sc">$</span>SSP <span class="ot">&lt;-</span> <span class="st">"SSP2"</span></span>
<span id="cb194-2431"><a href="#cb194-2431" aria-hidden="true" tabindex="-1"></a>hist_results_3 <span class="ot">&lt;-</span> hist_results</span>
<span id="cb194-2432"><a href="#cb194-2432" aria-hidden="true" tabindex="-1"></a>hist_results_3<span class="sc">$</span>SSP <span class="ot">&lt;-</span> <span class="st">"SSP3"</span></span>
<span id="cb194-2433"><a href="#cb194-2433" aria-hidden="true" tabindex="-1"></a>hist_results_4 <span class="ot">&lt;-</span> hist_results</span>
<span id="cb194-2434"><a href="#cb194-2434" aria-hidden="true" tabindex="-1"></a>hist_results_4<span class="sc">$</span>SSP <span class="ot">&lt;-</span> <span class="st">"SSP5"</span></span>
<span id="cb194-2435"><a href="#cb194-2435" aria-hidden="true" tabindex="-1"></a>hist_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(hist_results,</span>
<span id="cb194-2436"><a href="#cb194-2436" aria-hidden="true" tabindex="-1"></a>                      hist_results_2,</span>
<span id="cb194-2437"><a href="#cb194-2437" aria-hidden="true" tabindex="-1"></a>                      hist_results_3,</span>
<span id="cb194-2438"><a href="#cb194-2438" aria-hidden="true" tabindex="-1"></a>                      hist_results_4)</span>
<span id="cb194-2439"><a href="#cb194-2439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2440"><a href="#cb194-2440" aria-hidden="true" tabindex="-1"></a>future_results <span class="ot">&lt;-</span> results[<span class="fu">which</span>(<span class="sc">!</span>results<span class="sc">$</span>GCM <span class="sc">==</span> <span class="st">"none"</span>),]</span>
<span id="cb194-2441"><a href="#cb194-2441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2442"><a href="#cb194-2442" aria-hidden="true" tabindex="-1"></a>GCM_aggregate <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(</span>
<span id="cb194-2443"><a href="#cb194-2443" aria-hidden="true" tabindex="-1"></a>  future_results<span class="sc">$</span>SWC,</span>
<span id="cb194-2444"><a href="#cb194-2444" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span><span class="fu">list</span>(future_results<span class="sc">$</span>Metric,</span>
<span id="cb194-2445"><a href="#cb194-2445" aria-hidden="true" tabindex="-1"></a>          future_results<span class="sc">$</span>SSP,</span>
<span id="cb194-2446"><a href="#cb194-2446" aria-hidden="true" tabindex="-1"></a>          future_results<span class="sc">$</span>Year),</span>
<span id="cb194-2447"><a href="#cb194-2447" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN=</span>mean)</span>
<span id="cb194-2448"><a href="#cb194-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2449"><a href="#cb194-2449" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(GCM_aggregate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Metric"</span>,</span>
<span id="cb194-2450"><a href="#cb194-2450" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"SSP"</span>,</span>
<span id="cb194-2451"><a href="#cb194-2451" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Year"</span>,</span>
<span id="cb194-2452"><a href="#cb194-2452" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"SWC"</span>)</span>
<span id="cb194-2453"><a href="#cb194-2453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2454"><a href="#cb194-2454" aria-hidden="true" tabindex="-1"></a>SSP_Time_series<span class="ot">&lt;-</span><span class="fu">rbind</span>(hist_results[,<span class="fu">c</span>(<span class="st">"Metric"</span>,</span>
<span id="cb194-2455"><a href="#cb194-2455" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"SSP"</span>,</span>
<span id="cb194-2456"><a href="#cb194-2456" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Year"</span>,</span>
<span id="cb194-2457"><a href="#cb194-2457" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"SWC"</span>)],</span>
<span id="cb194-2458"><a href="#cb194-2458" aria-hidden="true" tabindex="-1"></a>                       GCM_aggregate)</span>
<span id="cb194-2459"><a href="#cb194-2459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2460"><a href="#cb194-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2461"><a href="#cb194-2461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2462"><a href="#cb194-2462" aria-hidden="true" tabindex="-1"></a>SSP_Time_series<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(SSP_Time_series<span class="sc">$</span>Year)</span>
<span id="cb194-2463"><a href="#cb194-2463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2464"><a href="#cb194-2464" aria-hidden="true" tabindex="-1"></a>chill_change_plot<span class="ot">&lt;-</span></span>
<span id="cb194-2465"><a href="#cb194-2465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> SSP_Time_series,</span>
<span id="cb194-2466"><a href="#cb194-2466" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> Year,</span>
<span id="cb194-2467"><a href="#cb194-2467" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> SWC,</span>
<span id="cb194-2468"><a href="#cb194-2468" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="fu">factor</span>(Metric,</span>
<span id="cb194-2469"><a href="#cb194-2469" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> metrics))) <span class="sc">+</span></span>
<span id="cb194-2470"><a href="#cb194-2470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb194-2471"><a href="#cb194-2471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>SSP,</span>
<span id="cb194-2472"><a href="#cb194-2472" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-2473"><a href="#cb194-2473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-2474"><a href="#cb194-2474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">col =</span> <span class="st">"Change in</span><span class="sc">\n</span><span class="st">Safe Winter Chill</span><span class="sc">\n</span><span class="st">since 1980"</span>) <span class="sc">+</span></span>
<span id="cb194-2475"><a href="#cb194-2475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> model_labels) <span class="sc">+</span></span>
<span id="cb194-2476"><a href="#cb194-2476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb194-2477"><a href="#cb194-2477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb194-2478"><a href="#cb194-2478" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb194-2479"><a href="#cb194-2479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Safe Winter Chill"</span>)</span>
<span id="cb194-2480"><a href="#cb194-2480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2481"><a href="#cb194-2481" aria-hidden="true" tabindex="-1"></a>chill_change_plot</span>
<span id="cb194-2482"><a href="#cb194-2482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2483"><a href="#cb194-2483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2484"><a href="#cb194-2484" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb194-2485"><a href="#cb194-2485" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gifski)</span>
<span id="cb194-2486"><a href="#cb194-2486" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(png)</span>
<span id="cb194-2487"><a href="#cb194-2487" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(transformr)</span>
<span id="cb194-2488"><a href="#cb194-2488" aria-hidden="true" tabindex="-1"></a>ccp<span class="ot">&lt;-</span>chill_change_plot <span class="sc">+</span></span>
<span id="cb194-2489"><a href="#cb194-2489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_reveal</span>(Year)</span>
<span id="cb194-2490"><a href="#cb194-2490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2491"><a href="#cb194-2491" aria-hidden="true" tabindex="-1"></a><span class="co"># trying out different numbers of frames per second</span></span>
<span id="cb194-2492"><a href="#cb194-2492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2493"><a href="#cb194-2493" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(ccp, <span class="at">fps=</span><span class="dv">1</span>)</span>
<span id="cb194-2494"><a href="#cb194-2494" aria-hidden="true" tabindex="-1"></a><span class="fu">anim_save</span>(<span class="st">"data_New_York/chill_comparison_animation_1.gif"</span>,</span>
<span id="cb194-2495"><a href="#cb194-2495" aria-hidden="true" tabindex="-1"></a>          <span class="at">animation =</span> <span class="fu">last_animation</span>())</span>
<span id="cb194-2496"><a href="#cb194-2496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2497"><a href="#cb194-2497" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(ccp, <span class="at">fps=</span><span class="dv">100</span>)</span>
<span id="cb194-2498"><a href="#cb194-2498" aria-hidden="true" tabindex="-1"></a><span class="fu">anim_save</span>(<span class="st">"data_New_York/chill_comparison_animation_100.gif"</span>,</span>
<span id="cb194-2499"><a href="#cb194-2499" aria-hidden="true" tabindex="-1"></a>          <span class="at">animation =</span> <span class="fu">last_animation</span>())</span>
<span id="cb194-2500"><a href="#cb194-2500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="tree_phenology_assignment_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>