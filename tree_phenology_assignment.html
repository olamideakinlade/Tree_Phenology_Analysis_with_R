<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Olamide Akinlade">
<title>Tree Phenology Assignment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="tree_phenology_assignment_files/libs/clipboard/clipboard.min.js"></script>
<script src="tree_phenology_assignment_files/libs/quarto-html/quarto.js"></script>
<script src="tree_phenology_assignment_files/libs/quarto-html/popper.min.js"></script>
<script src="tree_phenology_assignment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tree_phenology_assignment_files/libs/quarto-html/anchor.min.js"></script>
<link href="tree_phenology_assignment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tree_phenology_assignment_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tree_phenology_assignment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tree_phenology_assignment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tree_phenology_assignment_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><style>html{ scroll-behavior: smooth; }</style>
<script src="tree_phenology_assignment_files/libs/kePrint-0.0.1/kePrint.js"></script><link href="tree_phenology_assignment_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#chapter-3-tree-phenology-analysis" id="toc-chapter-3-tree-phenology-analysis" class="nav-link active" data-scroll-target="#chapter-3-tree-phenology-analysis">Chapter 3: Tree Phenology Analysis</a>
  <ul>
<li>
<a href="#tree-dormancy" id="toc-tree-dormancy" class="nav-link" data-scroll-target="#tree-dormancy">1.1 Tree Dormancy</a>
  <ul>
<li><a href="#dormancy-phases" id="toc-dormancy-phases" class="nav-link" data-scroll-target="#dormancy-phases">1.1.1 Dormancy Phases</a></li>
  <li><a href="#physological-processes-that-regulate-dormancy" id="toc-physological-processes-that-regulate-dormancy" class="nav-link" data-scroll-target="#physological-processes-that-regulate-dormancy">1.1.2 Physological processes that regulate dormancy</a></li>
  </ul>
</li>
  <li><a href="#exercises-on-tree-dormancy" id="toc-exercises-on-tree-dormancy" class="nav-link" data-scroll-target="#exercises-on-tree-dormancy"><strong><em>Exercises on Tree Dormancy</em></strong></a></li>
  </ul>
</li>
  <li><a href="#chapter-4-climate-change-and-impact-projection" id="toc-chapter-4-climate-change-and-impact-projection" class="nav-link" data-scroll-target="#chapter-4-climate-change-and-impact-projection">Chapter 4: Climate Change and impact projection</a></li>
  <li>
<a href="#drivers-of-climate-change-include" id="toc-drivers-of-climate-change-include" class="nav-link" data-scroll-target="#drivers-of-climate-change-include">1.1 Drivers of Climate change include:</a>
  <ul>
<li><a href="#exercises-on-climate-change" id="toc-exercises-on-climate-change" class="nav-link" data-scroll-target="#exercises-on-climate-change"><strong><em>Exercises on Climate Change</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-5-winter-chill-projections" id="toc-chapter-5-winter-chill-projections" class="nav-link" data-scroll-target="#chapter-5-winter-chill-projections">Chapter 5: Winter Chill Projections</a>
  <ul>
<li><a href="#exercises-on-past-chill-projections" id="toc-exercises-on-past-chill-projections" class="nav-link" data-scroll-target="#exercises-on-past-chill-projections"><strong><em>Exercises on past chill projections</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-6-manual-chill-analysis" id="toc-chapter-6-manual-chill-analysis" class="nav-link" data-scroll-target="#chapter-6-manual-chill-analysis">Chapter 6: Manual Chill Analysis</a>
  <ul>
<li><a href="#computing-chilling-hours-from-hourly-temperature-data" id="toc-computing-chilling-hours-from-hourly-temperature-data" class="nav-link" data-scroll-target="#computing-chilling-hours-from-hourly-temperature-data"><strong><em>Computing Chilling Hours from Hourly Temperature data</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-7-winter-chill-projections" id="toc-chapter-7-winter-chill-projections" class="nav-link" data-scroll-target="#chapter-7-winter-chill-projections">Chapter 7: Winter Chill Projections</a>
  <ul>
<li><a href="#exercises-chill-models" id="toc-exercises-chill-models" class="nav-link" data-scroll-target="#exercises-chill-models"><strong><em>Exercises Chill Models</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-8-making-hourly-temperatures" id="toc-chapter-8-making-hourly-temperatures" class="nav-link" data-scroll-target="#chapter-8-making-hourly-temperatures">Chapter 8: Making Hourly Temperatures</a>
  <ul>
<li><a href="#exercises-on-hourly" id="toc-exercises-on-hourly" class="nav-link" data-scroll-target="#exercises-on-hourly"><strong><em>Exercises on hourly</em></strong></a></li>
  </ul>
</li>
  <li><a href="#sunset-time-and-daylength-at-rochester-latitude-43.15n-over-the" id="toc-sunset-time-and-daylength-at-rochester-latitude-43.15n-over-the" class="nav-link" data-scroll-target="#sunset-time-and-daylength-at-rochester-latitude-43.15n-over-the">sunset time and daylength at Rochester (Latitude: 43.15°N) over the</a></li>
  <li>
<a href="#chapter-9-some-useful-tools-in-r" id="toc-chapter-9-some-useful-tools-in-r" class="nav-link" data-scroll-target="#chapter-9-some-useful-tools-in-r">Chapter 9: Some Useful tools in R</a>
  <ul>
<li><a href="#exercises-on-useful-r-tools" id="toc-exercises-on-useful-r-tools" class="nav-link" data-scroll-target="#exercises-on-useful-r-tools"><strong><em>Exercises on useful R tools</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-10-getting-temperature-data" id="toc-chapter-10-getting-temperature-data" class="nav-link" data-scroll-target="#chapter-10-getting-temperature-data">Chapter 10: Getting temperature data</a>
  <ul>
<li><a href="#exercises-on-getting-temperature-data" id="toc-exercises-on-getting-temperature-data" class="nav-link" data-scroll-target="#exercises-on-getting-temperature-data"><strong><em>Exercises on getting temperature data</em></strong></a></li>
  </ul>
</li>
  <li>
<a href="#chapter-11-getting-temperature-data" id="toc-chapter-11-getting-temperature-data" class="nav-link" data-scroll-target="#chapter-11-getting-temperature-data">Chapter 11: Getting temperature data</a>
  <ul>
<li><a href="#exercises-on-getting-temperature-data-1" id="toc-exercises-on-getting-temperature-data-1" class="nav-link" data-scroll-target="#exercises-on-getting-temperature-data-1"><strong><em>Exercises on getting temperature data</em></strong></a></li>
  </ul>
</li>
  </ul></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Tree Phenology Assignment</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Olamide Akinlade </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  


</header><hr>
<section id="chapter-3-tree-phenology-analysis" class="level1"><h1>Chapter 3: Tree Phenology Analysis</h1>
<section id="tree-dormancy" class="level2"><h2 class="anchored" data-anchor-id="tree-dormancy">1.1 Tree Dormancy</h2>
<p>Winter dormancy may be defined as a trade-off between the length of the growing season and the protection against winter damage. To enter dormancy, vegetative growth is stopped in the late summer or early autumn and the shoots are converted into buds, where the shoot apical meristems are protected by tightly closed and hardened bud scales.</p>
<section id="dormancy-phases" class="level3"><h3 class="anchored" data-anchor-id="dormancy-phases">1.1.1 Dormancy Phases</h3>
<ol type="1">
<li>Dormancy Establishment</li>
<li>Endodormancy 1: Ecodormancy</li>
<li>Growth resumption</li>
</ol></section><section id="physological-processes-that-regulate-dormancy" class="level3"><h3 class="anchored" data-anchor-id="physological-processes-that-regulate-dormancy">1.1.2 Physological processes that regulate dormancy</h3>
<ol type="a">
<li>Transport</li>
<li>Photohormones</li>
<li>Genetics</li>
<li>Carbohydrates dynamics</li>
</ol></section></section><section id="exercises-on-tree-dormancy" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-tree-dormancy"><strong><em>Exercises on Tree Dormancy</em></strong></h2>
<ol type="1">
<li>Put yourself in the place of a breeder who wants to calculate the temperature requirements of a newly released cultivar. Which method will you use to calculate the chilling and forcing periods? Please justify your answer</li>
</ol>
<p>Statistical method is recommended to calculate the temperature requirements (chilling and forcing periods) of a newly released cultivar. This involves using partial least square regression analysis for daily temperatures over a continuous period.</p>
<ol start="2" type="1">
<li>Which are the advantages (2) of the BBCH scale compared with earlier scales?</li>
</ol>
<p>Two advantages of the BBCH scale over traditional scale include: a. It was developed in a general frame for all the species b. It covers the whole development of a plant.</p>
<ol start="3" type="1">
<li>Classify the following phenological stages of sweet cherry according to the BBCH scale:</li>
</ol>
<p>Phenological stages of cherry + Image 1: 51</p>
<ul>
<li><p>Image 2: 63</p></li>
<li><p>Image 3: 87</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="%5CUsers%5CHome%5CDownloads%5Cphoto_5834526249584805567_y.jpg" class="img-fluid figure-img"></p>
<figcaption>Stages of Cherry</figcaption></figure>
</div>
<hr></section></section><section id="chapter-4-climate-change-and-impact-projection" class="level1"><h1>Chapter 4: Climate Change and impact projection</h1>
</section><section id="drivers-of-climate-change-include" class="level1"><h1>1.1 Drivers of Climate change include:</h1>
<ul>
<li>Sun: Warms the earth through radiation. It is an important driver of climate change on geological timescales, but not of recent climate change.</li>
<li>Aerosols: They are largely dusts. Suspensions of liquid, solid, or mixed particles with highly variable chemical composition and size distribution.</li>
<li>Clouds: Can have both cooling and warming effect.</li>
<li>Ozone: Surface (tropospheric) ozone: constituent of smog, health hazard (bad ozone). Greenhouse gas: presence in the stratosphere has a warming effect. Destroyed by chlorofluorocarbons (CFCs).</li>
<li>Surface albedo: Reflection of radiation by the land surface. Light surfaces (e.g.&nbsp;ice, snow) reflect almost all radiation, dark surfaces (ocean, dark soil, forest) very little.</li>
<li>Greenhouse gases: Atmospheric gases that trap heat on Earth. Greenhouse effects warms the planet.</li>
<li>Long-term drivers:</li>
</ul>
<section id="exercises-on-climate-change" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-climate-change"><strong><em>Exercises on Climate Change</em></strong></h2>
<ol type="1">
<li>List the main drivers of climate change at the decade to century scale, and briefly explain the mechanism through which the currently most important driver affects our climate.</li>
</ol>
<ul>
<li>Sun</li>
<li>Aerosols</li>
<li>Clouds</li>
<li>Ozone</li>
<li>Surface albedo</li>
<li>Greenhouse gases</li>
<li>Long-term drivers</li>
</ul>
<p>Most important: <strong>GHGs</strong> <strong>Greenhouse effect</strong> + Raises Earth’s mean temperature: +14°C instead of -18°C without GHGs! + Major GHGs: water vapor, CO2 (carbon dioxide), CH4 (methane), N2O (nitrous oxide)</p>
<ol type="1">
<li>Explain briefly what is special about temperature dynamics of recent decades, and why we have good reasons to be concerned.</li>
</ol>
<p>Since 1901 strong warming (almost) everywhere on Earth.Up to 8°C warmer than the 2003-2018 average. Precipitation anomalies (relative to median prec.) for Cologne/Bonn weather station. Some years with dry springs/summer.</p>
<ol type="1">
<li>What does the abbreviation ‘RCP’ stand for, how are RCPs defined, and what is their role in projecting future climates? Representative Concentration Pathways (RCPs). It is a new greenhouse forcing scenarios in the IPCC‘s5th Assessment Report. From RCP to inputs for climate change impact models.</li>
</ol>
<p>Roles of RCP:</p>
<ol type="1">
<li>Briefly describe the 4 climate impact projection methods described in the fourth video.</li>
</ol>
<ul>
<li>Statistical models</li>
<li>Species distribution modeling</li>
<li>Process-based models</li>
<li>Climate analogue analysis</li>
</ul>
<hr></section></section><section id="chapter-5-winter-chill-projections" class="level1"><h1>Chapter 5: Winter Chill Projections</h1>
<section id="exercises-on-past-chill-projections" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-past-chill-projections"><strong><em>Exercises on past chill projections</em></strong></h2>
<ol type="1">
<li>Sketch out three data access and processing challenges that had to be overcome in order to produce chill projections with state-of-the-art methodology.</li>
</ol>
<ul>
<li>Accessing Climate Data for Specific Locations: Previous climate datasets like AFRICLIM and ClimateWizard only provided large-scale data. To get weather data for specific locations without downloading too much extra information, an API was created to quickly access data for single sites</li>
<li>Converting Daily to Hourly Temperature Data: Chill models need hourly temperature data, but many databases only give daily averages. Early methods for converting daily to hourly data weren’t very good, especially in areas with unique temperatures. Improved algorithms were developed to estimate hourly temperatures more accurately from daily data</li>
<li>Handling Large Volumes of Climate Model Outputs: Studying different climate futures involves dealing with a lot of data from many climate models, which can be hard to manage. To handle this large amount of data effectively, workflows were streamlined and selective processing techniques were used</li>
</ul>
<ol start="2" type="1">
<li>Outline, in your understanding, the basic steps that are necessary to make such projections.</li>
</ol>
<ul>
<li>Data Collection and Calibration: collect historical weather data and use it to calibrate a weather generator for realistic temperature simulations</li>
<li>Model Selection and Scenario Setup: choose relevant climate models and emission scenarios to explore various future climates</li>
<li>Generate Temperature Projections: downscale climate data, converting it to daily or hourly temperatures as needed for chill calculations</li>
<li>Chill Calculation: apply chill models to estimate chill accumulation across different climate scenarios</li>
<li>Analysis and Visualization: compare chill projections across models and scenarios and visualize the findings</li>
<li>Interpretation: validate projections with observed data where possible and assess agricultural impacts and adaptation needs</li>
</ul>
<hr></section></section><section id="chapter-6-manual-chill-analysis" class="level1"><h1>Chapter 6: Manual Chill Analysis</h1>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Winters_hours_gaps</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Year Month Day Hour Temp_gaps   Temp
1  2008     3   3   10    15.127 15.127
2  2008     3   3   11    17.153 17.153
3  2008     3   3   12    18.699 18.699
4  2008     3   3   13    18.699 18.699
5  2008     3   3   14    18.842 18.842
6  2008     3   3   15    19.508 19.508
7  2008     3   3   16    19.318 19.318
8  2008     3   3   17    17.701 17.701
9  2008     3   3   18    15.414 15.414
10 2008     3   3   19    12.727 12.727</code></pre>
</div>
</div>
<section id="computing-chilling-hours-from-hourly-temperature-data" class="level2"><h2 class="anchored" data-anchor-id="computing-chilling-hours-from-hourly-temperature-data"><strong><em>Computing Chilling Hours from Hourly Temperature data</em></strong></h2>
<ol type="1">
<li>Write a basic function that calculates warm hours (&gt;25°C)</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hourtemps</span> <span class="op">&lt;-</span> <span class="va">Winters_hours_gaps</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Year"</span>,</span>
<span>                                   <span class="st">"Month"</span>,</span>
<span>                                   <span class="st">"Day"</span>,</span>
<span>                                   <span class="st">"Hour"</span>,</span>
<span>                                   <span class="st">"Temp"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hourtemps</span><span class="op">[</span>, <span class="st">"Chilling_Hour"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">hourtemps</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">hourtemps</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&lt;=</span> <span class="fl">7.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>#calculate warm hours</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WH</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">hourtemps</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">hourtemps</span><span class="op">[</span>, <span class="st">"Warm_Hour"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">hourtemps</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&gt;=</span> <span class="fl">25</span> </span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Apply this function to the Winters_hours_gaps dataset</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">WH</span><span class="op">(</span><span class="va">hourtemps</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Year Month Day Hour   Temp Chilling_Hour Warm_Hour
1  2008     3   3   10 15.127         FALSE     FALSE
2  2008     3   3   11 17.153         FALSE     FALSE
3  2008     3   3   12 18.699         FALSE     FALSE
4  2008     3   3   13 18.699         FALSE     FALSE
5  2008     3   3   14 18.842         FALSE     FALSE
6  2008     3   3   15 19.508         FALSE     FALSE
7  2008     3   3   16 19.318         FALSE     FALSE
8  2008     3   3   17 17.701         FALSE     FALSE
9  2008     3   3   18 15.414         FALSE     FALSE
10 2008     3   3   19 12.727         FALSE     FALSE
11 2008     3   3   20 10.369         FALSE     FALSE
12 2008     3   3   21  9.706         FALSE     FALSE
13 2008     3   3   22  9.040         FALSE     FALSE
14 2008     3   3   23  7.920         FALSE     FALSE
15 2008     3   4    0  6.535          TRUE     FALSE
16 2008     3   4    1  6.687          TRUE     FALSE
17 2008     3   4    2  8.767         FALSE     FALSE
18 2008     3   4    3  9.139         FALSE     FALSE
19 2008     3   4    4  6.788          TRUE     FALSE
20 2008     3   4    5  5.076          TRUE     FALSE
21 2008     3   4    6  3.985          TRUE     FALSE
22 2008     3   4    7  3.775          TRUE     FALSE
23 2008     3   4    8 10.001         FALSE     FALSE
24 2008     3   4    9 13.690         FALSE     FALSE
25 2008     3   4   10 15.796         FALSE     FALSE
26 2008     3   4   11 18.081         FALSE     FALSE
27 2008     3   4   12 19.888         FALSE     FALSE
28 2008     3   4   13 20.841         FALSE     FALSE
29 2008     3   4   14 21.366         FALSE     FALSE
30 2008     3   4   15 21.867         FALSE     FALSE
31 2008     3   4   16 21.604         FALSE     FALSE
32 2008     3   4   17 20.079         FALSE     FALSE
33 2008     3   4   18 17.344         FALSE     FALSE
34 2008     3   4   19 13.930         FALSE     FALSE
35 2008     3   4   20 11.929         FALSE     FALSE
36 2008     3   4   21 10.761         FALSE     FALSE
37 2008     3   4   22  9.854         FALSE     FALSE
38 2008     3   4   23  9.706         FALSE     FALSE
39 2008     3   5    0  7.619         FALSE     FALSE
40 2008     3   5    1  9.509         FALSE     FALSE
41 2008     3   5    2 10.883         FALSE     FALSE
42 2008     3   5    3 12.147         FALSE     FALSE
43 2008     3   5    4 12.606         FALSE     FALSE
44 2008     3   5    5 11.880         FALSE     FALSE
45 2008     3   5    6 11.589         FALSE     FALSE
46 2008     3   5    7 11.029         FALSE     FALSE
47 2008     3   5    8 12.171         FALSE     FALSE
48 2008     3   5    9 14.074         FALSE     FALSE
49 2008     3   5   10 15.533         FALSE     FALSE
50 2008     3   5   11 17.605         FALSE     FALSE</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">$</span><span class="va">Warm_Hour</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Extend this function, so that it can take start and end dates as inputs and sums up warm hours between these dates</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sum_WH</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hourtemps</span>, </span>
<span>                   <span class="va">startYEARMODAHO</span>,</span>
<span>                   <span class="va">endYEARMODAHO</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">{</span><span class="va">hourtemps</span><span class="op">[</span>,<span class="st">"Warm_Hour"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">hourtemps</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&gt;</span> <span class="fl">25</span></span>
<span></span>
<span><span class="va">startYear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">startYEARMODAHO</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">startMonth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">startYEARMODAHO</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">startDay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">startYEARMODAHO</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">startHour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">startYEARMODAHO</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">endYear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">endYEARMODAHO</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">endMonth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">endYEARMODAHO</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">endDay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">endYEARMODAHO</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">endHour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">endYEARMODAHO</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Start_Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">$</span><span class="va">Year</span> <span class="op">==</span> <span class="va">startYear</span> <span class="op">&amp;</span></span>
<span>                    <span class="va">hourtemps</span><span class="op">$</span><span class="va">Month</span> <span class="op">==</span> <span class="va">startMonth</span> <span class="op">&amp;</span></span>
<span>                    <span class="va">hourtemps</span><span class="op">$</span><span class="va">Day</span> <span class="op">==</span> <span class="va">startDay</span> <span class="op">&amp;</span></span>
<span>                    <span class="va">hourtemps</span><span class="op">$</span><span class="va">Hour</span> <span class="op">==</span> <span class="va">startHour</span><span class="op">)</span></span>
<span></span>
<span><span class="va">End_Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">$</span><span class="va">Year</span> <span class="op">==</span> <span class="va">endYear</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">hourtemps</span><span class="op">$</span><span class="va">Month</span> <span class="op">==</span> <span class="va">endMonth</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">hourtemps</span><span class="op">$</span><span class="va">Day</span> <span class="op">==</span> <span class="va">endDay</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">hourtemps</span><span class="op">$</span><span class="va">Hour</span> <span class="op">==</span> <span class="va">endHour</span><span class="op">)</span></span>
<span></span>
<span><span class="va">WHs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">hourtemps</span><span class="op">$</span><span class="va">Warm_Hour</span><span class="op">[</span><span class="va">Start_Date</span><span class="op">:</span><span class="va">End_Date</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">WHs</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>#Example</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sum_WH</span><span class="op">(</span><span class="va">Winters_hours_gaps</span>, startYEARMODAHO <span class="op">=</span> <span class="fl">2008070100</span>, </span>
<span>                           endYEARMODAHO <span class="op">=</span> <span class="fl">2008073123</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 306</code></pre>
</div>
</div>
<hr></section></section><section id="chapter-7-winter-chill-projections" class="level1"><h1>Chapter 7: Winter Chill Projections</h1>
<section id="exercises-chill-models" class="level2"><h2 class="anchored" data-anchor-id="exercises-chill-models"><strong><em>Exercises Chill Models</em></strong></h2>
<ol type="1">
<li>Run the chilling() function on the Winters_hours_gap dataset #chilling function</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">july</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/chilling.html">chilling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_JDay.html">make_JDay</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">)</span>,</span>
<span>                   Start_JDay <span class="op">=</span> <span class="fl">183</span>, </span>
<span>                   End_JDay <span class="op">=</span> <span class="fl">213</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol type="1">
<li>Create your own temperature-weighting chill model using the step_model() function #step model</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">0</span>,  <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>,   <span class="fl">10</span><span class="op">)</span>,  </span>
<span>  upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>    <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>   <span class="fl">0</span>, <span class="fl">1</span>,  <span class="fl">2</span>,  <span class="fl">3</span>,  <span class="fl">2</span>,  <span class="fl">1</span>,    <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span>, position <span class="op">=</span> <span class="st">"left"</span>, font_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">lower</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">weight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-1000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">custom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/step_model.html">step_model</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">custom</span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">$</span><span class="va">Temp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  [1]  0  0  0  0  0  0  0  0  0  0  0 NA NA NA NA NA NA NA NA NA NA NA NA NA NA
 [26] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
 [51] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
 [76] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
</div>
</div>
<ol type="1">
<li>Run this model on the Winters_hours_gaps dataset using the tempResponse() function.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/tempResponse.html">tempResponse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_JDay.html">make_JDay</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">)</span>,</span>
<span>                       Start_JDay <span class="op">=</span> <span class="fl">183</span>,</span>
<span>                       End_JDay <span class="op">=</span> <span class="fl">213</span>,</span>
<span>                       models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Chill_Portions <span class="op">=</span> <span class="va">Dynamic_Model</span>, </span>
<span>                                     GDH <span class="op">=</span> <span class="va">GDH</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span>, </span>
<span>                position <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>                font_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Season</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">End_year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Season_days</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Data_days</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Perc_complete</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Chill_Portions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GDH</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">2007/2008</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9771.642</td>
</tr></tbody>
</table>
</div>
</div>
<hr></section></section><section id="chapter-8-making-hourly-temperatures" class="level1"><h1>Chapter 8: Making Hourly Temperatures</h1>
<section id="exercises-on-hourly" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-hourly"><strong><em>Exercises on hourly</em></strong></h2>
<ol type="1">
<li>Choose a location of interest, find out its latitude and produce plots of daily sunrise, sunset and daylength</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="sunset-time-and-daylength-at-rochester-latitude-43.15n-over-the" class="level1"><h1>sunset time and daylength at Rochester (Latitude: 43.15°N) over the</h1>
<p>course of the year.</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/daylength.html">daylength</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">43</span>,</span>
<span>                  JDay <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">365</span><span class="op">)</span></span>
<span><span class="va">Days_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    JDay <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">365</span>,</span>
<span>    Sunrise <span class="op">=</span> <span class="va">Days</span><span class="op">$</span><span class="va">Sunrise</span>,</span>
<span>    Sunset <span class="op">=</span> <span class="va">Days</span><span class="op">$</span><span class="va">Sunset</span>,</span>
<span>    Daylength <span class="op">=</span> <span class="va">Days</span><span class="op">$</span><span class="va">Daylength</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">Days_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">Days_df</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Sunrise</span><span class="op">:</span><span class="va">Daylength</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">Days_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">JDay</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Time of Day / Daylength (Hours)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>Produce an hourly dataset, based on idealized daily curves, for the KA_weather dataset (included in chillR)</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/stack_hourly_temps.html">stack_hourly_temps</a></span><span class="op">(</span><span class="va">KA_weather</span>, latitude <span class="op">=</span> <span class="fl">43</span><span class="op">)</span> <span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      Year Month Day Tmax Tmin JDay Hour     Temp
1     1998     1   1  8.2  5.1    1    0 5.100000
4535  1998     1   1  8.2  5.1    1    1 5.100000
9069  1998     1   1  8.2  5.1    1    2 5.100000
13603 1998     1   1  8.2  5.1    1    3 5.100000
18137 1998     1   1  8.2  5.1    1    4 5.100000
22671 1998     1   1  8.2  5.1    1    5 5.100000
27205 1998     1   1  8.2  5.1    1    6 5.100000
31739 1998     1   1  8.2  5.1    1    7 5.100000
36273 1998     1   1  8.2  5.1    1    8 5.494357
40807 1998     1   1  8.2  5.1    1    9 6.215506
45341 1998     1   1  8.2  5.1    1   10 6.872424
49875 1998     1   1  8.2  5.1    1   11 7.427284
54409 1998     1   1  8.2  5.1    1   12 7.848137
58943 1998     1   1  8.2  5.1    1   13 8.110750
63477 1998     1   1  8.2  5.1    1   14 8.200000
68011 1998     1   1  8.2  5.1    1   15 8.110750
72545 1998     1   1  8.2  5.1    1   16 7.848137
77079 1998     1   1  8.2  5.1    1   17 7.275663
81613 1998     1   1  8.2  5.1    1   18 6.780076
86147 1998     1   1  8.2  5.1    1   19 6.455465</code></pre>
</div>
</div>
<ol type="1">
<li>Produce empirical temperature curve parameters for the Winters_hours_gaps dataset, and use them to predict hourly values from daily temperatures (this is very similar to the example above,but please make sure you understand what’s going on).</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">empi_curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/Empirical_daily_temperature_curve.html">Empirical_daily_temperature_curve</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Winters_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/make_all_day_table.html">make_all_day_table</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span>, input_timestep <span class="op">=</span> <span class="st">"hour"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr></section><section id="chapter-9-some-useful-tools-in-r" class="level1"><h1>Chapter 9: Some Useful tools in R</h1>
<section id="exercises-on-useful-r-tools" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-useful-r-tools"><strong><em>Exercises on useful R tools</em></strong></h2>
<ol type="1">
<li>Based on the Winters_hours_gaps dataset, use magrittr pipes and functions of the tidyverse to accomplish the following:</li>
</ol>
<ul>
<li>Convert the dataset into a tibble</li>
<li>Select only the top 10 rows of the dataset</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ lubridate 1.9.3     ✔ stringr   1.5.1
✔ purrr     1.0.2     ✔ tibble    3.2.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter()          masks stats::filter()
✖ kableExtra::group_rows() masks dplyr::group_rows()
✖ dplyr::lag()             masks stats::lag()
✖ lubridate::leap_year()   masks chillR::leap_year()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">Winters_hours_gaps</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">WHG</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
    Year Month   Day  Hour Temp_gaps  Temp
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1  2008     3     3    10      15.1  15.1
 2  2008     3     3    11      17.2  17.2
 3  2008     3     3    12      18.7  18.7
 4  2008     3     3    13      18.7  18.7
 5  2008     3     3    14      18.8  18.8
 6  2008     3     3    15      19.5  19.5
 7  2008     3     3    16      19.3  19.3
 8  2008     3     3    17      17.7  17.7
 9  2008     3     3    18      15.4  15.4
10  2008     3     3    19      12.7  12.7</code></pre>
</div>
</div>
<ul>
<li>Convert the tibble to a long format, with separate rows for Temp_gaps and Temp</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHGlong</span> <span class="op">&lt;-</span> <span class="va">WHG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">Temp_gaps</span><span class="op">:</span><span class="va">Temp</span><span class="op">)</span></span>
<span><span class="va">WHGlong</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 6
    Year Month   Day  Hour name      value
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;
 1  2008     3     3    10 Temp_gaps  15.1
 2  2008     3     3    10 Temp       15.1
 3  2008     3     3    11 Temp_gaps  17.2
 4  2008     3     3    11 Temp       17.2
 5  2008     3     3    12 Temp_gaps  18.7
 6  2008     3     3    12 Temp       18.7
 7  2008     3     3    13 Temp_gaps  18.7
 8  2008     3     3    13 Temp       18.7
 9  2008     3     3    14 Temp_gaps  18.8
10  2008     3     3    14 Temp       18.8
11  2008     3     3    15 Temp_gaps  19.5
12  2008     3     3    15 Temp       19.5
13  2008     3     3    16 Temp_gaps  19.3
14  2008     3     3    16 Temp       19.3
15  2008     3     3    17 Temp_gaps  17.7
16  2008     3     3    17 Temp       17.7
17  2008     3     3    18 Temp_gaps  15.4
18  2008     3     3    18 Temp       15.4
19  2008     3     3    19 Temp_gaps  12.7
20  2008     3     3    19 Temp       12.7</code></pre>
</div>
</div>
<ul>
<li>Use ggplot2 to plot Temp_gaps and Temp as facets (point or line plot)</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">WHGlong</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Hour</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">12</span>,colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Temperature (°C)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="tree_phenology_assignment_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Convert the dataset back to the wide format</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHGwide</span> <span class="op">&lt;-</span> <span class="va">WHGlong</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span><span class="va">WHGwide</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
    Year Month   Day  Hour Temp_gaps  Temp
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1  2008     3     3    10      15.1  15.1
 2  2008     3     3    11      17.2  17.2
 3  2008     3     3    12      18.7  18.7
 4  2008     3     3    13      18.7  18.7
 5  2008     3     3    14      18.8  18.8
 6  2008     3     3    15      19.5  19.5
 7  2008     3     3    16      19.3  19.3
 8  2008     3     3    17      17.7  17.7
 9  2008     3     3    18      15.4  15.4
10  2008     3     3    19      12.7  12.7</code></pre>
</div>
</div>
<ul>
<li>Select only the following columns: Year, Month, Day and Temp</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Month</span>, <span class="va">Day</span>, <span class="va">Temp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
    Year Month   Day  Temp
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1  2008     3     3  15.1
 2  2008     3     3  17.2
 3  2008     3     3  18.7
 4  2008     3     3  18.7
 5  2008     3     3  18.8
 6  2008     3     3  19.5
 7  2008     3     3  19.3
 8  2008     3     3  17.7
 9  2008     3     3  15.4
10  2008     3     3  12.7</code></pre>
</div>
</div>
<ul>
<li>Sort the dataset by the Temp column, in descending order</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Temp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
    Year Month   Day  Hour Temp_gaps  Temp
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1  2008     3     3    15      19.5  19.5
 2  2008     3     3    16      19.3  19.3
 3  2008     3     3    14      18.8  18.8
 4  2008     3     3    12      18.7  18.7
 5  2008     3     3    13      18.7  18.7
 6  2008     3     3    17      17.7  17.7
 7  2008     3     3    11      17.2  17.2
 8  2008     3     3    18      15.4  15.4
 9  2008     3     3    10      15.1  15.1
10  2008     3     3    19      12.7  12.7</code></pre>
</div>
</div>
<ol type="1">
<li>For the Winter_hours_gaps dataset, write a for loop to convert all temperatures (Temp column) to degrees Fahrenheit</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Temp</span> <span class="op">&lt;-</span> <span class="va">Winters_hours_gaps</span><span class="op">$</span><span class="va">Temp</span><span class="op">[</span><span class="fl">183</span><span class="op">:</span><span class="fl">213</span><span class="op">]</span> <span class="co"># JDay for July</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">Temp</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">Fahrenheit</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="fl">32</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">Fahrenheit</span><span class="op">)</span> </span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 57.9362
[1] 56.3828
[1] 56.0354
[1] 54.8654
[1] 46.481
[1] 44.7188
[1] 44.2184
[1] 45.3074
[1] 53.078
[1] 59.7884
[1] 64.0328
[1] 68.1422
[1] 68.5274
[1] 70.2014
[1] 68.7848
[1] 69.4706
[1] 70.5434
[1] 68.3132
[1] 62.6612
[1] 57.5924
[1] 54.9518
[1] 52.5092
[1] 51.1484
[1] 52.6406
[1] 57.074
[1] 56.9876
[1] 49.2044
[1] 47.2442
[1] 46.571
[1] 46.346
[1] 44.8556</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Execute the same operation with a function from the apply family</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">Winters_hours_gaps</span><span class="op">$</span><span class="va">Temp</span><span class="op">[</span><span class="fl">183</span><span class="op">:</span><span class="fl">213</span><span class="op">]</span></span>
<span></span>
<span><span class="va">fahrenheit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="fl">32</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fahrenheit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] 57.9362 56.3828 56.0354 54.8654 46.4810 44.7188 44.2184 45.3074 53.0780
[10] 59.7884 64.0328 68.1422 68.5274 70.2014 68.7848 69.4706 70.5434 68.3132
[19] 62.6612 57.5924 54.9518 52.5092 51.1484 52.6406 57.0740 56.9876 49.2044
[28] 47.2442 46.5710 46.3460 44.8556</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Now use the tidyverse function mutate to achieve the same outcome</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WHG_F</span> <span class="op">&lt;-</span> <span class="va">WHG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Temp_F <span class="op">=</span> <span class="va">Temp</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="fl">32</span><span class="op">)</span></span>
<span><span class="va">WHG_F</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
    Year Month   Day  Hour Temp_gaps  Temp Temp_F
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1  2008     3     3    10      15.1  15.1   59.2
 2  2008     3     3    11      17.2  17.2   62.9
 3  2008     3     3    12      18.7  18.7   65.7
 4  2008     3     3    13      18.7  18.7   65.7
 5  2008     3     3    14      18.8  18.8   65.9
 6  2008     3     3    15      19.5  19.5   67.1
 7  2008     3     3    16      19.3  19.3   66.8
 8  2008     3     3    17      17.7  17.7   63.9
 9  2008     3     3    18      15.4  15.4   59.7
10  2008     3     3    19      12.7  12.7   54.9</code></pre>
</div>
</div>
<hr></section></section><section id="chapter-10-getting-temperature-data" class="level1"><h1>Chapter 10: Getting temperature data</h1>
<section id="exercises-on-getting-temperature-data" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-getting-temperature-data"><strong><em>Exercises on getting temperature data</em></strong></h2>
<ol type="1">
<li>Choose a location of interest and find the 25 closest weather stations using the handle_gsod function</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">chillR</span><span class="op">)</span></span>
<span><span class="va">station_list_Rochester</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action<span class="op">=</span><span class="st">"list_stations"</span>,</span>
<span>                          location<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span><span class="op">)</span>,</span>
<span>                          time_interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1990</span>,<span class="fl">2020</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'magrittr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    set_names</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">station_list_Rochester</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span>, position <span class="op">=</span> <span class="st">"left"</span>, font_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">chillR_code</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">STATION.NAME</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CTRY</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Long</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BEGIN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">END</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Distance</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Overlap_years</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Perc_interval_covered</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">72529014768</td>
<td style="text-align: left;">GREATER ROCHESTER INTERNATIONAL AP</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.117</td>
<td style="text-align: right;">-77.675</td>
<td style="text-align: right;">19730101</td>
<td style="text-align: right;">20241103</td>
<td style="text-align: right;">7.11</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">99999914768</td>
<td style="text-align: left;">ROCHESTER MONROE CO ARPT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.117</td>
<td style="text-align: right;">-77.677</td>
<td style="text-align: right;">19480101</td>
<td style="text-align: right;">19721231</td>
<td style="text-align: right;">7.25</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72529599999</td>
<td style="text-align: left;">ROCHESTER COAST GUARD LIGHT STAT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.250</td>
<td style="text-align: right;">-77.600</td>
<td style="text-align: right;">19760926</td>
<td style="text-align: right;">19960701</td>
<td style="text-align: right;">11.13</td>
<td style="text-align: right;">6.50</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">99800999999</td>
<td style="text-align: left;">ROCHESTER</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.250</td>
<td style="text-align: right;">-77.583</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">11.22</td>
<td style="text-align: right;">13.00</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">99826799999</td>
<td style="text-align: left;">ROCHESTER</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.269</td>
<td style="text-align: right;">-77.626</td>
<td style="text-align: right;">20100101</td>
<td style="text-align: right;">20210114</td>
<td style="text-align: right;">13.41</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">99719099999</td>
<td style="text-align: left;">LAKE ONTARIO BUOY - 20NM NORTH NORTHEAST</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.620</td>
<td style="text-align: right;">-77.410</td>
<td style="text-align: right;">20080517</td>
<td style="text-align: right;">20081125</td>
<td style="text-align: right;">54.53</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72498899999</td>
<td style="text-align: left;">DANSVILLE MUNI</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.571</td>
<td style="text-align: right;">-77.713</td>
<td style="text-align: right;">20010811</td>
<td style="text-align: right;">20031231</td>
<td style="text-align: right;">65.11</td>
<td style="text-align: right;">2.39</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">72523094704</td>
<td style="text-align: left;">DANSVILLE/MUNICIPAL</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.571</td>
<td style="text-align: right;">-77.713</td>
<td style="text-align: right;">19730101</td>
<td style="text-align: right;">19850131</td>
<td style="text-align: right;">65.11</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">99999994704</td>
<td style="text-align: left;">DANSVILLE MUNI AP</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.571</td>
<td style="text-align: right;">-77.713</td>
<td style="text-align: right;">19490101</td>
<td style="text-align: right;">20001101</td>
<td style="text-align: right;">65.11</td>
<td style="text-align: right;">10.84</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">72498894704</td>
<td style="text-align: left;">DANSVILLE MUNICIPAL ARPT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.570</td>
<td style="text-align: right;">-77.714</td>
<td style="text-align: right;">20010102</td>
<td style="text-align: right;">20241030</td>
<td style="text-align: right;">65.23</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: right;">65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72523099999</td>
<td style="text-align: left;">DANSVILLE MUNICIPAL</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.567</td>
<td style="text-align: right;">-77.717</td>
<td style="text-align: right;">20020418</td>
<td style="text-align: right;">20041014</td>
<td style="text-align: right;">65.60</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">72519454778</td>
<td style="text-align: left;">PENN YAN AIRPORT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.644</td>
<td style="text-align: right;">-77.053</td>
<td style="text-align: right;">20060101</td>
<td style="text-align: right;">20241103</td>
<td style="text-align: right;">71.85</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9999994727</td>
<td style="text-align: left;">GENEVA SAMPSON AFB</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.750</td>
<td style="text-align: right;">-76.900</td>
<td style="text-align: right;">19520102</td>
<td style="text-align: right;">19560624</td>
<td style="text-align: right;">72.36</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">72519499999</td>
<td style="text-align: left;">PENN YAN</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.633</td>
<td style="text-align: right;">-77.050</td>
<td style="text-align: right;">19990114</td>
<td style="text-align: right;">20051231</td>
<td style="text-align: right;">72.97</td>
<td style="text-align: right;">6.97</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">71430099999</td>
<td style="text-align: left;">POINT PETRE (AUT) ONT</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.833</td>
<td style="text-align: right;">-77.150</td>
<td style="text-align: right;">19770611</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">84.27</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">71626899999</td>
<td style="text-align: left;">PT PETRE</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.833</td>
<td style="text-align: right;">-77.150</td>
<td style="text-align: right;">19770701</td>
<td style="text-align: right;">19800625</td>
<td style="text-align: right;">84.27</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72626899999</td>
<td style="text-align: left;">POINT PETRE (MARS)</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.833</td>
<td style="text-align: right;">-77.150</td>
<td style="text-align: right;">19750905</td>
<td style="text-align: right;">19770630</td>
<td style="text-align: right;">84.27</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">99596099999</td>
<td style="text-align: left;">PRINCE EDWARD PT</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.790</td>
<td style="text-align: right;">-76.870</td>
<td style="text-align: right;">19911018</td>
<td style="text-align: right;">20081123</td>
<td style="text-align: right;">92.49</td>
<td style="text-align: right;">17.10</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">99798999999</td>
<td style="text-align: left;">OLCOTT HARBOR</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.333</td>
<td style="text-align: right;">-78.717</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">92.85</td>
<td style="text-align: right;">13.00</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="even">
<td style="text-align: left;">72519599999</td>
<td style="text-align: left;">OSWEGO COAST GUARD STATION</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.470</td>
<td style="text-align: right;">-76.520</td>
<td style="text-align: right;">19760926</td>
<td style="text-align: right;">19960701</td>
<td style="text-align: right;">94.46</td>
<td style="text-align: right;">6.50</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">99726499999</td>
<td style="text-align: left;">9052030 - OSWEGO NY</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">43.460</td>
<td style="text-align: right;">-76.510</td>
<td style="text-align: right;">20041122</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">94.81</td>
<td style="text-align: right;">16.11</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="even">
<td style="text-align: left;">99999914733</td>
<td style="text-align: left;">BUFFALO BUFFALO ARPT</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.941</td>
<td style="text-align: right;">-78.736</td>
<td style="text-align: right;">19720101</td>
<td style="text-align: right;">19721231</td>
<td style="text-align: right;">95.30</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72528014733</td>
<td style="text-align: left;">BUFFALO NIAGARA INTERNATIONAL AIRPOR</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">42.940</td>
<td style="text-align: right;">-78.736</td>
<td style="text-align: right;">19420201</td>
<td style="text-align: right;">20241103</td>
<td style="text-align: right;">95.33</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">71431099999</td>
<td style="text-align: left;">COBOURG (AUT) ONT</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.950</td>
<td style="text-align: right;">-78.167</td>
<td style="text-align: right;">19770611</td>
<td style="text-align: right;">20241102</td>
<td style="text-align: right;">100.12</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">71626699999</td>
<td style="text-align: left;">COBOURG</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">43.950</td>
<td style="text-align: right;">-78.167</td>
<td style="text-align: right;">19770701</td>
<td style="text-align: right;">19800809</td>
<td style="text-align: right;">100.12</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">station_list_Rochester</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 10
   chillR_code STATION.NAME             CTRY    Lat  Long  BEGIN    END Distance
   &lt;chr&gt;       &lt;chr&gt;                    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1 72529014768 GREATER ROCHESTER INTER… US     43.1 -77.7 1.97e7 2.02e7     7.11
 2 99999914768 ROCHESTER MONROE CO ARPT US     43.1 -77.7 1.95e7 1.97e7     7.25
 3 72529599999 ROCHESTER COAST GUARD L… US     43.2 -77.6 1.98e7 2.00e7    11.1 
 4 99800999999 ROCHESTER                US     43.2 -77.6 2.01e7 2.02e7    11.2 
 5 99826799999 ROCHESTER                US     43.3 -77.6 2.01e7 2.02e7    13.4 
 6 99719099999 LAKE ONTARIO BUOY - 20N… US     43.6 -77.4 2.01e7 2.01e7    54.5 
 7 72498899999 DANSVILLE MUNI           US     42.6 -77.7 2.00e7 2.00e7    65.1 
 8 72523094704 DANSVILLE/MUNICIPAL      US     42.6 -77.7 1.97e7 1.99e7    65.1 
 9 99999994704 DANSVILLE MUNI AP        US     42.6 -77.7 1.95e7 2.00e7    65.1 
10 72498894704 DANSVILLE MUNICIPAL ARPT US     42.6 -77.7 2.00e7 2.02e7    65.2 
# ℹ 15 more rows
# ℹ 2 more variables: Overlap_years &lt;dbl&gt;, Perc_interval_covered &lt;dbl&gt;</code></pre>
</div>
</div>
<ol type="1">
<li>Download weather data for the most promising station on the list</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"download_weather"</span>,</span>
<span>                       location <span class="op">=</span> <span class="va">station_list_Rochester</span><span class="op">$</span><span class="va">chillR_code</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                       time_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1990</span>, <span class="fl">2020</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Loading data for 31 years from station 'GREATER ROCHESTER INTERNATIONAL AP'
================================================================================</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       STATION       DATE LATITUDE LONGITUDE ELEVATION
1  72529014768 1990-01-01 43.11723 -77.67539     164.5
2  72529014768 1990-01-02 43.11723 -77.67539     164.5
3  72529014768 1990-01-03 43.11723 -77.67539     164.5
4  72529014768 1990-01-04 43.11723 -77.67539     164.5
5  72529014768 1990-01-05 43.11723 -77.67539     164.5
6  72529014768 1990-01-06 43.11723 -77.67539     164.5
7  72529014768 1990-01-07 43.11723 -77.67539     164.5
8  72529014768 1990-01-08 43.11723 -77.67539     164.5
9  72529014768 1990-01-09 43.11723 -77.67539     164.5
10 72529014768 1990-01-10 43.11723 -77.67539     164.5
11 72529014768 1990-01-11 43.11723 -77.67539     164.5
12 72529014768 1990-01-12 43.11723 -77.67539     164.5
13 72529014768 1990-01-13 43.11723 -77.67539     164.5
14 72529014768 1990-01-14 43.11723 -77.67539     164.5
15 72529014768 1990-01-15 43.11723 -77.67539     164.5
16 72529014768 1990-01-16 43.11723 -77.67539     164.5
17 72529014768 1990-01-17 43.11723 -77.67539     164.5
18 72529014768 1990-01-18 43.11723 -77.67539     164.5
19 72529014768 1990-01-19 43.11723 -77.67539     164.5
20 72529014768 1990-01-20 43.11723 -77.67539     164.5
                                                                NAME TEMP
1  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 31.1
2  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 30.1
3  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 33.8
4  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 43.7
5  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 33.0
6  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 26.2
7  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 29.0
8  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 37.3
9  FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 36.7
10 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 36.5
11 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 34.3
12 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 28.7
13 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 16.3
14 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 23.5
15 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 35.7
16 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 41.5
17 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 45.4
18 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 46.8
19 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 29.2
20 FREDERICK DOUGLASS GREATER ROCHESTER INTERNATIONAL AIRPORT, NY US 28.3
   TEMP_ATTRIBUTES DEWP DEWP_ATTRIBUTES    SLP SLP_ATTRIBUTES   STP
1               24 25.0              24 1006.2             24 985.6
2               24 20.1              24 1022.9             24   1.8
3               24 22.0              24 1023.5             24   2.5
4               24 34.3              24 1012.1             24 991.5
5               24 26.3              24 1018.9             24 998.1
6               24 22.2              24 1018.1             24 997.0
7               24 20.6              24 1017.0             24 996.0
8               24 27.7              24 1012.2             24 991.5
9               24 27.4              24 1008.0             24 987.4
10              24 31.8              24 1002.7             24 982.3
11              24 29.2              24 1002.0             24 981.4
12              24 23.5              24  995.5             24 975.0
13              24 10.5              24 1015.8             24 994.6
14              24 15.0              24 1026.1             24   4.7
15              24 25.0              24 1020.2             24 999.2
16              24 37.0              24 1023.3             24   2.5
17              24 42.6              24 1020.9             24   0.2
18              24 42.4              24 1013.1             24 992.7
19              24 19.7              24 1027.7             24   6.6
20              24 21.1              24 1022.3             24   1.2
   STP_ATTRIBUTES VISIB VISIB_ATTRIBUTES WDSP WDSP_ATTRIBUTES MXSPD  GUST  MAX
1              24   9.6               24 15.2              24  21.0  27.0 44.1
2              24  14.8               24 13.7              24  19.0  28.9 36.0
3              24  16.4               24  6.5              24  11.1 999.9 44.1
4              24  15.2               24  9.2              24  17.1  27.0 46.9
5              24  15.6               24 10.0              24  15.0 999.9 48.0
6              24  11.7               24  8.5              24  18.1  25.1 35.1
7              24  16.9               24  9.1              24  20.0  25.1 43.0
8              24  14.0               24  7.9              24  15.9 999.9 44.1
9              24  12.6               24  8.2              24  12.0 999.9 45.0
10             24   7.0               24  7.8              24  15.9 999.9 41.0
11             24   8.9               24 11.9              24  25.1  34.0 39.9
12             24   5.9               24 17.3              24  22.9  34.0 39.9
13             24   8.3               24 14.5              24  21.0  25.1 34.0
14             24  11.2               24 10.3              24  18.1  25.1 25.0
15             24  12.1               24  8.2              24  15.9  22.9 43.0
16             24   6.4               24  8.0              24  14.0  20.0 50.0
17             24   4.1               24  6.5              24  12.0 999.9 55.0
18             24   9.8               24 12.9              24  17.1  22.0 55.9
19             24  15.8               24 10.6              24  17.1  25.1 36.0
20             24  13.8               24  4.0              24   6.0 999.9 35.1
   MAX_ATTRIBUTES  MIN MIN_ATTRIBUTES PRCP PRCP_ATTRIBUTES  SNDP FRSHTT
1                 25.0                0.20               G   2.8  11000
2               * 26.1                0.04               G   2.8      0
3               * 27.0                0.00               G   2.0      0
4               * 37.9                0.02               D   0.8  10000
5                 28.0                0.08               G 999.9  10000
6                 19.0                0.00               G 999.9 101000
7               * 15.1                0.02               C 999.9      0
8               * 28.9                0.00               D 999.9      0
9                 34.0                0.00               C 999.9  10000
10                33.1              * 0.08               G 999.9 111000
11                32.0                0.08               G 999.9 111000
12                21.0              * 0.08               G 999.9   1000
13                10.0                0.12               G   2.0   1000
14              * 18.0                0.00               G   0.8   1000
15              * 25.0                0.01               G   0.8  10000
16              * 37.0                0.00               G 999.9 110000
17              * 36.0                0.04               G 999.9 110000
18                36.0              * 0.35               G 999.9  10000
19              * 24.1                0.04               G 999.9   1000
20              * 23.0                0.00               G 999.9      0</code></pre>
</div>
</div>
<ol type="1">
<li>Convert the weather data into chillR format</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cleaned_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span><span class="va">weather</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cleaned_weather</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Date Year Month Day    Tmin   Tmax  Tmean  Prec
1  1990-01-01 1990     1   1  -3.889  6.722 -0.500 5.080
2  1990-01-02 1990     1   2  -3.278  2.222 -1.056 1.016
3  1990-01-03 1990     1   3  -2.778  6.722  1.000 0.000
4  1990-01-04 1990     1   4   3.278  8.278  6.500 0.508
5  1990-01-05 1990     1   5  -2.222  8.889  0.556 2.032
6  1990-01-06 1990     1   6  -7.222  1.722 -3.222 0.000
7  1990-01-07 1990     1   7  -9.389  6.111 -1.667 0.508
8  1990-01-08 1990     1   8  -1.722  6.722  2.944 0.000
9  1990-01-09 1990     1   9   1.111  7.222  2.611 0.000
10 1990-01-10 1990     1  10   0.611  5.000  2.500 2.032
11 1990-01-11 1990     1  11   0.000  4.389  1.278 2.032
12 1990-01-12 1990     1  12  -6.111  4.389 -1.833 2.032
13 1990-01-13 1990     1  13 -12.222  1.111 -8.722 3.048
14 1990-01-14 1990     1  14  -7.778 -3.889 -4.722 0.000
15 1990-01-15 1990     1  15  -3.889  6.111  2.056 0.254
16 1990-01-16 1990     1  16   2.778 10.000  5.278 0.000
17 1990-01-17 1990     1  17   2.222 12.778  7.444 1.016
18 1990-01-18 1990     1  18   2.222 13.278  8.222 8.890
19 1990-01-19 1990     1  19  -4.389  2.222 -1.556 1.016
20 1990-01-20 1990     1  20  -5.000  1.722 -2.056 0.000</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="st">"data_New_York"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in dir.create("data_New_York"): 'data_New_York' already exists</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">station_list_Rochester</span>,</span>
<span>          <span class="st">"data_New_York/station_list_Rochester.csv"</span>,</span>
<span>          row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">weather</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>          <span class="st">"data_New_York/Rochester_weather.csv"</span>,</span>
<span>          row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">cleaned_weather</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>          <span class="st">"data_New_York/Rochester_chillR_weather.csv"</span>,</span>
<span>          row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr></section></section><section id="chapter-11-getting-temperature-data" class="level1"><h1>Chapter 11: Getting temperature data</h1>
<section id="exercises-on-getting-temperature-data-1" class="level2"><h2 class="anchored" data-anchor-id="exercises-on-getting-temperature-data-1"><strong><em>Exercises on getting temperature data</em></strong></h2>
<ol type="1">
<li>Use chillR functions to find out how many gaps you have in this dataset (even if you have none, please still follow all further steps)</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Rochester</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data_New_York/Rochester_chillR_weather.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Rochester_QC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">Rochester</span><span class="op">)</span><span class="op">$</span><span class="va">QC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Create a list of the 25 closest weather stations using the handle_gsod function</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">station_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action<span class="op">=</span><span class="st">"list_stations"</span>,</span>
<span>                            location<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span><span class="op">)</span>,</span>
<span>                              time_interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1990</span>,<span class="fl">2020</span><span class="op">)</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">station_list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 10
   chillR_code STATION.NAME             CTRY    Lat  Long  BEGIN    END Distance
   &lt;chr&gt;       &lt;chr&gt;                    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1 72529014768 GREATER ROCHESTER INTER… US     43.1 -77.7 1.97e7 2.02e7     7.11
 2 99999914768 ROCHESTER MONROE CO ARPT US     43.1 -77.7 1.95e7 1.97e7     7.25
 3 72529599999 ROCHESTER COAST GUARD L… US     43.2 -77.6 1.98e7 2.00e7    11.1 
 4 99800999999 ROCHESTER                US     43.2 -77.6 2.01e7 2.02e7    11.2 
 5 99826799999 ROCHESTER                US     43.3 -77.6 2.01e7 2.02e7    13.4 
 6 99719099999 LAKE ONTARIO BUOY - 20N… US     43.6 -77.4 2.01e7 2.01e7    54.5 
 7 72498899999 DANSVILLE MUNI           US     42.6 -77.7 2.00e7 2.00e7    65.1 
 8 72523094704 DANSVILLE/MUNICIPAL      US     42.6 -77.7 1.97e7 1.99e7    65.1 
 9 99999994704 DANSVILLE MUNI AP        US     42.6 -77.7 1.95e7 2.00e7    65.1 
10 72498894704 DANSVILLE MUNICIPAL ARPT US     42.6 -77.7 2.00e7 2.02e7    65.2 
# ℹ 15 more rows
# ℹ 2 more variables: Overlap_years &lt;dbl&gt;, Perc_interval_covered &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">station_list</span>, n <span class="op">=</span> <span class="fl">26</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 10
   chillR_code STATION.NAME             CTRY    Lat  Long  BEGIN    END Distance
   &lt;chr&gt;       &lt;chr&gt;                    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1 72529014768 GREATER ROCHESTER INTER… US     43.1 -77.7 1.97e7 2.02e7     7.11
 2 99999914768 ROCHESTER MONROE CO ARPT US     43.1 -77.7 1.95e7 1.97e7     7.25
 3 72529599999 ROCHESTER COAST GUARD L… US     43.2 -77.6 1.98e7 2.00e7    11.1 
 4 99800999999 ROCHESTER                US     43.2 -77.6 2.01e7 2.02e7    11.2 
 5 99826799999 ROCHESTER                US     43.3 -77.6 2.01e7 2.02e7    13.4 
 6 99719099999 LAKE ONTARIO BUOY - 20N… US     43.6 -77.4 2.01e7 2.01e7    54.5 
 7 72498899999 DANSVILLE MUNI           US     42.6 -77.7 2.00e7 2.00e7    65.1 
 8 72523094704 DANSVILLE/MUNICIPAL      US     42.6 -77.7 1.97e7 1.99e7    65.1 
 9 99999994704 DANSVILLE MUNI AP        US     42.6 -77.7 1.95e7 2.00e7    65.1 
10 72498894704 DANSVILLE MUNICIPAL ARPT US     42.6 -77.7 2.00e7 2.02e7    65.2 
11 72523099999 DANSVILLE MUNICIPAL      US     42.6 -77.7 2.00e7 2.00e7    65.6 
12 72519454778 PENN YAN AIRPORT         US     42.6 -77.1 2.01e7 2.02e7    71.8 
13 9999994727  GENEVA SAMPSON AFB       US     42.8 -76.9 1.95e7 1.96e7    72.4 
14 72519499999 PENN YAN                 US     42.6 -77.0 2.00e7 2.01e7    73.0 
15 71430099999 POINT PETRE (AUT)  ONT   CA     43.8 -77.2 1.98e7 2.02e7    84.3 
16 71626899999 PT PETRE                 CA     43.8 -77.2 1.98e7 1.98e7    84.3 
17 72626899999 POINT PETRE (MARS)       CA     43.8 -77.2 1.98e7 1.98e7    84.3 
18 99596099999 PRINCE EDWARD PT         CA     43.8 -76.9 1.99e7 2.01e7    92.5 
19 99798999999 OLCOTT HARBOR            US     43.3 -78.7 2.01e7 2.02e7    92.8 
20 72519599999 OSWEGO COAST GUARD STAT… US     43.5 -76.5 1.98e7 2.00e7    94.5 
21 99726499999 9052030 - OSWEGO  NY     US     43.5 -76.5 2.00e7 2.02e7    94.8 
22 99999914733 BUFFALO BUFFALO ARPT     US     42.9 -78.7 1.97e7 1.97e7    95.3 
23 72528014733 BUFFALO NIAGARA INTERNA… US     42.9 -78.7 1.94e7 2.02e7    95.3 
24 71431099999 COBOURG (AUT)  ONT       CA     44.0 -78.2 1.98e7 2.02e7   100.  
25 71626699999 COBOURG                  CA     44.0 -78.2 1.98e7 1.98e7   100.  
# ℹ 2 more variables: Overlap_years &lt;dbl&gt;, Perc_interval_covered &lt;dbl&gt;</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Identify suitable weather stations for patching gaps</li>
</ol>
<p>#download stations number 4, 5, and 10 these will be used to patch the gaps</p>
<ol start="4" type="1">
<li>Download weather data for promising stations, convert them to chillR format and compile them in a list</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patch_weather</span><span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"download_weather"</span>,</span>
<span>              location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">station_list</span><span class="op">$</span><span class="va">chillR_code</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>              time_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1990</span>,<span class="fl">2020</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/handle_gsod.html">handle_gsod</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Loading data for 31 years from station 'DANSVILLE MUNICIPAL ARPT'
================================================================================

Loading data for 31 years from station 'ROCHESTER'
================================================================================

Loading data for 31 years from station 'ROCHESTER'
================================================================================</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Use the patch_daily_temperatures function to fill gaps</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/patch_daily_temperatures.html">patch_daily_temperatures</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester</span>,</span>
<span>                                    patch_weather <span class="op">=</span> <span class="va">patch_weather</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -0.213      2.319      0           0
Tmax    -0.521      2.143      0           1</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -2.944      2.520      0           0
Tmax     2.408      2.624      0           1</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -2.238      2.316      0           0
Tmax     2.325      2.761      0           1</code></pre>
</div>
</div>
<p>#set minimum quality criteria</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/patch_daily_temperatures.html">patch_daily_temperatures</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester</span>,</span>
<span>                                    patch_weather <span class="op">=</span> <span class="va">patch_weather</span>,</span>
<span>                                    max_mean_bias <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                    max_stdev_bias <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -0.213      2.319      0           0
Tmax    -0.521      2.143      0           1</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -2.944      2.520      0           0
Tmax     2.408      2.624      0           1</code></pre>
</div>
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patched</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     mean_bias stdev_bias filled gaps_remain
Tmin    -2.238      2.316      0           0
Tmax     2.325      2.761      0           1</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Investigate the results - have all gaps been filled?</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_patch_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">patched</span><span class="op">)</span><span class="op">$</span><span class="va">QC</span></span>
<span></span>
<span><span class="va">post_patch_stats</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      Season End_year Season_days Data_days Missing_Tmin Missing_Tmax
1  1989/1990     1990         365       365            0            0
2  1990/1991     1991         365       365            0            0
3  1991/1992     1992         366       366            0            0
4  1992/1993     1993         365       365            0            0
5  1993/1994     1994         365       365            0            0
6  1994/1995     1995         365       365            0            0
7  1995/1996     1996         366       366            0            0
8  1996/1997     1997         365       365            0            0
9  1997/1998     1998         365       365            0            0
10 1998/1999     1999         365       365            0            0
11 1999/2000     2000         366       366            0            0
12 2000/2001     2001         365       365            0            0
13 2001/2002     2002         365       365            0            1
14 2002/2003     2003         365       365            0            0
15 2003/2004     2004         366       366            0            0
16 2004/2005     2005         365       365            0            0
17 2005/2006     2006         365       365            0            0
18 2006/2007     2007         365       365            0            0
19 2007/2008     2008         366       366            0            0
20 2008/2009     2009         365       365            0            0
21 2009/2010     2010         365       365            0            0
22 2010/2011     2011         365       365            0            0
23 2011/2012     2012         366       366            0            0
24 2012/2013     2013         365       365            0            0
25 2013/2014     2014         365       365            0            0
26 2014/2015     2015         365       365            0            0
27 2015/2016     2016         366       366            0            0
28 2016/2017     2017         365       365            0            0
29 2017/2018     2018         365       365            0            0
30 2018/2019     2019         365       365            0            0
31 2019/2020     2020         366       366            0            0
   Incomplete_days Perc_complete
1                0         100.0
2                0         100.0
3                0         100.0
4                0         100.0
5                0         100.0
6                0         100.0
7                0         100.0
8                0         100.0
9                0         100.0
10               0         100.0
11               0         100.0
12               0         100.0
13               1          99.7
14               0         100.0
15               0         100.0
16               0         100.0
17               0         100.0
18               0         100.0
19               0         100.0
20               0         100.0
21               0         100.0
22               0         100.0
23               0         100.0
24               0         100.0
25               0         100.0
26               0         100.0
27               0         100.0
28               0         100.0
29               0         100.0
30               0         100.0
31               0         100.0</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>If necessary, repeat until you have a dataset you can work with in further analyses</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Rochester_weather</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">patched</span><span class="op">)</span></span>
<span></span>
<span><span class="va">patched_monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/patch_daily_temps.html">patch_daily_temps</a></span><span class="op">(</span>weather <span class="op">=</span> <span class="va">Rochester</span>,</span>
<span>                                     patch_weather <span class="op">=</span> <span class="va">patch_weather</span>,</span>
<span>                                     max_mean_bias <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                     max_stdev_bias <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                     time_interval <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>#saving the data for later</p>
<div class="cell">
<details class="code-fold"><summary>Show code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">monthly_bias_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chillR/man/fix_weather.html">fix_weather</a></span><span class="op">(</span><span class="va">patched_monthly</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">monthly_bias_fixed</span><span class="op">$</span><span class="va">weather</span>,</span>
<span>          <span class="st">"data_New_York/Rochester_weather.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- -->

</section></section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb89" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tree Phenology Assignment"</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Olamide Akinlade"</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.time(), '%B %d, %Y')`"</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc_float: true</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Contents"</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co">    number_sections: true</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co">    fig_caption: true</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: 'Show code'</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code_highlight: tango</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code_download: true</span></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: sandstone</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight: tango</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="co">    mathjax: local</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a><span class="co">    self_contained: false</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(echo = TRUE)</span></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 3: Tree Phenology Analysis</span></span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 Tree Dormancy</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>Winter dormancy may be defined as a trade-off between the length of the</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a>growing season and the protection against winter damage. To enter</span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>dormancy, vegetative growth is stopped in the late summer or early</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>autumn and the shoots are converted into buds, where the shoot apical</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>meristems are protected by tightly closed and hardened bud scales.</span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.1.1 Dormancy Phases</span></span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Dormancy Establishment</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Endodormancy 1: Ecodormancy</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Growth resumption</span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.1.2 Physological processes that regulate dormancy</span></span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a>a.  Transport</span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a>b.  Photohormones</span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a>c.  Genetics</span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a>d.  Carbohydrates dynamics</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on Tree Dormancy***</span></span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Put yourself in the place of a breeder who wants to calculate the</span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a>    temperature requirements of a newly released cultivar. Which method</span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a>    will you use to calculate the chilling and forcing periods? Please</span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true" tabindex="-1"></a>    justify your answer</span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true" tabindex="-1"></a>Statistical method is recommended to calculate the temperature</span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true" tabindex="-1"></a>requirements (chilling and forcing periods) of a newly released</span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true" tabindex="-1"></a>cultivar. This involves using partial least square regression analysis</span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true" tabindex="-1"></a>for daily temperatures over a continuous period.</span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Which are the advantages (2) of the BBCH scale compared with earlier</span>
<span id="cb89-72"><a href="#cb89-72" aria-hidden="true" tabindex="-1"></a>    scales?</span>
<span id="cb89-73"><a href="#cb89-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-74"><a href="#cb89-74" aria-hidden="true" tabindex="-1"></a>Two advantages of the BBCH scale over traditional scale include: a. It</span>
<span id="cb89-75"><a href="#cb89-75" aria-hidden="true" tabindex="-1"></a>was developed in a general frame for all the species b. It covers the</span>
<span id="cb89-76"><a href="#cb89-76" aria-hidden="true" tabindex="-1"></a>whole development of a plant.</span>
<span id="cb89-77"><a href="#cb89-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-78"><a href="#cb89-78" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Classify the following phenological stages of sweet cherry according</span>
<span id="cb89-79"><a href="#cb89-79" aria-hidden="true" tabindex="-1"></a>    to the BBCH scale:</span>
<span id="cb89-80"><a href="#cb89-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-81"><a href="#cb89-81" aria-hidden="true" tabindex="-1"></a>Phenological stages of cherry + Image 1: 51</span>
<span id="cb89-82"><a href="#cb89-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-83"><a href="#cb89-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Image 2: 63</span>
<span id="cb89-84"><a href="#cb89-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-85"><a href="#cb89-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Image 3: 87</span>
<span id="cb89-86"><a href="#cb89-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-87"><a href="#cb89-87" aria-hidden="true" tabindex="-1"></a>![Stages of</span>
<span id="cb89-88"><a href="#cb89-88" aria-hidden="true" tabindex="-1"></a>Cherry](\Users\Home\Downloads\photo_5834526249584805567_y.jpg)</span>
<span id="cb89-89"><a href="#cb89-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-90"><a href="#cb89-90" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-91"><a href="#cb89-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-92"><a href="#cb89-92" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 4: Climate Change and impact projection</span></span>
<span id="cb89-93"><a href="#cb89-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-94"><a href="#cb89-94" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1.1 Drivers of Climate change include:</span></span>
<span id="cb89-95"><a href="#cb89-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-96"><a href="#cb89-96" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sun: Warms the earth through radiation. It is an important driver of</span>
<span id="cb89-97"><a href="#cb89-97" aria-hidden="true" tabindex="-1"></a>    climate change on geological timescales, but not of recent climate</span>
<span id="cb89-98"><a href="#cb89-98" aria-hidden="true" tabindex="-1"></a>    change.</span>
<span id="cb89-99"><a href="#cb89-99" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aerosols: They are largely dusts. Suspensions of liquid, solid, or</span>
<span id="cb89-100"><a href="#cb89-100" aria-hidden="true" tabindex="-1"></a>    mixed particles with highly variable chemical composition and size</span>
<span id="cb89-101"><a href="#cb89-101" aria-hidden="true" tabindex="-1"></a>    distribution.</span>
<span id="cb89-102"><a href="#cb89-102" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Clouds: Can have both cooling and warming effect.</span>
<span id="cb89-103"><a href="#cb89-103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ozone: Surface (tropospheric) ozone: constituent of smog, health</span>
<span id="cb89-104"><a href="#cb89-104" aria-hidden="true" tabindex="-1"></a>    hazard (bad ozone). Greenhouse gas: presence in the stratosphere has</span>
<span id="cb89-105"><a href="#cb89-105" aria-hidden="true" tabindex="-1"></a>    a warming effect. Destroyed by chlorofluorocarbons (CFCs).</span>
<span id="cb89-106"><a href="#cb89-106" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Surface albedo: Reflection of radiation by the land surface. Light</span>
<span id="cb89-107"><a href="#cb89-107" aria-hidden="true" tabindex="-1"></a>    surfaces (e.g. ice, snow) reflect almost all radiation, dark</span>
<span id="cb89-108"><a href="#cb89-108" aria-hidden="true" tabindex="-1"></a>    surfaces (ocean, dark soil, forest) very little.</span>
<span id="cb89-109"><a href="#cb89-109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Greenhouse gases: Atmospheric gases that trap heat on Earth.</span>
<span id="cb89-110"><a href="#cb89-110" aria-hidden="true" tabindex="-1"></a>    Greenhouse effects warms the planet.</span>
<span id="cb89-111"><a href="#cb89-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Long-term drivers:</span>
<span id="cb89-112"><a href="#cb89-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-113"><a href="#cb89-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on Climate Change***</span></span>
<span id="cb89-114"><a href="#cb89-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-115"><a href="#cb89-115" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>List the main drivers of climate change at the decade to century</span>
<span id="cb89-116"><a href="#cb89-116" aria-hidden="true" tabindex="-1"></a>    scale, and briefly explain the mechanism through which the currently</span>
<span id="cb89-117"><a href="#cb89-117" aria-hidden="true" tabindex="-1"></a>    most important driver affects our climate.</span>
<span id="cb89-118"><a href="#cb89-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-119"><a href="#cb89-119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sun</span>
<span id="cb89-120"><a href="#cb89-120" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aerosols</span>
<span id="cb89-121"><a href="#cb89-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Clouds</span>
<span id="cb89-122"><a href="#cb89-122" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ozone</span>
<span id="cb89-123"><a href="#cb89-123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Surface albedo</span>
<span id="cb89-124"><a href="#cb89-124" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Greenhouse gases</span>
<span id="cb89-125"><a href="#cb89-125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Long-term drivers</span>
<span id="cb89-126"><a href="#cb89-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-127"><a href="#cb89-127" aria-hidden="true" tabindex="-1"></a>Most important: **GHGs** **Greenhouse effect** + Raises Earth’s mean</span>
<span id="cb89-128"><a href="#cb89-128" aria-hidden="true" tabindex="-1"></a>temperature: +14°C instead of -18°C without GHGs! + Major GHGs: water</span>
<span id="cb89-129"><a href="#cb89-129" aria-hidden="true" tabindex="-1"></a>vapor, CO2 (carbon dioxide), CH4 (methane), N2O (nitrous oxide)</span>
<span id="cb89-130"><a href="#cb89-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-131"><a href="#cb89-131" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Explain briefly what is special about temperature dynamics of recent</span>
<span id="cb89-132"><a href="#cb89-132" aria-hidden="true" tabindex="-1"></a>    decades, and why we have good reasons to be concerned.</span>
<span id="cb89-133"><a href="#cb89-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-134"><a href="#cb89-134" aria-hidden="true" tabindex="-1"></a>Since 1901 strong warming (almost) everywhere on Earth.Up to 8°C warmer</span>
<span id="cb89-135"><a href="#cb89-135" aria-hidden="true" tabindex="-1"></a>than the 2003-2018 average. Precipitation anomalies (relative to median</span>
<span id="cb89-136"><a href="#cb89-136" aria-hidden="true" tabindex="-1"></a>prec.) for Cologne/Bonn weather station. Some years with dry</span>
<span id="cb89-137"><a href="#cb89-137" aria-hidden="true" tabindex="-1"></a>springs/summer.</span>
<span id="cb89-138"><a href="#cb89-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-139"><a href="#cb89-139" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>What does the abbreviation ‘RCP’ stand for, how are RCPs defined,</span>
<span id="cb89-140"><a href="#cb89-140" aria-hidden="true" tabindex="-1"></a>    and what is their role in projecting future climates? Representative</span>
<span id="cb89-141"><a href="#cb89-141" aria-hidden="true" tabindex="-1"></a>    Concentration Pathways (RCPs). It is a new greenhouse forcing</span>
<span id="cb89-142"><a href="#cb89-142" aria-hidden="true" tabindex="-1"></a>    scenarios in the IPCC‘s5th Assessment Report. From RCP to inputs for</span>
<span id="cb89-143"><a href="#cb89-143" aria-hidden="true" tabindex="-1"></a>    climate change impact models.</span>
<span id="cb89-144"><a href="#cb89-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-145"><a href="#cb89-145" aria-hidden="true" tabindex="-1"></a>Roles of RCP:</span>
<span id="cb89-146"><a href="#cb89-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-147"><a href="#cb89-147" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Briefly describe the 4 climate impact projection methods described</span>
<span id="cb89-148"><a href="#cb89-148" aria-hidden="true" tabindex="-1"></a>    in the fourth video.</span>
<span id="cb89-149"><a href="#cb89-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-150"><a href="#cb89-150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Statistical models</span>
<span id="cb89-151"><a href="#cb89-151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Species distribution modeling</span>
<span id="cb89-152"><a href="#cb89-152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Process-based models</span>
<span id="cb89-153"><a href="#cb89-153" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Climate analogue analysis</span>
<span id="cb89-154"><a href="#cb89-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-155"><a href="#cb89-155" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-156"><a href="#cb89-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-157"><a href="#cb89-157" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 5: Winter Chill Projections</span></span>
<span id="cb89-158"><a href="#cb89-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-159"><a href="#cb89-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on past chill projections***</span></span>
<span id="cb89-160"><a href="#cb89-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-161"><a href="#cb89-161" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Sketch out three data access and processing challenges that had to</span>
<span id="cb89-162"><a href="#cb89-162" aria-hidden="true" tabindex="-1"></a>    be overcome in order to produce chill projections with</span>
<span id="cb89-163"><a href="#cb89-163" aria-hidden="true" tabindex="-1"></a>    state-of-the-art methodology.</span>
<span id="cb89-164"><a href="#cb89-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-165"><a href="#cb89-165" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Accessing Climate Data for Specific Locations: Previous climate</span>
<span id="cb89-166"><a href="#cb89-166" aria-hidden="true" tabindex="-1"></a>    datasets like AFRICLIM and ClimateWizard only provided large-scale</span>
<span id="cb89-167"><a href="#cb89-167" aria-hidden="true" tabindex="-1"></a>    data. To get weather data for specific locations without downloading</span>
<span id="cb89-168"><a href="#cb89-168" aria-hidden="true" tabindex="-1"></a>    too much extra information, an API was created to quickly access</span>
<span id="cb89-169"><a href="#cb89-169" aria-hidden="true" tabindex="-1"></a>    data for single sites</span>
<span id="cb89-170"><a href="#cb89-170" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Converting Daily to Hourly Temperature Data: Chill models need</span>
<span id="cb89-171"><a href="#cb89-171" aria-hidden="true" tabindex="-1"></a>    hourly temperature data, but many databases only give daily</span>
<span id="cb89-172"><a href="#cb89-172" aria-hidden="true" tabindex="-1"></a>    averages. Early methods for converting daily to hourly data weren’t</span>
<span id="cb89-173"><a href="#cb89-173" aria-hidden="true" tabindex="-1"></a>    very good, especially in areas with unique temperatures. Improved</span>
<span id="cb89-174"><a href="#cb89-174" aria-hidden="true" tabindex="-1"></a>    algorithms were developed to estimate hourly temperatures more</span>
<span id="cb89-175"><a href="#cb89-175" aria-hidden="true" tabindex="-1"></a>    accurately from daily data</span>
<span id="cb89-176"><a href="#cb89-176" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Handling Large Volumes of Climate Model Outputs: Studying different</span>
<span id="cb89-177"><a href="#cb89-177" aria-hidden="true" tabindex="-1"></a>    climate futures involves dealing with a lot of data from many</span>
<span id="cb89-178"><a href="#cb89-178" aria-hidden="true" tabindex="-1"></a>    climate models, which can be hard to manage. To handle this large</span>
<span id="cb89-179"><a href="#cb89-179" aria-hidden="true" tabindex="-1"></a>    amount of data effectively, workflows were streamlined and selective</span>
<span id="cb89-180"><a href="#cb89-180" aria-hidden="true" tabindex="-1"></a>    processing techniques were used</span>
<span id="cb89-181"><a href="#cb89-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-182"><a href="#cb89-182" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Outline, in your understanding, the basic steps that are necessary</span>
<span id="cb89-183"><a href="#cb89-183" aria-hidden="true" tabindex="-1"></a>    to make such projections.</span>
<span id="cb89-184"><a href="#cb89-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-185"><a href="#cb89-185" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data Collection and Calibration: collect historical weather data and</span>
<span id="cb89-186"><a href="#cb89-186" aria-hidden="true" tabindex="-1"></a>    use it to calibrate a weather generator for realistic temperature</span>
<span id="cb89-187"><a href="#cb89-187" aria-hidden="true" tabindex="-1"></a>    simulations</span>
<span id="cb89-188"><a href="#cb89-188" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model Selection and Scenario Setup: choose relevant climate models</span>
<span id="cb89-189"><a href="#cb89-189" aria-hidden="true" tabindex="-1"></a>    and emission scenarios to explore various future climates</span>
<span id="cb89-190"><a href="#cb89-190" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Generate Temperature Projections: downscale climate data, converting</span>
<span id="cb89-191"><a href="#cb89-191" aria-hidden="true" tabindex="-1"></a>    it to daily or hourly temperatures as needed for chill calculations</span>
<span id="cb89-192"><a href="#cb89-192" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chill Calculation: apply chill models to estimate chill accumulation</span>
<span id="cb89-193"><a href="#cb89-193" aria-hidden="true" tabindex="-1"></a>    across different climate scenarios</span>
<span id="cb89-194"><a href="#cb89-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Analysis and Visualization: compare chill projections across models</span>
<span id="cb89-195"><a href="#cb89-195" aria-hidden="true" tabindex="-1"></a>    and scenarios and visualize the findings</span>
<span id="cb89-196"><a href="#cb89-196" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation: validate projections with observed data where</span>
<span id="cb89-197"><a href="#cb89-197" aria-hidden="true" tabindex="-1"></a>    possible and assess agricultural impacts and adaptation needs</span>
<span id="cb89-198"><a href="#cb89-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-199"><a href="#cb89-199" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-200"><a href="#cb89-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-201"><a href="#cb89-201" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 6: Manual Chill Analysis</span></span>
<span id="cb89-202"><a href="#cb89-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-205"><a href="#cb89-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-206"><a href="#cb89-206" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb89-207"><a href="#cb89-207" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb89-208"><a href="#cb89-208" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb89-209"><a href="#cb89-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-210"><a href="#cb89-210" aria-hidden="true" tabindex="-1"></a>Winters_hours_gaps[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb89-211"><a href="#cb89-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-212"><a href="#cb89-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-213"><a href="#cb89-213" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Computing Chilling Hours from Hourly Temperature data***</span></span>
<span id="cb89-214"><a href="#cb89-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-215"><a href="#cb89-215" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Write a basic function that calculates warm hours (<span class="sc">\&gt;</span>25°C)</span>
<span id="cb89-216"><a href="#cb89-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-219"><a href="#cb89-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-220"><a href="#cb89-220" aria-hidden="true" tabindex="-1"></a>hourtemps <span class="ot">&lt;-</span> Winters_hours_gaps[,<span class="fu">c</span>(<span class="st">"Year"</span>,</span>
<span id="cb89-221"><a href="#cb89-221" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Month"</span>,</span>
<span id="cb89-222"><a href="#cb89-222" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Day"</span>,</span>
<span id="cb89-223"><a href="#cb89-223" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Hour"</span>,</span>
<span id="cb89-224"><a href="#cb89-224" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Temp"</span>)]</span>
<span id="cb89-225"><a href="#cb89-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-226"><a href="#cb89-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-229"><a href="#cb89-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-230"><a href="#cb89-230" aria-hidden="true" tabindex="-1"></a>hourtemps[, <span class="st">"Chilling_Hour"</span>] <span class="ot">&lt;-</span> hourtemps<span class="sc">$</span>Temp <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> hourtemps<span class="sc">$</span>Temp <span class="sc">&lt;=</span> <span class="fl">7.2</span></span>
<span id="cb89-231"><a href="#cb89-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-232"><a href="#cb89-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-233"><a href="#cb89-233" aria-hidden="true" tabindex="-1"></a>#calculate warm hours</span>
<span id="cb89-234"><a href="#cb89-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-237"><a href="#cb89-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-238"><a href="#cb89-238" aria-hidden="true" tabindex="-1"></a>WH<span class="ot">&lt;-</span><span class="cf">function</span>(hourtemps)</span>
<span id="cb89-239"><a href="#cb89-239" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb89-240"><a href="#cb89-240" aria-hidden="true" tabindex="-1"></a>  hourtemps[, <span class="st">"Warm_Hour"</span>] <span class="ot">&lt;-</span></span>
<span id="cb89-241"><a href="#cb89-241" aria-hidden="true" tabindex="-1"></a>    hourtemps<span class="sc">$</span>Temp <span class="sc">&gt;=</span> <span class="dv">25</span> </span>
<span id="cb89-242"><a href="#cb89-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-243"><a href="#cb89-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(hourtemps)</span>
<span id="cb89-244"><a href="#cb89-244" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-245"><a href="#cb89-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-246"><a href="#cb89-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-247"><a href="#cb89-247" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Apply this function to the Winters_hours_gaps dataset</span>
<span id="cb89-248"><a href="#cb89-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-251"><a href="#cb89-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-252"><a href="#cb89-252" aria-hidden="true" tabindex="-1"></a><span class="fu">WH</span>(hourtemps)[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ]</span>
<span id="cb89-253"><a href="#cb89-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-254"><a href="#cb89-254" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(hourtemps<span class="sc">$</span>Warm_Hour)</span>
<span id="cb89-255"><a href="#cb89-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-256"><a href="#cb89-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-257"><a href="#cb89-257" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Extend this function, so that it can take start and end dates as</span>
<span id="cb89-258"><a href="#cb89-258" aria-hidden="true" tabindex="-1"></a>    inputs and sums up warm hours between these dates</span>
<span id="cb89-259"><a href="#cb89-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-262"><a href="#cb89-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-263"><a href="#cb89-263" aria-hidden="true" tabindex="-1"></a>sum_WH <span class="ot">&lt;-</span> <span class="cf">function</span>(hourtemps, </span>
<span id="cb89-264"><a href="#cb89-264" aria-hidden="true" tabindex="-1"></a>                   startYEARMODAHO,</span>
<span id="cb89-265"><a href="#cb89-265" aria-hidden="true" tabindex="-1"></a>                   endYEARMODAHO)</span>
<span id="cb89-266"><a href="#cb89-266" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-267"><a href="#cb89-267" aria-hidden="true" tabindex="-1"></a>{hourtemps[,<span class="st">"Warm_Hour"</span>] <span class="ot">&lt;-</span> hourtemps<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">25</span></span>
<span id="cb89-268"><a href="#cb89-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-269"><a href="#cb89-269" aria-hidden="true" tabindex="-1"></a>startYear <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(startYEARMODAHO, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb89-270"><a href="#cb89-270" aria-hidden="true" tabindex="-1"></a>startMonth <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(startYEARMODAHO, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb89-271"><a href="#cb89-271" aria-hidden="true" tabindex="-1"></a>startDay <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(startYEARMODAHO, <span class="dv">7</span>, <span class="dv">8</span>))</span>
<span id="cb89-272"><a href="#cb89-272" aria-hidden="true" tabindex="-1"></a>startHour <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(startYEARMODAHO, <span class="dv">9</span>, <span class="dv">10</span>))</span>
<span id="cb89-273"><a href="#cb89-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-274"><a href="#cb89-274" aria-hidden="true" tabindex="-1"></a>endYear <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(endYEARMODAHO, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb89-275"><a href="#cb89-275" aria-hidden="true" tabindex="-1"></a>endMonth <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(endYEARMODAHO, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb89-276"><a href="#cb89-276" aria-hidden="true" tabindex="-1"></a>endDay <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(endYEARMODAHO, <span class="dv">7</span>, <span class="dv">8</span>))</span>
<span id="cb89-277"><a href="#cb89-277" aria-hidden="true" tabindex="-1"></a>endHour <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(endYEARMODAHO, <span class="dv">9</span>, <span class="dv">10</span>))</span>
<span id="cb89-278"><a href="#cb89-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-279"><a href="#cb89-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-280"><a href="#cb89-280" aria-hidden="true" tabindex="-1"></a>Start_Date <span class="ot">&lt;-</span> <span class="fu">which</span>(hourtemps<span class="sc">$</span>Year <span class="sc">==</span> startYear <span class="sc">&amp;</span></span>
<span id="cb89-281"><a href="#cb89-281" aria-hidden="true" tabindex="-1"></a>                    hourtemps<span class="sc">$</span>Month <span class="sc">==</span> startMonth <span class="sc">&amp;</span></span>
<span id="cb89-282"><a href="#cb89-282" aria-hidden="true" tabindex="-1"></a>                    hourtemps<span class="sc">$</span>Day <span class="sc">==</span> startDay <span class="sc">&amp;</span></span>
<span id="cb89-283"><a href="#cb89-283" aria-hidden="true" tabindex="-1"></a>                    hourtemps<span class="sc">$</span>Hour <span class="sc">==</span> startHour)</span>
<span id="cb89-284"><a href="#cb89-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-285"><a href="#cb89-285" aria-hidden="true" tabindex="-1"></a>End_Date <span class="ot">&lt;-</span> <span class="fu">which</span>(hourtemps<span class="sc">$</span>Year <span class="sc">==</span> endYear <span class="sc">&amp;</span></span>
<span id="cb89-286"><a href="#cb89-286" aria-hidden="true" tabindex="-1"></a>                  hourtemps<span class="sc">$</span>Month <span class="sc">==</span> endMonth <span class="sc">&amp;</span></span>
<span id="cb89-287"><a href="#cb89-287" aria-hidden="true" tabindex="-1"></a>                  hourtemps<span class="sc">$</span>Day <span class="sc">==</span> endDay <span class="sc">&amp;</span></span>
<span id="cb89-288"><a href="#cb89-288" aria-hidden="true" tabindex="-1"></a>                  hourtemps<span class="sc">$</span>Hour <span class="sc">==</span> endHour)</span>
<span id="cb89-289"><a href="#cb89-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-290"><a href="#cb89-290" aria-hidden="true" tabindex="-1"></a>WHs <span class="ot">&lt;-</span> <span class="fu">sum</span>(hourtemps<span class="sc">$</span>Warm_Hour[Start_Date<span class="sc">:</span>End_Date])</span>
<span id="cb89-291"><a href="#cb89-291" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(WHs)</span>
<span id="cb89-292"><a href="#cb89-292" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-293"><a href="#cb89-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-294"><a href="#cb89-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-295"><a href="#cb89-295" aria-hidden="true" tabindex="-1"></a>#Example</span>
<span id="cb89-296"><a href="#cb89-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-299"><a href="#cb89-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-300"><a href="#cb89-300" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_WH</span>(Winters_hours_gaps, <span class="at">startYEARMODAHO =</span> <span class="dv">2008070100</span>, </span>
<span id="cb89-301"><a href="#cb89-301" aria-hidden="true" tabindex="-1"></a>                           <span class="at">endYEARMODAHO =</span> <span class="dv">2008073123</span>)</span>
<span id="cb89-302"><a href="#cb89-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-303"><a href="#cb89-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-304"><a href="#cb89-304" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-305"><a href="#cb89-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-306"><a href="#cb89-306" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 7: Winter Chill Projections</span></span>
<span id="cb89-307"><a href="#cb89-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-308"><a href="#cb89-308" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises Chill Models***</span></span>
<span id="cb89-309"><a href="#cb89-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-310"><a href="#cb89-310" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Run the chilling() function on the Winters_hours_gap dataset</span>
<span id="cb89-311"><a href="#cb89-311" aria-hidden="true" tabindex="-1"></a>    #chilling function</span>
<span id="cb89-312"><a href="#cb89-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-315"><a href="#cb89-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-316"><a href="#cb89-316" aria-hidden="true" tabindex="-1"></a>july <span class="ot">&lt;-</span> <span class="fu">chilling</span>(<span class="fu">make_JDay</span>(Winters_hours_gaps),</span>
<span id="cb89-317"><a href="#cb89-317" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Start_JDay =</span> <span class="dv">183</span>, </span>
<span id="cb89-318"><a href="#cb89-318" aria-hidden="true" tabindex="-1"></a>                   <span class="at">End_JDay =</span> <span class="dv">213</span>)</span>
<span id="cb89-319"><a href="#cb89-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-320"><a href="#cb89-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-321"><a href="#cb89-321" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Create your own temperature-weighting chill model using the</span>
<span id="cb89-322"><a href="#cb89-322" aria-hidden="true" tabindex="-1"></a>    step_model() function #step model</span>
<span id="cb89-323"><a href="#cb89-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-326"><a href="#cb89-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-327"><a href="#cb89-327" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb89-328"><a href="#cb89-328" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="dv">0</span>,  <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>,   <span class="dv">10</span>),  </span>
<span id="cb89-329"><a href="#cb89-329" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">c</span>(    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">1000</span>), </span>
<span id="cb89-330"><a href="#cb89-330" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(   <span class="dv">0</span>, <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">2</span>,  <span class="dv">1</span>,    <span class="dv">0</span>))</span>
<span id="cb89-331"><a href="#cb89-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-332"><a href="#cb89-332" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb89-333"><a href="#cb89-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">position =</span> <span class="st">"left"</span>, <span class="at">font_size =</span> <span class="dv">12</span>)</span>
<span id="cb89-334"><a href="#cb89-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-335"><a href="#cb89-335" aria-hidden="true" tabindex="-1"></a>custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">step_model</span>(x, df)</span>
<span id="cb89-336"><a href="#cb89-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-337"><a href="#cb89-337" aria-hidden="true" tabindex="-1"></a><span class="fu">custom</span>(Winters_hours_gaps<span class="sc">$</span>Temp)[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span>
<span id="cb89-338"><a href="#cb89-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-339"><a href="#cb89-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-340"><a href="#cb89-340" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Run this model on the Winters_hours_gaps dataset using the</span>
<span id="cb89-341"><a href="#cb89-341" aria-hidden="true" tabindex="-1"></a>    tempResponse() function.</span>
<span id="cb89-342"><a href="#cb89-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-345"><a href="#cb89-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-346"><a href="#cb89-346" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">tempResponse</span>(<span class="fu">make_JDay</span>(Winters_hours_gaps),</span>
<span id="cb89-347"><a href="#cb89-347" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Start_JDay =</span> <span class="dv">183</span>,</span>
<span id="cb89-348"><a href="#cb89-348" aria-hidden="true" tabindex="-1"></a>                       <span class="at">End_JDay =</span> <span class="dv">213</span>,</span>
<span id="cb89-349"><a href="#cb89-349" aria-hidden="true" tabindex="-1"></a>                       <span class="at">models =</span> <span class="fu">list</span>(<span class="at">Chill_Portions =</span> Dynamic_Model, </span>
<span id="cb89-350"><a href="#cb89-350" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">GDH =</span> GDH))</span>
<span id="cb89-351"><a href="#cb89-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-352"><a href="#cb89-352" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(output) <span class="sc">%&gt;%</span></span>
<span id="cb89-353"><a href="#cb89-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, </span>
<span id="cb89-354"><a href="#cb89-354" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="st">"left"</span>,</span>
<span id="cb89-355"><a href="#cb89-355" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">12</span>)</span>
<span id="cb89-356"><a href="#cb89-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-357"><a href="#cb89-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-358"><a href="#cb89-358" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-359"><a href="#cb89-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-360"><a href="#cb89-360" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 8: Making Hourly Temperatures</span></span>
<span id="cb89-361"><a href="#cb89-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-362"><a href="#cb89-362" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on hourly*** </span></span>
<span id="cb89-363"><a href="#cb89-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-364"><a href="#cb89-364" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Choose a location of interest, find out its latitude and produce</span>
<span id="cb89-365"><a href="#cb89-365" aria-hidden="true" tabindex="-1"></a>    plots of daily sunrise, sunset and daylength</span>
<span id="cb89-366"><a href="#cb89-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-369"><a href="#cb89-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-370"><a href="#cb89-370" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(chillR)</span>
<span id="cb89-371"><a href="#cb89-371" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb89-372"><a href="#cb89-372" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb89-373"><a href="#cb89-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-374"><a href="#cb89-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-375"><a href="#cb89-375" aria-hidden="true" tabindex="-1"></a><span class="fu"># sunset time and daylength at Rochester (Latitude: 43.15°N) over the</span></span>
<span id="cb89-376"><a href="#cb89-376" aria-hidden="true" tabindex="-1"></a>course of the year.</span>
<span id="cb89-377"><a href="#cb89-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-380"><a href="#cb89-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-381"><a href="#cb89-381" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">daylength</span>(<span class="at">latitude =</span> <span class="dv">43</span>,</span>
<span id="cb89-382"><a href="#cb89-382" aria-hidden="true" tabindex="-1"></a>                  <span class="at">JDay =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>)</span>
<span id="cb89-383"><a href="#cb89-383" aria-hidden="true" tabindex="-1"></a>Days_df <span class="ot">&lt;-</span></span>
<span id="cb89-384"><a href="#cb89-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb89-385"><a href="#cb89-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">JDay =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>,</span>
<span id="cb89-386"><a href="#cb89-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sunrise =</span> Days<span class="sc">$</span>Sunrise,</span>
<span id="cb89-387"><a href="#cb89-387" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sunset =</span> Days<span class="sc">$</span>Sunset,</span>
<span id="cb89-388"><a href="#cb89-388" aria-hidden="true" tabindex="-1"></a>    <span class="at">Daylength =</span> Days<span class="sc">$</span>Daylength</span>
<span id="cb89-389"><a href="#cb89-389" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-390"><a href="#cb89-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-391"><a href="#cb89-391" aria-hidden="true" tabindex="-1"></a>Days_df <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(Days_df, <span class="at">cols=</span><span class="fu">c</span>(Sunrise<span class="sc">:</span>Daylength))</span>
<span id="cb89-392"><a href="#cb89-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-393"><a href="#cb89-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-394"><a href="#cb89-394" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Days_df, <span class="fu">aes</span>(JDay, value)) <span class="sc">+</span></span>
<span id="cb89-395"><a href="#cb89-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb89-396"><a href="#cb89-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(name)) <span class="sc">+</span></span>
<span id="cb89-397"><a href="#cb89-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Time of Day / Daylength (Hours)"</span>) <span class="sc">+</span></span>
<span id="cb89-398"><a href="#cb89-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span>
<span id="cb89-399"><a href="#cb89-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-400"><a href="#cb89-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-401"><a href="#cb89-401" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Produce an hourly dataset, based on idealized daily curves, for the</span>
<span id="cb89-402"><a href="#cb89-402" aria-hidden="true" tabindex="-1"></a>    KA_weather dataset (included in chillR)</span>
<span id="cb89-403"><a href="#cb89-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-406"><a href="#cb89-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-407"><a href="#cb89-407" aria-hidden="true" tabindex="-1"></a><span class="fu">stack_hourly_temps</span>(KA_weather, <span class="at">latitude =</span> <span class="dv">43</span>) [[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb89-408"><a href="#cb89-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-409"><a href="#cb89-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-410"><a href="#cb89-410" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Produce empirical temperature curve parameters for the Winters_hours_gaps dataset, and use them to predict hourly values from daily temperatures (this is very similar to the example above,but please make sure you understand what’s going on).</span>
<span id="cb89-411"><a href="#cb89-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-414"><a href="#cb89-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-415"><a href="#cb89-415" aria-hidden="true" tabindex="-1"></a>empi_curve <span class="ot">&lt;-</span> <span class="fu">Empirical_daily_temperature_curve</span>(Winters_hours_gaps)</span>
<span id="cb89-416"><a href="#cb89-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-417"><a href="#cb89-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-420"><a href="#cb89-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-421"><a href="#cb89-421" aria-hidden="true" tabindex="-1"></a>Winters_daily <span class="ot">&lt;-</span> <span class="fu">make_all_day_table</span>(Winters_hours_gaps, <span class="at">input_timestep =</span> <span class="st">"hour"</span>)</span>
<span id="cb89-422"><a href="#cb89-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-423"><a href="#cb89-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-424"><a href="#cb89-424" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-425"><a href="#cb89-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-426"><a href="#cb89-426" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 9: Some Useful tools in R</span></span>
<span id="cb89-427"><a href="#cb89-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-428"><a href="#cb89-428" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on useful R tools*** </span></span>
<span id="cb89-429"><a href="#cb89-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-430"><a href="#cb89-430" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Based on the Winters_hours_gaps dataset, use magrittr pipes and</span>
<span id="cb89-431"><a href="#cb89-431" aria-hidden="true" tabindex="-1"></a>    functions of the tidyverse to accomplish the following:</span>
<span id="cb89-432"><a href="#cb89-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-433"><a href="#cb89-433" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the dataset into a tibble</span>
<span id="cb89-434"><a href="#cb89-434" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Select only the top 10 rows of the dataset</span>
<span id="cb89-435"><a href="#cb89-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-438"><a href="#cb89-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-439"><a href="#cb89-439" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(chillR)</span>
<span id="cb89-440"><a href="#cb89-440" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb89-441"><a href="#cb89-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-442"><a href="#cb89-442" aria-hidden="true" tabindex="-1"></a>WHG <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Winters_hours_gaps[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ])</span>
<span id="cb89-443"><a href="#cb89-443" aria-hidden="true" tabindex="-1"></a>WHG</span>
<span id="cb89-444"><a href="#cb89-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-445"><a href="#cb89-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-446"><a href="#cb89-446" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the tibble to a long format, with separate rows for</span>
<span id="cb89-447"><a href="#cb89-447" aria-hidden="true" tabindex="-1"></a>    Temp_gaps and Temp</span>
<span id="cb89-448"><a href="#cb89-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-451"><a href="#cb89-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-452"><a href="#cb89-452" aria-hidden="true" tabindex="-1"></a>WHGlong <span class="ot">&lt;-</span> WHG <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Temp_gaps<span class="sc">:</span>Temp)</span>
<span id="cb89-453"><a href="#cb89-453" aria-hidden="true" tabindex="-1"></a>WHGlong</span>
<span id="cb89-454"><a href="#cb89-454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-455"><a href="#cb89-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-456"><a href="#cb89-456" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use ggplot2 to plot Temp_gaps and Temp as facets (point or line</span>
<span id="cb89-457"><a href="#cb89-457" aria-hidden="true" tabindex="-1"></a>    plot)</span>
<span id="cb89-460"><a href="#cb89-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-461"><a href="#cb89-461" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(WHGlong, <span class="fu">aes</span>(Hour, value)) <span class="sc">+</span></span>
<span id="cb89-462"><a href="#cb89-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span><span class="fl">0.2</span>), <span class="at">size=</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb89-463"><a href="#cb89-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>,<span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb89-464"><a href="#cb89-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Temperature (°C)"</span>) <span class="sc">+</span></span>
<span id="cb89-465"><a href="#cb89-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb89-466"><a href="#cb89-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-467"><a href="#cb89-467" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-468"><a href="#cb89-468" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the dataset back to the wide format</span>
<span id="cb89-469"><a href="#cb89-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-472"><a href="#cb89-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-473"><a href="#cb89-473" aria-hidden="true" tabindex="-1"></a>WHGwide <span class="ot">&lt;-</span> WHGlong <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name)</span>
<span id="cb89-474"><a href="#cb89-474" aria-hidden="true" tabindex="-1"></a>WHGwide</span>
<span id="cb89-475"><a href="#cb89-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-476"><a href="#cb89-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-477"><a href="#cb89-477" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Select only the following columns: Year, Month, Day and Temp</span>
<span id="cb89-478"><a href="#cb89-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-481"><a href="#cb89-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-482"><a href="#cb89-482" aria-hidden="true" tabindex="-1"></a>WHG <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Year, Month, Day, Temp))</span>
<span id="cb89-483"><a href="#cb89-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-484"><a href="#cb89-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-485"><a href="#cb89-485" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sort the dataset by the Temp column, in descending order</span>
<span id="cb89-486"><a href="#cb89-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-489"><a href="#cb89-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-490"><a href="#cb89-490" aria-hidden="true" tabindex="-1"></a>WHG <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Temp))</span>
<span id="cb89-491"><a href="#cb89-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-492"><a href="#cb89-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-493"><a href="#cb89-493" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>For the Winter_hours_gaps dataset, write a for loop to convert all</span>
<span id="cb89-494"><a href="#cb89-494" aria-hidden="true" tabindex="-1"></a>    temperatures (Temp column) to degrees Fahrenheit</span>
<span id="cb89-497"><a href="#cb89-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-498"><a href="#cb89-498" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Winters_hours_gaps<span class="sc">$</span>Temp[<span class="dv">183</span><span class="sc">:</span><span class="dv">213</span>] <span class="co"># JDay for July</span></span>
<span id="cb89-499"><a href="#cb89-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-500"><a href="#cb89-500" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> Temp)</span>
<span id="cb89-501"><a href="#cb89-501" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb89-502"><a href="#cb89-502" aria-hidden="true" tabindex="-1"></a>  Fahrenheit <span class="ot">&lt;-</span> i <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span> </span>
<span id="cb89-503"><a href="#cb89-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(Fahrenheit) </span>
<span id="cb89-504"><a href="#cb89-504" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-505"><a href="#cb89-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-506"><a href="#cb89-506" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-507"><a href="#cb89-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-508"><a href="#cb89-508" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Execute the same operation with a function from the apply family</span>
<span id="cb89-509"><a href="#cb89-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-512"><a href="#cb89-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-513"><a href="#cb89-513" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Winters_hours_gaps<span class="sc">$</span>Temp[<span class="dv">183</span><span class="sc">:</span><span class="dv">213</span>]</span>
<span id="cb89-514"><a href="#cb89-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-515"><a href="#cb89-515" aria-hidden="true" tabindex="-1"></a>fahrenheit <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb89-516"><a href="#cb89-516" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span></span>
<span id="cb89-517"><a href="#cb89-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-518"><a href="#cb89-518" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x, fahrenheit)</span>
<span id="cb89-519"><a href="#cb89-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-520"><a href="#cb89-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-521"><a href="#cb89-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-522"><a href="#cb89-522" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Now use the tidyverse function mutate to achieve the same outcome</span>
<span id="cb89-525"><a href="#cb89-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-526"><a href="#cb89-526" aria-hidden="true" tabindex="-1"></a>WHG_F <span class="ot">&lt;-</span> WHG <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Temp_F =</span> Temp <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span>)</span>
<span id="cb89-527"><a href="#cb89-527" aria-hidden="true" tabindex="-1"></a>WHG_F</span>
<span id="cb89-528"><a href="#cb89-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-529"><a href="#cb89-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-530"><a href="#cb89-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-531"><a href="#cb89-531" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-532"><a href="#cb89-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-533"><a href="#cb89-533" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 10: Getting temperature data</span></span>
<span id="cb89-534"><a href="#cb89-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-535"><a href="#cb89-535" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on getting temperature data*** </span></span>
<span id="cb89-536"><a href="#cb89-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-537"><a href="#cb89-537" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Choose a location of interest and find the 25 closest weather</span>
<span id="cb89-538"><a href="#cb89-538" aria-hidden="true" tabindex="-1"></a>    stations using the handle_gsod function</span>
<span id="cb89-539"><a href="#cb89-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-542"><a href="#cb89-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-543"><a href="#cb89-543" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb89-544"><a href="#cb89-544" aria-hidden="true" tabindex="-1"></a>station_list_Rochester <span class="ot">&lt;-</span><span class="fu">handle_gsod</span>(<span class="at">action=</span><span class="st">"list_stations"</span>,</span>
<span id="cb89-545"><a href="#cb89-545" aria-hidden="true" tabindex="-1"></a>                          <span class="at">location=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span>),</span>
<span id="cb89-546"><a href="#cb89-546" aria-hidden="true" tabindex="-1"></a>                          <span class="at">time_interval=</span><span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2020</span>))</span>
<span id="cb89-547"><a href="#cb89-547" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb89-548"><a href="#cb89-548" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(kableExtra)</span>
<span id="cb89-549"><a href="#cb89-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-550"><a href="#cb89-550" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(station_list_Rochester) <span class="sc">%&gt;%</span></span>
<span id="cb89-551"><a href="#cb89-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">position =</span> <span class="st">"left"</span>, <span class="at">font_size =</span> <span class="dv">8</span>)</span>
<span id="cb89-552"><a href="#cb89-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-553"><a href="#cb89-553" aria-hidden="true" tabindex="-1"></a>station_list_Rochester</span>
<span id="cb89-554"><a href="#cb89-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-555"><a href="#cb89-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-556"><a href="#cb89-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-557"><a href="#cb89-557" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Download weather data for the most promising station on the list</span>
<span id="cb89-558"><a href="#cb89-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-561"><a href="#cb89-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-562"><a href="#cb89-562" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">"download_weather"</span>,</span>
<span id="cb89-563"><a href="#cb89-563" aria-hidden="true" tabindex="-1"></a>                       <span class="at">location =</span> station_list_Rochester<span class="sc">$</span>chillR_code[<span class="dv">1</span>],</span>
<span id="cb89-564"><a href="#cb89-564" aria-hidden="true" tabindex="-1"></a>                       <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">2020</span>))</span>
<span id="cb89-565"><a href="#cb89-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-566"><a href="#cb89-566" aria-hidden="true" tabindex="-1"></a>weather[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb89-567"><a href="#cb89-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-568"><a href="#cb89-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-569"><a href="#cb89-569" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Convert the weather data into chillR format</span>
<span id="cb89-570"><a href="#cb89-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-573"><a href="#cb89-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-574"><a href="#cb89-574" aria-hidden="true" tabindex="-1"></a>cleaned_weather <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(weather)</span>
<span id="cb89-575"><a href="#cb89-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-576"><a href="#cb89-576" aria-hidden="true" tabindex="-1"></a>cleaned_weather[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb89-577"><a href="#cb89-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-578"><a href="#cb89-578" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"data_New_York"</span>)</span>
<span id="cb89-579"><a href="#cb89-579" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(station_list_Rochester,</span>
<span id="cb89-580"><a href="#cb89-580" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/station_list_Rochester.csv"</span>,</span>
<span id="cb89-581"><a href="#cb89-581" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-582"><a href="#cb89-582" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(weather[[<span class="dv">1</span>]],</span>
<span id="cb89-583"><a href="#cb89-583" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/Rochester_weather.csv"</span>,</span>
<span id="cb89-584"><a href="#cb89-584" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-585"><a href="#cb89-585" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(cleaned_weather[[<span class="dv">1</span>]],</span>
<span id="cb89-586"><a href="#cb89-586" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/Rochester_chillR_weather.csv"</span>,</span>
<span id="cb89-587"><a href="#cb89-587" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-588"><a href="#cb89-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-589"><a href="#cb89-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-590"><a href="#cb89-590" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb89-591"><a href="#cb89-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-592"><a href="#cb89-592" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 11: Getting temperature data</span></span>
<span id="cb89-593"><a href="#cb89-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-594"><a href="#cb89-594" aria-hidden="true" tabindex="-1"></a><span class="fu">## ***Exercises on getting temperature data*** </span></span>
<span id="cb89-595"><a href="#cb89-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-596"><a href="#cb89-596" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Use chillR functions to find out how many gaps you have in this</span>
<span id="cb89-597"><a href="#cb89-597" aria-hidden="true" tabindex="-1"></a>    dataset (even if you have none, please still follow all further</span>
<span id="cb89-598"><a href="#cb89-598" aria-hidden="true" tabindex="-1"></a>    steps)</span>
<span id="cb89-599"><a href="#cb89-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-602"><a href="#cb89-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-603"><a href="#cb89-603" aria-hidden="true" tabindex="-1"></a>Rochester <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data_New_York/Rochester_chillR_weather.csv"</span>)</span>
<span id="cb89-604"><a href="#cb89-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-605"><a href="#cb89-605" aria-hidden="true" tabindex="-1"></a>Rochester_QC <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(Rochester)<span class="sc">$</span>QC</span>
<span id="cb89-606"><a href="#cb89-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-607"><a href="#cb89-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-608"><a href="#cb89-608" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Create a list of the 25 closest weather stations using the</span>
<span id="cb89-609"><a href="#cb89-609" aria-hidden="true" tabindex="-1"></a>    handle_gsod function</span>
<span id="cb89-610"><a href="#cb89-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-613"><a href="#cb89-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-614"><a href="#cb89-614" aria-hidden="true" tabindex="-1"></a>station_list <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action=</span><span class="st">"list_stations"</span>,</span>
<span id="cb89-615"><a href="#cb89-615" aria-hidden="true" tabindex="-1"></a>                            <span class="at">location=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.60</span>, <span class="fl">43.15</span>),</span>
<span id="cb89-616"><a href="#cb89-616" aria-hidden="true" tabindex="-1"></a>                              <span class="at">time_interval=</span><span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2020</span>))</span>
<span id="cb89-617"><a href="#cb89-617" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb89-618"><a href="#cb89-618" aria-hidden="true" tabindex="-1"></a>station_list</span>
<span id="cb89-619"><a href="#cb89-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-620"><a href="#cb89-620" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(station_list, <span class="at">n =</span> <span class="dv">26</span>)</span>
<span id="cb89-621"><a href="#cb89-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-622"><a href="#cb89-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-623"><a href="#cb89-623" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Identify suitable weather stations for patching gaps</span>
<span id="cb89-624"><a href="#cb89-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-625"><a href="#cb89-625" aria-hidden="true" tabindex="-1"></a>#download stations number 4, 5, and 10 these will be used to patch</span>
<span id="cb89-626"><a href="#cb89-626" aria-hidden="true" tabindex="-1"></a>the gaps</span>
<span id="cb89-627"><a href="#cb89-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-628"><a href="#cb89-628" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Download weather data for promising stations, convert them to chillR</span>
<span id="cb89-629"><a href="#cb89-629" aria-hidden="true" tabindex="-1"></a>    format and compile them in a list</span>
<span id="cb89-630"><a href="#cb89-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-633"><a href="#cb89-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-634"><a href="#cb89-634" aria-hidden="true" tabindex="-1"></a>patch_weather<span class="ot">&lt;-</span></span>
<span id="cb89-635"><a href="#cb89-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">"download_weather"</span>,</span>
<span id="cb89-636"><a href="#cb89-636" aria-hidden="true" tabindex="-1"></a>              <span class="at">location =</span> <span class="fu">as.character</span>(station_list<span class="sc">$</span>chillR_code[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">10</span>)]),</span>
<span id="cb89-637"><a href="#cb89-637" aria-hidden="true" tabindex="-1"></a>              <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2020</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-638"><a href="#cb89-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">handle_gsod</span>()</span>
<span id="cb89-639"><a href="#cb89-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-640"><a href="#cb89-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-641"><a href="#cb89-641" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Use the patch_daily_temperatures function to fill gaps</span>
<span id="cb89-642"><a href="#cb89-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-645"><a href="#cb89-645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-646"><a href="#cb89-646" aria-hidden="true" tabindex="-1"></a>patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(<span class="at">weather =</span> Rochester,</span>
<span id="cb89-647"><a href="#cb89-647" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">patch_weather =</span> patch_weather)</span>
<span id="cb89-648"><a href="#cb89-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-649"><a href="#cb89-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-650"><a href="#cb89-650" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">1</span>]]</span>
<span id="cb89-651"><a href="#cb89-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-652"><a href="#cb89-652" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">2</span>]]</span>
<span id="cb89-653"><a href="#cb89-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-654"><a href="#cb89-654" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">3</span>]]</span>
<span id="cb89-655"><a href="#cb89-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-656"><a href="#cb89-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-657"><a href="#cb89-657" aria-hidden="true" tabindex="-1"></a>#set minimum quality criteria</span>
<span id="cb89-658"><a href="#cb89-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-661"><a href="#cb89-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-662"><a href="#cb89-662" aria-hidden="true" tabindex="-1"></a>patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(<span class="at">weather =</span> Rochester,</span>
<span id="cb89-663"><a href="#cb89-663" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb89-664"><a href="#cb89-664" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb89-665"><a href="#cb89-665" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">max_stdev_bias =</span> <span class="dv">2</span>)</span>
<span id="cb89-666"><a href="#cb89-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-667"><a href="#cb89-667" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">1</span>]]</span>
<span id="cb89-668"><a href="#cb89-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-669"><a href="#cb89-669" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">2</span>]]</span>
<span id="cb89-670"><a href="#cb89-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-671"><a href="#cb89-671" aria-hidden="true" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">3</span>]]</span>
<span id="cb89-672"><a href="#cb89-672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-673"><a href="#cb89-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-674"><a href="#cb89-674" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Investigate the results - have all gaps been filled?</span>
<span id="cb89-675"><a href="#cb89-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-678"><a href="#cb89-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-679"><a href="#cb89-679" aria-hidden="true" tabindex="-1"></a>post_patch_stats <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(patched)<span class="sc">$</span>QC</span>
<span id="cb89-680"><a href="#cb89-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-681"><a href="#cb89-681" aria-hidden="true" tabindex="-1"></a>post_patch_stats</span>
<span id="cb89-682"><a href="#cb89-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-683"><a href="#cb89-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-684"><a href="#cb89-684" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>If necessary, repeat until you have a dataset you can work with in</span>
<span id="cb89-685"><a href="#cb89-685" aria-hidden="true" tabindex="-1"></a>    further analyses</span>
<span id="cb89-686"><a href="#cb89-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-689"><a href="#cb89-689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-690"><a href="#cb89-690" aria-hidden="true" tabindex="-1"></a>Rochester_weather<span class="ot">&lt;-</span><span class="fu">fix_weather</span>(patched)</span>
<span id="cb89-691"><a href="#cb89-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-692"><a href="#cb89-692" aria-hidden="true" tabindex="-1"></a>patched_monthly <span class="ot">&lt;-</span> <span class="fu">patch_daily_temps</span>(<span class="at">weather =</span> Rochester,</span>
<span id="cb89-693"><a href="#cb89-693" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb89-694"><a href="#cb89-694" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb89-695"><a href="#cb89-695" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">max_stdev_bias =</span> <span class="dv">2</span>,</span>
<span id="cb89-696"><a href="#cb89-696" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">time_interval =</span> <span class="st">"month"</span>)</span>
<span id="cb89-697"><a href="#cb89-697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-698"><a href="#cb89-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-699"><a href="#cb89-699" aria-hidden="true" tabindex="-1"></a>#saving the data for later</span>
<span id="cb89-700"><a href="#cb89-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-703"><a href="#cb89-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-704"><a href="#cb89-704" aria-hidden="true" tabindex="-1"></a>monthly_bias_fixed <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(patched_monthly)</span>
<span id="cb89-705"><a href="#cb89-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-706"><a href="#cb89-706" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(monthly_bias_fixed<span class="sc">$</span>weather,</span>
<span id="cb89-707"><a href="#cb89-707" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data_New_York/Rochester_weather.csv"</span>)</span>
<span id="cb89-708"><a href="#cb89-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="tree_phenology_assignment_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>